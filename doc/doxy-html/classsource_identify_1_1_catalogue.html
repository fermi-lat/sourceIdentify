<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>sourceIdentify: sourceIdentify::Catalogue Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="namespacesource_identify.html">sourceIdentify</a>::<a class="el" href="classsource_identify_1_1_catalogue.html">Catalogue</a></div>
<h1>sourceIdentify::Catalogue Class Reference</h1><code>#include &lt;<a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>&gt;</code>
<p>
Collaboration diagram for sourceIdentify::Catalogue:<p><center><img src="classsource_identify_1_1_catalogue__coll__graph.png" border="0" usemap="#source_identify_1_1_catalogue__coll__map" alt="Collaboration graph"></center>
<map name="source_identify_1_1_catalogue__coll__map">
<area href="structsource_identify_1_1_c_c_element.html" shape="rect" coords="7,8,191,32" alt="">
<area href="structsource_identify_1_1_object_info.html" shape="rect" coords="215,8,393,32" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classsource_identify_1_1_catalogue-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#a0">Catalogue</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#a1">~Catalogue</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#a2">build</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#a3">save</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d0">init_memory</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d1">free_memory</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d2">get_input_descriptor</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, std::string catName, catalogAccess::Catalog *cat, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d3">get_input_catalogue</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, std::string catName, catalogAccess::Catalog *cat, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d4">get_counterpart_candidates</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, long iSrc, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d5">get_counterparts</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, double *ra, double *dec, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d6">get_probability</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, long iSrc, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d7">get_probability_angsep</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, long iSrc, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d8">create_output_catalogue</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d9">add_counterpart_candidates</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, long iSrc, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d10">eval_output_catalogue_quantities</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d11">select_output_catalogue</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d12">cc_sort</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d13">dump_descriptor</a> (catalogAccess::Catalog *cat, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#d14">dump_counterpart_candidates</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r0">m_numSrc</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r1">m_numCpt</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r2">m_maxCptLoad</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r3">m_fCptLoaded</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r4">m_filter_maxsep</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">catalogAccess::Catalog&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r5">m_src</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">catalogAccess::Catalog&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structsource_identify_1_1_object_info.html">ObjectInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r7">m_cpt_loc</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">fitsfile *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r8">m_outFile</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r9">m_numCC</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structsource_identify_1_1_c_c_element.html">CCElement</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r11">m_num_src_Qty</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; int &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r12">m_src_Qty_colnum</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r13">m_src_Qty_ttype</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r14">m_src_Qty_tform</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r15">m_src_Qty_tunit</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r16">m_src_Qty_tbucd</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r17">m_num_cpt_Qty</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; int &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r18">m_cpt_Qty_colnum</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r19">m_cpt_Qty_ttype</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r20">m_cpt_Qty_tform</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r21">m_cpt_Qty_tunit</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsource_identify_1_1_catalogue.html#r22">m_cpt_Qty_tbucd</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="sourceIdentify::Catalogue::Catalogue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">sourceIdentify::Catalogue::Catalogue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00167">167</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.<div class="fragment"><pre class="fragment">00167 { <a class="code" href="classsource_identify_1_1_catalogue.html#d0">init_memory</a>(); }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="sourceIdentify::Catalogue::~Catalogue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">sourceIdentify::Catalogue::~<a class="el" href="classsource_identify_1_1_catalogue.html">Catalogue</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00168">168</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l00204">free_memory()</a>.<div class="fragment"><pre class="fragment">00168 { <a class="code" href="classsource_identify_1_1_catalogue.html#d1">free_memory</a>(); }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="d9" doxytag="sourceIdentify::Catalogue::add_counterpart_candidates"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::add_counterpart_candidates           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>iSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01209">1209</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8h-source.html#l00094">sourceIdentify::CCElement::index</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="_catalogue_8h-source.html#l00149">m_cc</a>, <a class="el" href="_catalogue_8h-source.html#l00143">m_cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00161">m_cpt_Qty_colnum</a>, <a class="el" href="_catalogue_8h-source.html#l00163">m_cpt_Qty_tform</a>, <a class="el" href="_catalogue_8h-source.html#l00162">m_cpt_Qty_ttype</a>, <a class="el" href="_catalogue_8h-source.html#l00160">m_num_cpt_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00152">m_num_src_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00148">m_numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00145">m_outFile</a>, <a class="el" href="_catalogue_8h-source.html#l00142">m_src</a>, <a class="el" href="_catalogue_8h-source.html#l00153">m_src_Qty_colnum</a>, <a class="el" href="_catalogue_8h-source.html#l00155">m_src_Qty_tform</a>, <a class="el" href="_catalogue_8h-source.html#l00154">m_src_Qty_ttype</a>, <a class="el" href="_catalogue_8h-source.html#l00045">OUTCAT_COL_DEC_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00034">OUTCAT_COL_ID_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00051">OUTCAT_COL_MAJERR_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00058">OUTCAT_COL_MINERR_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00064">OUTCAT_COL_POSANGLE_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00070">OUTCAT_COL_PROB_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00039">OUTCAT_COL_RA_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00028">OUTCAT_MAX_STRING_LEN</a>, <a class="el" href="_catalogue_8h-source.html#l00088">sourceIdentify::CCElement::pos_eq_dec</a>, <a class="el" href="_catalogue_8h-source.html#l00087">sourceIdentify::CCElement::pos_eq_ra</a>, <a class="el" href="_catalogue_8h-source.html#l00091">sourceIdentify::CCElement::pos_err_ang</a>, <a class="el" href="_catalogue_8h-source.html#l00089">sourceIdentify::CCElement::pos_err_maj</a>, <a class="el" href="_catalogue_8h-source.html#l00090">sourceIdentify::CCElement::pos_err_min</a>, <a class="el" href="_catalogue_8h-source.html#l00092">sourceIdentify::CCElement::prob</a>, <a class="el" href="namespacesource_identify.html#a38a25">sourceIdentify::STATUS_MEM_ALLOC</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00355">get_counterpart_candidates()</a>.<div class="fragment"><pre class="fragment">01210                                                             {
01211 
01212     <span class="comment">// Declare local variables</span>
01213     <span class="keywordtype">int</span>           fstatus;
01214     <span class="keywordtype">int</span>           colnum;
01215     <span class="keywordtype">long</span>          nactrows;
01216     <span class="keywordtype">long</span>          firstrow;
01217     <span class="keywordtype">long</span>          row;
01218     <span class="keywordtype">long</span>          frow;
01219     <span class="keywordtype">long</span>          nrows;
01220     <span class="keywordtype">long</span>          iQty;
01221     <span class="keywordtype">long</span>          iCpt;
01222     <span class="keywordtype">double</span>        NValue;
01223     std::string   SValue;
01224     std::string   form;
01225     std::string   name;
01226     <span class="keywordtype">double</span>       *dptr;
01227     <span class="keywordtype">char</span>        **cptr;
01228 
01229     <span class="comment">// Debug mode: Entry</span>
01230     <span class="keywordflow">if</span> (par-&gt;logDebug())
01231       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::add_counterpart_candidates"</span>);
01232 
01233     <span class="comment">// Initialise temporary memory pointers</span>
01234     dptr  = NULL;
01235     cptr  = NULL;   
01236     nrows = 0; 
01237 
01238     <span class="comment">// Initialise FITSIO status</span>
01239     fstatus = (int)status;
01240     
01241     <span class="comment">// Single loop for common exit point</span>
01242     <span class="keywordflow">do</span> {
01243     
01244       <span class="comment">// Fall through in case of an error</span>
01245       <span class="keywordflow">if</span> (status != STATUS_OK)
01246         continue;
01247         
01248       <span class="comment">// Fall through if there are no counterpart candidates</span>
01249       if (m_numCC &lt; 1)
01250         continue;
01251 
01252       <span class="comment">// Determine number of rows in actual table</span>
01253       fstatus = fits_get_num_rows(m_outFile, &amp;nactrows, &amp;fstatus);
01254       if (fstatus != 0) {
01255         <span class="keywordflow">if</span> (par-&gt;logTerse())
01256           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to determine number of rows in output"</span>
01257               <span class="stringliteral">" catalogue."</span>, fstatus);
01258         <span class="keywordflow">continue</span>;
01259       }
01260 
01261       <span class="comment">// Define the rows that should be inserted</span>
01262       firstrow = (long)nactrows;
01263       frow     = firstrow + 1;   
01264       nrows    = (long)<a class="code" href="classsource_identify_1_1_catalogue.html#r9">m_numCC</a>;
01265 
01266       <span class="comment">// Insert rows for the new counterpart candidates</span>
01267       fstatus = fits_insert_rows(m_outFile, firstrow, nrows, &amp;fstatus);
01268       <span class="keywordflow">if</span> (fstatus != 0) {
01269         <span class="keywordflow">if</span> (par-&gt;logTerse())
01270           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to add %d rows to output catalogue."</span>, 
01271               fstatus, nrows);
01272         <span class="keywordflow">continue</span>;
01273       }
01274 
01275       <span class="comment">// Allocate memory to hold quantities</span>
01276       dptr = <span class="keyword">new</span> <span class="keywordtype">double</span>[nrows];
01277       cptr = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[nrows];
01278       <span class="keywordflow">if</span> (dptr == NULL ||
01279           cptr == NULL) {
01280         status = <a class="code" href="namespacesource_identify.html#a38a25">STATUS_MEM_ALLOC</a>;
01281         <span class="keywordflow">if</span> (par-&gt;logTerse())
01282           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Memory allocation failure."</span>, (Status)status);
01283         <span class="keywordflow">continue</span>;
01284       }
01285       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++) {
01286         cptr[row] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a0">OUTCAT_MAX_STRING_LEN</a>];
01287         <span class="keywordflow">if</span> (cptr[row] == NULL) {
01288           status = <a class="code" href="namespacesource_identify.html#a38a25">STATUS_MEM_ALLOC</a>;
01289           <span class="keywordflow">if</span> (par-&gt;logTerse())
01290             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Memory allocation failure."</span>, (Status)status);
01291           <span class="keywordflow">break</span>;
01292         }
01293       }
01294       <span class="keywordflow">if</span> (status != STATUS_OK)
01295         continue;
01296 
01297 
01298       <span class="comment">// Add unique counterpart identifier</span>
01299       for (row = 0; row &lt; nrows; row++)
01300         strcpy(cptr[row], m_cc[row].<span class="keywordtype">id</span>.c_str());
01301       fstatus = fits_write_col_str(m_outFile, OUTCAT_COL_ID_COLNUM, 
01302                                    frow, 1, nrows, cptr, &amp;fstatus);
01303       if (fstatus != 0) {
01304         <span class="keywordflow">if</span> (par-&gt;logTerse())
01305           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart identifier to output"</span>
01306               <span class="stringliteral">" catalogue."</span>, fstatus);
01307         <span class="keywordflow">continue</span>;
01308       }
01309 
01310       <span class="comment">// Add Counterpart Right Ascention</span>
01311       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01312         dptr[row] = m_cc[row].pos_eq_ra;
01313       fstatus = fits_write_col(m_outFile, TDOUBLE, OUTCAT_COL_RA_COLNUM,
01314                                frow, 1, nrows, dptr, &amp;fstatus);
01315       if (fstatus != 0) {
01316         <span class="keywordflow">if</span> (par-&gt;logTerse())
01317           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart Right Ascension to"</span>
01318               <span class="stringliteral">" output catalogue."</span>, fstatus);
01319         <span class="keywordflow">continue</span>;
01320       }
01321 
01322       <span class="comment">// Add Counterpart Declination</span>
01323       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01324         dptr[row] = m_cc[row].pos_eq_dec;
01325       fstatus = fits_write_col(m_outFile, TDOUBLE, OUTCAT_COL_DEC_COLNUM,
01326                                frow, 1, nrows, dptr, &amp;fstatus);
01327       if (fstatus != 0) {
01328         <span class="keywordflow">if</span> (par-&gt;logTerse())
01329           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart Declination to"</span>
01330               <span class="stringliteral">" output catalogue."</span>, fstatus);
01331         <span class="keywordflow">continue</span>;
01332       }
01333 
01334       <span class="comment">// Add Counterpart Error Ellipse Major Axis</span>
01335       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01336         dptr[row] = m_cc[row].pos_err_maj;
01337       fstatus = fits_write_col(m_outFile, TDOUBLE, OUTCAT_COL_MAJERR_COLNUM,
01338                                frow, 1, nrows, dptr, &amp;fstatus);
01339       if (fstatus != 0) {
01340         <span class="keywordflow">if</span> (par-&gt;logTerse())
01341           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart error ellipse major"</span>
01342               <span class="stringliteral">" axis to output catalogue."</span>, fstatus);
01343         <span class="keywordflow">continue</span>;
01344       }
01345 
01346       <span class="comment">// Add Counterpart Error Ellipse Minor Axis</span>
01347       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01348         dptr[row] = m_cc[row].pos_err_min;
01349       fstatus = fits_write_col(m_outFile, TDOUBLE, OUTCAT_COL_MINERR_COLNUM,
01350                                frow, 1, nrows, dptr, &amp;fstatus);
01351       if (fstatus != 0) {
01352         <span class="keywordflow">if</span> (par-&gt;logTerse())
01353           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart error ellipse minor"</span>
01354               <span class="stringliteral">" axis to output catalogue."</span>, fstatus);
01355         <span class="keywordflow">continue</span>;
01356       }
01357 
01358       <span class="comment">// Add Counterpart Error Ellipse Position Angle</span>
01359       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01360         dptr[row] = m_cc[row].pos_err_ang;
01361       fstatus = fits_write_col(m_outFile, TDOUBLE, OUTCAT_COL_POSANGLE_COLNUM,
01362                                frow, 1, nrows, dptr, &amp;fstatus);
01363       if (fstatus != 0) {
01364         <span class="keywordflow">if</span> (par-&gt;logTerse())
01365           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart error ellipse position"</span>
01366               <span class="stringliteral">" angle to output catalogue."</span>, fstatus);
01367         <span class="keywordflow">continue</span>;
01368       }
01369 
01370       <span class="comment">// Add Counterpart Probability</span>
01371       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01372         dptr[row] = m_cc[row].prob;
01373       fstatus = fits_write_col(m_outFile, TDOUBLE, OUTCAT_COL_PROB_COLNUM,
01374                                frow, 1, nrows, dptr, &amp;fstatus);
01375       if (fstatus != 0) {
01376         <span class="keywordflow">if</span> (par-&gt;logTerse())
01377           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart probability to output"</span>
01378               <span class="stringliteral">" catalogue."</span>, fstatus);
01379         <span class="keywordflow">continue</span>;
01380       }
01381 
01382       <span class="comment">// Add source catalogue columns</span>
01383       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; m_num_src_Qty; iQty++) {
01384 
01385         <span class="comment">// Get column information</span>
01386         colnum = <a class="code" href="classsource_identify_1_1_catalogue.html#r12">m_src_Qty_colnum</a>[iQty];
01387         form   = <a class="code" href="classsource_identify_1_1_catalogue.html#r14">m_src_Qty_tform</a>[iQty];
01388         name   = <a class="code" href="classsource_identify_1_1_catalogue.html#r13">m_src_Qty_ttype</a>[iQty];
01389 
01390         <span class="comment">// Add numerical quantities</span>
01391         <span class="keywordflow">if</span> (form.find(<span class="stringliteral">"E"</span>, 0) != std::string::npos) {
01392           <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getNValue(name, iSrc, &amp;NValue);
01393           <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01394             dptr[row] = NValue;
01395           fstatus = fits_write_col(m_outFile, TDOUBLE, colnum, frow, 1, nrows, 
01396                                    dptr, &amp;fstatus);
01397           if (fstatus != 0) {
01398             <span class="keywordflow">if</span> (par-&gt;logTerse())
01399               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write source catalogue data &lt;%s&gt;"</span>
01400                   <span class="stringliteral">" (column %d) to output catalogue."</span>, 
01401                   fstatus, name.c_str(), colnum);
01402             <span class="keywordflow">break</span>;
01403           }
01404         } <span class="comment">// endif: added numerical quantities</span>
01405 
01406         <span class="comment">// Add string quantities</span>
01407         <span class="keywordflow">if</span> (form.find(<span class="stringliteral">"A"</span>, 0) != std::string::npos) {
01408           <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getSValue(name, iSrc, &amp;SValue);
01409           <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01410             strcpy(cptr[row], SValue.c_str());
01411           fstatus = fits_write_col_str(m_outFile, colnum, frow, 1, nrows, cptr, 
01412                                        &amp;fstatus);
01413           if (fstatus != 0) {
01414             <span class="keywordflow">if</span> (par-&gt;logTerse())
01415               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write source catalogue data &lt;%s&gt;"</span>
01416                   <span class="stringliteral">" (column %d) to output catalogue."</span>, 
01417                   fstatus, name.c_str(), colnum);
01418             <span class="keywordflow">break</span>;
01419           }
01420         } <span class="comment">// endif: added numerical quantities</span>
01421 
01422       }
01423       <span class="keywordflow">if</span> (fstatus != 0)
01424         continue;
01425 
01426       <span class="comment">// Add counterpart catalogue columns</span>
01427       for (iQty = 0; iQty &lt; m_num_cpt_Qty; iQty++) {
01428 
01429         <span class="comment">// Get column information</span>
01430         colnum = <a class="code" href="classsource_identify_1_1_catalogue.html#r18">m_cpt_Qty_colnum</a>[iQty];
01431         form   = <a class="code" href="classsource_identify_1_1_catalogue.html#r20">m_cpt_Qty_tform</a>[iQty];
01432         name   = <a class="code" href="classsource_identify_1_1_catalogue.html#r19">m_cpt_Qty_ttype</a>[iQty];
01433 
01434         <span class="comment">// Add numerical quantities</span>
01435         <span class="keywordflow">if</span> (form.find(<span class="stringliteral">"E"</span>, 0) != std::string::npos) {
01436           <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++) {
01437             iCpt = <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[row].index;
01438             <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.getNValue(name, iCpt, &amp;NValue);
01439             dptr[row] = NValue;
01440           }
01441           fstatus = fits_write_col(m_outFile, TDOUBLE, colnum, frow, 1, nrows, 
01442                                    dptr, &amp;fstatus);
01443           <span class="keywordflow">if</span> (fstatus != 0) {
01444             <span class="keywordflow">if</span> (par-&gt;logTerse())
01445               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart catalogue data &lt;%s&gt;"</span>
01446                   <span class="stringliteral">" (column %d) to output catalogue."</span>, 
01447                   fstatus, name.c_str(), colnum);
01448             <span class="keywordflow">break</span>;
01449           }
01450         } <span class="comment">// endif: added numerical quantities</span>
01451 
01452         <span class="comment">// Add string quantities</span>
01453         <span class="keywordflow">if</span> (form.find(<span class="stringliteral">"A"</span>, 0) != std::string::npos) {
01454           <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++) {
01455             iCpt = <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[row].index;
01456             <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.getSValue(name, iCpt, &amp;SValue);
01457             strcpy(cptr[row], SValue.c_str());
01458           }
01459           fstatus = fits_write_col_str(m_outFile, colnum, frow, 1, nrows, cptr, 
01460                                        &amp;fstatus);
01461           <span class="keywordflow">if</span> (fstatus != 0) {
01462             <span class="keywordflow">if</span> (par-&gt;logTerse())
01463               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write counterpart catalogue data"</span>
01464                   <span class="stringliteral">" &lt;%s&gt; (column %d) to output catalogue."</span>, 
01465                   fstatus, name.c_str(), colnum);
01466             <span class="keywordflow">break</span>;
01467           }
01468         } <span class="comment">// endif: added numerical quantities</span>
01469 
01470       }
01471       <span class="keywordflow">if</span> (fstatus != 0)
01472         continue;
01473    
01474     } while (0); <span class="comment">// End of main do-loop</span>
01475 
01476     <span class="comment">// Delete temporary memory</span>
01477     if (dptr != NULL) delete [] dptr;
01478     if (cptr != NULL) {
01479       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++) {
01480         <span class="keywordflow">if</span> (cptr[row] != NULL) delete [] cptr[row];
01481       }
01482       delete [] cptr;
01483     }
01484 
01485     <span class="comment">// Set FITSIO status</span>
01486     if (status == STATUS_OK)
01487       status = (Status)fstatus;
01488 
01489     <span class="comment">// Debug mode: Entry</span>
01490     if (par-&gt;logDebug())
01491       Log(Log_0, " &lt;== EXIT: Catalogue::add_counterpart_candidates (status=%d)", 
01492           status);
01493     
01494     <span class="comment">// Return status</span>
01495     return status;
01496 
01497 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="sourceIdentify::Catalogue::build"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::build           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01977">1977</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>, <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8cxx-source.html#l01505">eval_output_catalogue_quantities()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00355">get_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00297">get_input_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00230">get_input_descriptor()</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00143">m_cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00137">m_numSrc</a>, <a class="el" href="_catalogue_8h-source.html#l00142">m_src</a>, <a class="el" href="_catalogue_8cxx-source.html#l01620">select_output_catalogue()</a>, <a class="el" href="namespacesource_identify.html#a38a31">sourceIdentify::STATUS_CAT_EMPTY</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="source_identify_8cxx-source.html#l00051">application::run()</a>.<div class="fragment"><pre class="fragment">01977                                                       {
01978 
01979     <span class="comment">// Declare local variables</span>
01980     <span class="keywordtype">long</span> iSrc;
01981 
01982     <span class="comment">// Debug mode: Entry</span>
01983     <span class="keywordflow">if</span> (par-&gt;logDebug())
01984       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::build"</span>);
01985         
01986     <span class="comment">// Single loop for common exit point</span>
01987     <span class="keywordflow">do</span> {
01988 
01989       <span class="comment">// Fall through in case of an error</span>
01990       <span class="keywordflow">if</span> (status != STATUS_OK)
01991         continue;
01992 
01993       <span class="comment">// Dump header</span>
01994       if (par-&gt;logNormal()) {
01995         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">""</span>);
01996         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"Build counterpart candidate catalogue:"</span>);
01997         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"======================================"</span>);
01998       }
01999       
02000       <span class="comment">// Get input catalogue descriptors</span>
02001       status = <a class="code" href="classsource_identify_1_1_catalogue.html#d2">get_input_descriptor</a>(par, par-&gt;m_srcCatName, &amp;m_src, status);
02002       <span class="keywordflow">if</span> (status != STATUS_OK) {
02003         <span class="keywordflow">if</span> (par-&gt;logTerse())
02004           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to load source catalogue '%s' descriptor."</span>,
02005               (Status)status, par-&gt;m_srcCatName.c_str());
02006         <span class="keywordflow">continue</span>;
02007       }
02008       status = <a class="code" href="classsource_identify_1_1_catalogue.html#d2">get_input_descriptor</a>(par, par-&gt;m_cptCatName, &amp;m_cpt, status);
02009       <span class="keywordflow">if</span> (status != STATUS_OK) {
02010         <span class="keywordflow">if</span> (par-&gt;logTerse())
02011           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to load counterpart catalogue '%s'"</span>
02012               <span class="stringliteral">" descriptor."</span>, (Status)status, par-&gt;m_cptCatName.c_str());
02013         <span class="keywordflow">continue</span>;
02014       }
02015 
02016       <span class="comment">// Create output catalogue</span>
02017       status = <a class="code" href="classsource_identify_1_1_catalogue.html#d8">create_output_catalogue</a>(par, status);
02018       <span class="keywordflow">if</span> (status != STATUS_OK) {
02019         <span class="keywordflow">if</span> (par-&gt;logTerse())
02020           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to create output catalogue."</span>,
02021               (Status)status);
02022         <span class="keywordflow">continue</span>;
02023       }
02024       
02025       <span class="comment">// Load source catalogue</span>
02026       status = <a class="code" href="classsource_identify_1_1_catalogue.html#d3">get_input_catalogue</a>(par, par-&gt;m_srcCatName, &amp;m_src, status);
02027       <span class="keywordflow">if</span> (status != STATUS_OK) {
02028         <span class="keywordflow">if</span> (par-&gt;logTerse())
02029           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to load source catalogue '%s' data."</span>,
02030               (Status)status, par-&gt;m_srcCatName.c_str());
02031         <span class="keywordflow">continue</span>;
02032       }
02033       <span class="keywordflow">else</span> {
02034         <span class="keywordflow">if</span> (par-&gt;logVerbose())
02035           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Source catalogue loaded."</span>);
02036       }
02037       
02038       <span class="comment">// Determine the number of sources in source catalogue. Stop of the</span>
02039       <span class="comment">// catalogue is empty</span>
02040       <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getNumRows(&amp;m_numSrc);
02041       <span class="keywordflow">if</span> (m_numSrc &lt; 1) {
02042         status = <a class="code" href="namespacesource_identify.html#a38a31">STATUS_CAT_EMPTY</a>;
02043         <span class="keywordflow">if</span> (par-&gt;logTerse())
02044           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Source catalogue is empty. Stop"</span>, (Status)status);
02045         <span class="keywordflow">continue</span>;
02046       }
02047       <span class="keywordflow">else</span> {
02048         <span class="keywordflow">if</span> (par-&gt;logVerbose())
02049           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Source catalogue contains %d sources."</span>, m_numSrc);
02050       }
02051       
02052       <span class="comment">// Loop over all sources</span>
02053       <span class="keywordflow">for</span> (iSrc = 0; iSrc &lt; m_numSrc; iSrc++) {
02054       
02055         <span class="comment">// Get counterpart candidates for the source</span>
02056         status = <a class="code" href="classsource_identify_1_1_catalogue.html#d4">get_counterpart_candidates</a>(par, iSrc, status);
02057         <span class="keywordflow">if</span> (status != STATUS_OK)
02058           break;
02059       
02060       } <span class="comment">// endfor: looped over all sources</span>
02061       if (status != STATUS_OK)
02062         continue;
02063 
02064       <span class="comment">// Evaluate output catalogue quantities</span>
02065       status = eval_output_catalogue_quantities(par, status);
02066       if (status != STATUS_OK) {
02067         <span class="keywordflow">if</span> (par-&gt;logTerse())
02068           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to evaluate output catalogue quantities."</span>,
02069               (Status)status);
02070         <span class="keywordflow">continue</span>;
02071       }
02072 
02073       <span class="comment">// Select output catalogue counterparts</span>
02074       status = <a class="code" href="classsource_identify_1_1_catalogue.html#d11">select_output_catalogue</a>(par, status);
02075       <span class="keywordflow">if</span> (status != STATUS_OK) {
02076         <span class="keywordflow">if</span> (par-&gt;logTerse())
02077           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to select output catalogue counterparts."</span>,
02078               (Status)status);
02079         <span class="keywordflow">continue</span>;
02080       }
02081       
02082     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
02083 
02084     <span class="comment">// Debug mode: Entry</span>
02085     <span class="keywordflow">if</span> (par-&gt;logDebug())
02086       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" &lt;== EXIT: Catalogue::build (status=%d)"</span>, status);
02087     
02088     <span class="comment">// Return status</span>
02089     <span class="keywordflow">return</span> status;
02090 
02091 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d12" doxytag="sourceIdentify::Catalogue::cc_sort"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::cc_sort           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01725">1725</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="_catalogue_8h-source.html#l00149">m_cc</a>, <a class="el" href="_catalogue_8h-source.html#l00148">m_numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00092">sourceIdentify::CCElement::prob</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00678">get_probability()</a>.<div class="fragment"><pre class="fragment">01725                                                         {
01726 
01727     <span class="comment">// Declare local variables</span>
01728     <span class="keywordtype">long</span>      iCC;
01729     <span class="keywordtype">long</span>      jCC;
01730     <span class="keywordtype">long</span>      imax;
01731     <span class="keywordtype">double</span>    max;
01732     CCElement swap;
01733 
01734     <span class="comment">// Debug mode: Entry</span>
01735     <span class="keywordflow">if</span> (par-&gt;logDebug())
01736       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::cc_sort"</span>);
01737 
01738     <span class="comment">// Single loop for common exit point</span>
01739     <span class="keywordflow">do</span> {
01740     
01741       <span class="comment">// Fall through in case of an error</span>
01742       <span class="keywordflow">if</span> (status != STATUS_OK)
01743         continue;
01744         
01745       <span class="comment">// Fall through if there are no counterpart candidates</span>
01746       if (m_numCC &lt; 1)
01747         continue;
01748     
01749       <span class="comment">// Sort counterpart candidats (dirty brute force method, to be replaced</span>
01750       <span class="comment">// by more efficient method if needed ...)</span>
01751       for (iCC = 0; iCC &lt; m_numCC; iCC++) {
01752         max  = 0.0;
01753         imax = iCC;
01754         <span class="keywordflow">for</span> (jCC = iCC; jCC &lt; m_numCC; jCC++) {
01755           <span class="keywordflow">if</span> (m_cc[jCC].prob &gt; max) {
01756             imax = jCC;
01757             max  = <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[jCC].prob;
01758           }
01759         }
01760         <span class="keywordflow">if</span> (iCC != imax) {
01761           swap       = <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC];
01762           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC]  = <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[imax];
01763           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[imax] = swap;
01764         } 
01765       }
01766     
01767     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01768 
01769     <span class="comment">// Debug mode: Entry</span>
01770     <span class="keywordflow">if</span> (par-&gt;logDebug())
01771       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" &lt;== EXIT: Catalogue::cc_sort (status=%d)"</span>, status);
01772     
01773     <span class="comment">// Return status</span>
01774     <span class="keywordflow">return</span> status;
01775 
01776 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d8" doxytag="sourceIdentify::Catalogue::create_output_catalogue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::create_output_catalogue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00931">931</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="_catalogue_8h-source.html#l00143">m_cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00161">m_cpt_Qty_colnum</a>, <a class="el" href="_catalogue_8h-source.html#l00165">m_cpt_Qty_tbucd</a>, <a class="el" href="_catalogue_8h-source.html#l00163">m_cpt_Qty_tform</a>, <a class="el" href="_catalogue_8h-source.html#l00162">m_cpt_Qty_ttype</a>, <a class="el" href="_catalogue_8h-source.html#l00164">m_cpt_Qty_tunit</a>, <a class="el" href="_catalogue_8h-source.html#l00160">m_num_cpt_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00152">m_num_src_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00145">m_outFile</a>, <a class="el" href="_catalogue_8h-source.html#l00142">m_src</a>, <a class="el" href="_catalogue_8h-source.html#l00153">m_src_Qty_colnum</a>, <a class="el" href="_catalogue_8h-source.html#l00157">m_src_Qty_tbucd</a>, <a class="el" href="_catalogue_8h-source.html#l00155">m_src_Qty_tform</a>, <a class="el" href="_catalogue_8h-source.html#l00154">m_src_Qty_ttype</a>, <a class="el" href="_catalogue_8h-source.html#l00156">m_src_Qty_tunit</a>, <a class="el" href="_catalogue_8h-source.html#l00045">OUTCAT_COL_DEC_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00047">OUTCAT_COL_DEC_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00046">OUTCAT_COL_DEC_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00049">OUTCAT_COL_DEC_UCD</a>, <a class="el" href="_catalogue_8h-source.html#l00048">OUTCAT_COL_DEC_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00034">OUTCAT_COL_ID_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00036">OUTCAT_COL_ID_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00035">OUTCAT_COL_ID_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00037">OUTCAT_COL_ID_UCD</a>, <a class="el" href="_catalogue_8h-source.html#l00051">OUTCAT_COL_MAJERR_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00054">OUTCAT_COL_MAJERR_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00053">OUTCAT_COL_MAJERR_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00056">OUTCAT_COL_MAJERR_UCD</a>, <a class="el" href="_catalogue_8h-source.html#l00055">OUTCAT_COL_MAJERR_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00058">OUTCAT_COL_MINERR_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00060">OUTCAT_COL_MINERR_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00059">OUTCAT_COL_MINERR_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00062">OUTCAT_COL_MINERR_UCD</a>, <a class="el" href="_catalogue_8h-source.html#l00061">OUTCAT_COL_MINERR_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00064">OUTCAT_COL_POSANGLE_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00066">OUTCAT_COL_POSANGLE_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00065">OUTCAT_COL_POSANGLE_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00068">OUTCAT_COL_POSANGLE_UCD</a>, <a class="el" href="_catalogue_8h-source.html#l00067">OUTCAT_COL_POSANGLE_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00070">OUTCAT_COL_PROB_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00072">OUTCAT_COL_PROB_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00071">OUTCAT_COL_PROB_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00074">OUTCAT_COL_PROB_UCD</a>, <a class="el" href="_catalogue_8h-source.html#l00073">OUTCAT_COL_PROB_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00039">OUTCAT_COL_RA_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00041">OUTCAT_COL_RA_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00040">OUTCAT_COL_RA_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00043">OUTCAT_COL_RA_UCD</a>, <a class="el" href="_catalogue_8h-source.html#l00042">OUTCAT_COL_RA_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00030">OUTCAT_EXT_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00029">OUTCAT_MAX_KEY_LEN</a>, <a class="el" href="_catalogue_8h-source.html#l00032">OUTCAT_NUM_GENERIC</a>, <a class="el" href="_catalogue_8cxx-source.html#l00045">sourceIdentify::set_fits_col_format()</a>, <a class="el" href="namespacesource_identify.html#a38a25">sourceIdentify::STATUS_MEM_ALLOC</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>.<div class="fragment"><pre class="fragment">00931                                                                         {
00932 
00933     <span class="comment">// Declare local variables</span>
00934     <span class="keywordtype">int</span>                                    fstatus;
00935     <span class="keywordtype">int</span>                                    col;
00936     <span class="keywordtype">int</span>                                    num_col;
00937     <span class="keywordtype">long</span>                                   iQty;
00938     <span class="keywordtype">long</span>                                   numQty;
00939     std::string                            form;
00940     std::vector&lt;std::string&gt;               qtyNames;
00941     std::vector&lt;std::string&gt;               qtyUnits;
00942     std::vector&lt;std::string&gt;               qtyUCDs;
00943     std::vector&lt;catalogAccess::Quantity&gt;   qtyDesc;
00944     <span class="keywordtype">char</span>                                   keyname[20];
00945     <span class="keywordtype">char</span>                                   comment[80];
00946     <span class="keywordtype">char</span>                                 **ttype;
00947     <span class="keywordtype">char</span>                                 **tform;
00948     <span class="keywordtype">char</span>                                 **tunit;
00949     <span class="keywordtype">char</span>                                 **tbucd;
00950 
00951     <span class="comment">// Debug mode: Entry</span>
00952     <span class="keywordflow">if</span> (par-&gt;logDebug())
00953       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::create_output_catalogue"</span>);
00954 
00955     <span class="comment">// Initialise temporary memory pointers</span>
00956     ttype   = NULL;
00957     tform   = NULL;
00958     tunit   = NULL;
00959     tbucd   = NULL;
00960     num_col = 0;
00961 
00962     <span class="comment">// Initialise FITSIO status</span>
00963     fstatus = (int)status;
00964 
00965     <span class="comment">// Single loop for common exit point</span>
00966     <span class="keywordflow">do</span> {
00967     
00968       <span class="comment">// Fall through in case of an error</span>
00969       <span class="keywordflow">if</span> (status != STATUS_OK)
00970         continue;
00971 
00972       <span class="comment">// If clobber=1 we make sure that the output catalogue does not yet exist</span>
00973       if (par-&gt;m_clobber)
00974         remove(par-&gt;m_outCatName.c_str());
00975         
00976       <span class="comment">// Create empty FITS file.</span>
00977       fstatus = fits_create_file(&amp;m_outFile, par-&gt;m_outCatName.c_str(), 
00978                                  &amp;fstatus);
00979       if (fstatus != 0) {
00980         <span class="keywordflow">if</span> (par-&gt;logTerse())
00981           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to create output catalogue '%s'."</span>, 
00982               fstatus, par-&gt;m_outCatName.c_str());
00983         <span class="keywordflow">continue</span>;
00984       }
00985 
00986       <span class="comment">// Initialise column index to the OUTCAT_NUM_GENERIC generic columns</span>
00987       num_col       = <a class="code" href="_catalogue_8h.html#a3">OUTCAT_NUM_GENERIC</a>;
00988       <a class="code" href="classsource_identify_1_1_catalogue.html#r11">m_num_src_Qty</a> = 0;
00989       <a class="code" href="classsource_identify_1_1_catalogue.html#r17">m_num_cpt_Qty</a> = 0;
00990 
00991       <span class="comment">// Add source catalogue columns</span>
00992       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getQuantityNames(&amp;qtyNames);
00993       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getQuantityUnits(&amp;qtyUnits);
00994       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getQuantityUCDs(&amp;qtyUCDs);
00995       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getQuantityDescription(&amp;qtyDesc);
00996       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
00997         <span class="keywordflow">if</span> ((par-&gt;m_srcCatQty.find(<span class="stringliteral">"*"</span>, 0)            != std::string::npos) ||
00998             (par-&gt;m_srcCatQty.find(qtyNames[iQty], 0) != std::string::npos)) {
00999 
01000           <span class="comment">// Increment number of source quantities and FITS file columns</span>
01001           <a class="code" href="classsource_identify_1_1_catalogue.html#r11">m_num_src_Qty</a>++;
01002           num_col++;
01003 
01004           <span class="comment">// Set quantity FITS column format</span>
01005           <a class="code" href="namespacesource_identify.html#a32">set_fits_col_format</a>(&amp;qtyDesc[iQty], &amp;form);
01006         
01007           <span class="comment">// Add quantity information to source quantity string</span>
01008           <a class="code" href="classsource_identify_1_1_catalogue.html#r13">m_src_Qty_ttype</a>.push_back(qtyNames[iQty]);
01009           <a class="code" href="classsource_identify_1_1_catalogue.html#r14">m_src_Qty_tform</a>.push_back(form);
01010           <a class="code" href="classsource_identify_1_1_catalogue.html#r15">m_src_Qty_tunit</a>.push_back(qtyUnits[iQty]);
01011           <a class="code" href="classsource_identify_1_1_catalogue.html#r16">m_src_Qty_tbucd</a>.push_back(qtyUCDs[iQty]);
01012         }
01013       }
01014 
01015       <span class="comment">// Add counterpart catalogue columns</span>
01016       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.getQuantityNames(&amp;qtyNames);
01017       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.getQuantityUnits(&amp;qtyUnits);
01018       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.getQuantityUCDs(&amp;qtyUCDs);
01019       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.getQuantityDescription(&amp;qtyDesc);
01020       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
01021         <span class="keywordflow">if</span> ((par-&gt;m_cptCatQty.find(<span class="stringliteral">"*"</span>, 0)            != std::string::npos) ||
01022             (par-&gt;m_cptCatQty.find(qtyNames[iQty], 0) != std::string::npos)) {
01023 
01024           <span class="comment">// Increment number of source quantities and FITS file columns</span>
01025           <a class="code" href="classsource_identify_1_1_catalogue.html#r17">m_num_cpt_Qty</a>++;
01026           num_col++;
01027 
01028           <span class="comment">// Set quantity FITS column format</span>
01029           <a class="code" href="namespacesource_identify.html#a32">set_fits_col_format</a>(&amp;qtyDesc[iQty], &amp;form);
01030         
01031           <span class="comment">// Add quantity information to source quantity string</span>
01032           <a class="code" href="classsource_identify_1_1_catalogue.html#r19">m_cpt_Qty_ttype</a>.push_back(qtyNames[iQty]);
01033           <a class="code" href="classsource_identify_1_1_catalogue.html#r20">m_cpt_Qty_tform</a>.push_back(form);
01034           <a class="code" href="classsource_identify_1_1_catalogue.html#r21">m_cpt_Qty_tunit</a>.push_back(qtyUnits[iQty]);
01035           <a class="code" href="classsource_identify_1_1_catalogue.html#r22">m_cpt_Qty_tbucd</a>.push_back(qtyUCDs[iQty]);
01036         }
01037       }
01038 
01039       <span class="comment">// Allocate temporary memory to hold column information</span>
01040       ttype = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[num_col];
01041       tform = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[num_col];
01042       tunit = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[num_col];
01043       tbucd = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[num_col];
01044       <span class="keywordflow">if</span> (ttype == NULL ||
01045           tform == NULL ||
01046           tunit == NULL ||
01047           tbucd == NULL) {
01048         status = <a class="code" href="namespacesource_identify.html#a38a25">STATUS_MEM_ALLOC</a>;
01049         <span class="keywordflow">if</span> (par-&gt;logTerse())
01050           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Memory allocation failure."</span>, (Status)status);
01051         <span class="keywordflow">continue</span>;
01052       }
01053       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
01054         ttype[col] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a1">OUTCAT_MAX_KEY_LEN</a>];
01055         tform[col] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a1">OUTCAT_MAX_KEY_LEN</a>];
01056         tunit[col] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a1">OUTCAT_MAX_KEY_LEN</a>];
01057         tbucd[col] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a1">OUTCAT_MAX_KEY_LEN</a>];
01058         <span class="keywordflow">if</span> (ttype[col] == NULL ||
01059             tform[col] == NULL ||
01060             tunit[col] == NULL ||
01061             tbucd[col] == NULL) {
01062           status = <a class="code" href="namespacesource_identify.html#a38a25">STATUS_MEM_ALLOC</a>;
01063           <span class="keywordflow">if</span> (par-&gt;logTerse())
01064             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Memory allocation failure."</span>, (Status)status);
01065           <span class="keywordflow">break</span>;
01066         }
01067         sprintf(ttype[col], <span class="stringliteral">"%s"</span>, <span class="stringliteral">""</span>);
01068         sprintf(tform[col], <span class="stringliteral">"%s"</span>, <span class="stringliteral">""</span>);
01069         sprintf(tunit[col], <span class="stringliteral">"%s"</span>, <span class="stringliteral">""</span>);
01070         sprintf(tbucd[col], <span class="stringliteral">"%s"</span>, <span class="stringliteral">""</span>);
01071       }
01072       <span class="keywordflow">if</span> (status != STATUS_OK)
01073         continue;
01074 
01075       <span class="comment">// Add generic columns</span>
01076       col = OUTCAT_COL_ID_COLNUM - 1;
01077       sprintf(ttype[col], "%s", OUTCAT_COL_ID_NAME);
01078       sprintf(tform[col], "%s", OUTCAT_COL_ID_FORM);
01079       sprintf(tbucd[col], "%s", OUTCAT_COL_ID_UCD);
01080       col = OUTCAT_COL_RA_COLNUM - 1;
01081       sprintf(ttype[col], "%s", OUTCAT_COL_RA_NAME);
01082       sprintf(tform[col], "%s", OUTCAT_COL_RA_FORM);
01083       sprintf(tunit[col], "%s", OUTCAT_COL_RA_UNIT);
01084       sprintf(tbucd[col], "%s", OUTCAT_COL_RA_UCD);
01085       col = OUTCAT_COL_DEC_COLNUM - 1;
01086       sprintf(ttype[col], "%s", OUTCAT_COL_DEC_NAME);
01087       sprintf(tform[col], "%s", OUTCAT_COL_DEC_FORM);
01088       sprintf(tunit[col], "%s", OUTCAT_COL_DEC_UNIT);
01089       sprintf(tbucd[col], "%s", OUTCAT_COL_DEC_UCD);
01090       col = OUTCAT_COL_MAJERR_COLNUM - 1;
01091       sprintf(ttype[col], "%s", OUTCAT_COL_MAJERR_NAME);
01092       sprintf(tform[col], "%s", OUTCAT_COL_MAJERR_FORM);
01093       sprintf(tunit[col], "%s", OUTCAT_COL_MAJERR_UNIT);
01094       sprintf(tbucd[col], "%s", OUTCAT_COL_MAJERR_UCD);
01095       col = OUTCAT_COL_MINERR_COLNUM - 1;
01096       sprintf(ttype[col], "%s", OUTCAT_COL_MINERR_NAME);
01097       sprintf(tform[col], "%s", OUTCAT_COL_MINERR_FORM);
01098       sprintf(tunit[col], "%s", OUTCAT_COL_MINERR_UNIT);
01099       sprintf(tbucd[col], "%s", OUTCAT_COL_MINERR_UCD);
01100       col = OUTCAT_COL_POSANGLE_COLNUM - 1;
01101       sprintf(ttype[col], "%s", OUTCAT_COL_POSANGLE_NAME);
01102       sprintf(tform[col], "%s", OUTCAT_COL_POSANGLE_FORM);
01103       sprintf(tunit[col], "%s", OUTCAT_COL_POSANGLE_UNIT);
01104       sprintf(tbucd[col], "%s", OUTCAT_COL_POSANGLE_UCD);
01105       col = OUTCAT_COL_PROB_COLNUM - 1;
01106       sprintf(ttype[col], "%s", OUTCAT_COL_PROB_NAME);
01107       sprintf(tform[col], "%s", OUTCAT_COL_PROB_FORM);
01108       sprintf(tunit[col], "%s", OUTCAT_COL_PROB_UNIT);
01109       sprintf(tbucd[col], "%s", OUTCAT_COL_PROB_UCD);
01110 
01111       <span class="comment">// Initialise column counter for additional columns</span>
01112       col = OUTCAT_NUM_GENERIC;
01113 
01114       <span class="comment">// Add source catalogue quantities</span>
01115       for (iQty = 0; iQty &lt; m_num_src_Qty; iQty++) {
01116         <a class="code" href="classsource_identify_1_1_catalogue.html#r12">m_src_Qty_colnum</a>.push_back(col+1);
01117         sprintf(ttype[col], <span class="stringliteral">"SRC_%s"</span>, m_src_Qty_ttype[iQty].c_str());
01118         sprintf(tform[col], m_src_Qty_tform[iQty].c_str());
01119         sprintf(tunit[col], m_src_Qty_tunit[iQty].c_str());
01120         sprintf(tbucd[col], m_src_Qty_tbucd[iQty].c_str());
01121         col++;
01122       }
01123 
01124       <span class="comment">// Add counterpart catalogue quantities</span>
01125       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; m_num_cpt_Qty; iQty++) {
01126         <a class="code" href="classsource_identify_1_1_catalogue.html#r18">m_cpt_Qty_colnum</a>.push_back(col+1);
01127         sprintf(ttype[col], <span class="stringliteral">"CPT_%s"</span>, m_cpt_Qty_ttype[iQty].c_str());
01128         sprintf(tform[col], m_cpt_Qty_tform[iQty].c_str());
01129         sprintf(tunit[col], m_cpt_Qty_tunit[iQty].c_str());
01130         sprintf(tbucd[col], m_cpt_Qty_tbucd[iQty].c_str());
01131         col++;
01132       }
01133 
01134       <span class="comment">// Create binary table</span>
01135       fstatus = fits_create_tbl(m_outFile, BINARY_TBL, 0, num_col, 
01136                                 ttype, tform, tunit,
01137                                 OUTCAT_EXT_NAME, &amp;fstatus);
01138       <span class="keywordflow">if</span> (fstatus != 0) {
01139         <span class="keywordflow">if</span> (par-&gt;logTerse())
01140           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to create empty catalogue '%s'."</span>, 
01141               fstatus, par-&gt;m_outCatName.c_str());
01142         <span class="keywordflow">continue</span>;
01143       }
01144       
01145       <span class="comment">// Write UCD keywords</span>
01146       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
01147         sprintf(keyname, <span class="stringliteral">"TBUCD%d"</span>, col+1);
01148         sprintf(comment, <span class="stringliteral">"UCD for field %3d"</span>, col+1);
01149         fstatus = fits_write_key(m_outFile, TSTRING, keyname, tbucd[col], 
01150                                  comment, &amp;fstatus);
01151         <span class="keywordflow">if</span> (fstatus != 0) {
01152           <span class="keywordflow">if</span> (par-&gt;logTerse())
01153             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to write keyword '%s'."</span>, 
01154                 fstatus, keyname);
01155           <span class="keywordflow">break</span>;
01156         }
01157       }
01158       <span class="keywordflow">if</span> (fstatus != 0)
01159         continue;
01160          
01161     } while (0); <span class="comment">// End of main do-loop</span>
01162 
01163     <span class="comment">// Free temporary memory</span>
01164     if (ttype != NULL) {
01165       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
01166         <span class="keywordflow">if</span> (ttype[col] != NULL) delete [] ttype[col];
01167       }
01168       delete [] ttype;
01169     }
01170     if (tform != NULL) {
01171       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
01172         <span class="keywordflow">if</span> (tform[col] != NULL) delete [] tform[col];
01173       }
01174       delete [] tform;
01175     }
01176     if (tunit != NULL) {
01177       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
01178         <span class="keywordflow">if</span> (tunit[col] != NULL) delete [] tunit[col];
01179       }
01180       delete [] tunit;
01181     }
01182     if (tbucd != NULL) {
01183       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
01184         <span class="keywordflow">if</span> (tbucd[col] != NULL) delete [] tbucd[col];
01185       }
01186       delete [] tbucd;
01187     }
01188 
01189     <span class="comment">// Set FITSIO status</span>
01190     if (status == STATUS_OK)
01191       status = (Status)fstatus;
01192 
01193     <span class="comment">// Debug mode: Entry</span>
01194     if (par-&gt;logDebug())
01195       Log(Log_0, " &lt;== EXIT: Catalogue::create_output_catalogue (status=%d)", 
01196           status);
01197     
01198     <span class="comment">// Return status</span>
01199     return status;
01200 
01201 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d14" doxytag="sourceIdentify::Catalogue::dump_counterpart_candidates"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::dump_counterpart_candidates           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01874">1874</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00095">sourceIdentify::CCElement::angsep</a>, <a class="el" href="_catalogue_8h-source.html#l00094">sourceIdentify::CCElement::index</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00149">m_cc</a>, <a class="el" href="_catalogue_8h-source.html#l00143">m_cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00148">m_numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00092">sourceIdentify::CCElement::prob</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00355">get_counterpart_candidates()</a>.<div class="fragment"><pre class="fragment">01874                                                                             {
01875 
01876     <span class="comment">// Declare local variables</span>
01877     <span class="keywordtype">long</span>        iCC;
01878     <span class="keywordtype">long</span>        iCpt;
01879     <span class="keywordtype">double</span>      cpt_ra;
01880     <span class="keywordtype">double</span>      cpt_dec;
01881     <span class="keywordtype">double</span>      cpt_error;
01882     std::string cpt_name;
01883     std::string obj_name;
01884 
01885     <span class="comment">// Debug mode: Entry</span>
01886     <span class="keywordflow">if</span> (par-&gt;logDebug())
01887       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::dump_counterpart_candidates"</span>);
01888 
01889     <span class="comment">// Single loop for common exit point</span>
01890     <span class="keywordflow">do</span> {
01891     
01892       <span class="comment">// Fall through in case of an error</span>
01893       <span class="keywordflow">if</span> (status != STATUS_OK)
01894         continue;
01895         
01896       <span class="comment">// Fall through if there are no counterpart candidates</span>
01897       if (m_numCC &lt; 1)
01898         continue;
01899 
01900       <span class="comment">// Determine the name of the generic quantity "object name"</span>
01901       obj_name = m_cpt.getNameObjName();
01902     
01903       <span class="comment">// Loop over counterpart candidates</span>
01904       for (iCC = 0; iCC &lt; m_numCC; iCC++) {
01905       
01906         <span class="comment">// Get index of candidate in counterpart catalogue</span>
01907         iCpt = <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].index;
01908 
01909         <span class="comment">// Extract information for counterpart candidate</span>
01910         <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.ra_deg(iCpt,  &amp;cpt_ra);
01911         <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.dec_deg(iCpt, &amp;cpt_dec);
01912         <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.posError_deg(iCpt, &amp;cpt_error);
01913         <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.getSValue(obj_name, iCpt, &amp;cpt_name);
01914 
01915         <span class="comment">// Dump counterpart candidate information</span>
01916         <span class="keywordflow">if</span> (!par-&gt;logVerbose()) {
01917           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"  Counterpart candidate %5d .....: %s Prob=%7.3f %%"</span>,
01918               iCC+1, cpt_name.c_str(), <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].prob*100.0);
01919         }
01920         <span class="keywordflow">else</span> {
01921           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"  Counterpart candidate %5d .....: %s Prob=%7.3f %%"</span>
01922               <span class="stringliteral">" (RA,DEC)=(%8.3f,%8.3f) +/- %8.3f  Sep=%8.3f deg"</span>,
01923               iCC+1, cpt_name.c_str(), <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].prob*100.0,
01924               cpt_ra, cpt_dec, cpt_error, <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].angsep);
01925         }
01926 
01927       } <span class="comment">// endfor: looped over counterpart candidats</span>
01928     
01929     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01930 
01931     <span class="comment">// Debug mode: Entry</span>
01932     <span class="keywordflow">if</span> (par-&gt;logDebug())
01933       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" &lt;== EXIT: Catalogue::dump_counterpart_candidates"</span>
01934           <span class="stringliteral">" (status=%d)"</span>, status);
01935     
01936     <span class="comment">// Return status</span>
01937     <span class="keywordflow">return</span> status;
01938 
01939 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d13" doxytag="sourceIdentify::Catalogue::dump_descriptor"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::dump_descriptor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">catalogAccess::Catalog *&nbsp;</td>
          <td class="mdname" nowrap> <em>cat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01784">1784</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, and <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00230">get_input_descriptor()</a>.<div class="fragment"><pre class="fragment">01784                                                                           {
01785 
01786     <span class="comment">// Declare local variables</span>
01787     <span class="keywordtype">long</span>                                               iQty;
01788     <span class="keywordtype">long</span>                                               numQty;
01789     <span class="keywordtype">long</span>                                               numRows;
01790     <span class="keywordtype">long</span>                                               len;
01791     <span class="keywordtype">long</span>                                               maxLenNames;
01792     <span class="keywordtype">long</span>                                               maxLenUnits;
01793     <span class="keywordtype">long</span>                                               maxLenUCDs;
01794     std::string                                        qtyType;
01795     std::vector&lt;std::string&gt;                           titles;
01796     std::vector&lt;std::string&gt;                           qtyNames;
01797     std::vector&lt;std::string&gt;                           qtyUnits;
01798     std::vector&lt;std::string&gt;                           qtyUCDs;
01799     std::vector&lt;catalogAccess::Quantity&gt;               qtyDesc;
01800     std::vector&lt;catalogAccess::Quantity::QuantityType&gt; qtyTypes;
01801 
01802     <span class="comment">// Single loop for common exit point</span>
01803     <span class="keywordflow">do</span> {
01804       
01805       <span class="comment">// Extract information from catalogue</span>
01806       cat-&gt;getCatalogTitles(&amp;titles);
01807       numQty = cat-&gt;getQuantityNames(&amp;qtyNames);
01808       numQty = cat-&gt;getQuantityUnits(&amp;qtyUnits);
01809       numQty = cat-&gt;getQuantityUCDs(&amp;qtyUCDs);
01810       numQty = cat-&gt;getQuantityDescription(&amp;qtyDesc);
01811       numQty = cat-&gt;getQuantityTypes(&amp;qtyTypes);
01812       cat-&gt;getNumRows(&amp;numRows);
01813       
01814       <span class="comment">// Get string lengths</span>
01815       maxLenNames = 0;
01816       maxLenUnits = 0;
01817       maxLenUCDs  = 0;
01818       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
01819         <span class="keywordflow">if</span> ((len = strlen(qtyNames[iQty].c_str())) &gt; maxLenNames)
01820           maxLenNames = len;
01821         if ((len = strlen(qtyUnits[iQty].c_str())) &gt; maxLenUnits)
01822           maxLenUnits = len;
01823         if ((len = strlen(qtyUCDs[iQty].c_str())) &gt; maxLenUCDs)
01824           maxLenUCDs = len;
01825       }
01826 
01827       <span class="comment">// Dump catalogue information</span>
01828       Log(Log_2, " Catalogue ........................: %s", titles[0].c_str());
01829       Log(Log_2, " Number of entries (rows) .........: %d", numRows);
01830       Log(Log_2, " Number of quantities (columns) ...: %d", numQty);
01831 
01832       <span class="comment">// Dump information about catalogue quantitites</span>
01833       for (iQty = 0; iQty &lt; numQty; iQty++) {
01834       
01835         <span class="comment">// Set quantity type</span>
01836         <span class="keywordflow">switch</span> (qtyTypes[iQty]) {
01837         <span class="keywordflow">case</span> 0:
01838           qtyType = <span class="stringliteral">"vector ("</span> + qtyDesc[iQty].m_format + <span class="stringliteral">")"</span>;
01839           <span class="keywordflow">break</span>;
01840         <span class="keywordflow">case</span> 1:
01841           qtyType = <span class="stringliteral">"numerical ("</span> + qtyDesc[iQty].m_format + <span class="stringliteral">")"</span>;
01842           <span class="keywordflow">break</span>;
01843         <span class="keywordflow">case</span> 2:
01844           qtyType = <span class="stringliteral">"string ("</span> + qtyDesc[iQty].m_format + <span class="stringliteral">")"</span>;
01845           <span class="keywordflow">break</span>;
01846         <span class="keywordflow">default</span>:
01847           qtyType = <span class="stringliteral">"unknown"</span>;
01848           <span class="keywordflow">break</span>;
01849         }
01850         
01851         <span class="comment">// Dump quantity</span>
01852         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"  Quantity %3d ....................: %*s %*s %*s (%s)"</span>, 
01853                  iQty+1, 
01854                  maxLenNames, qtyNames[iQty].c_str(),
01855                  maxLenUnits, qtyUnits[iQty].c_str(),
01856                  maxLenUCDs, qtyUCDs[iQty].c_str(),
01857                  qtyType.c_str());
01858 
01859       } <span class="comment">// endfor: looped over quantities</span>
01860     
01861     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01862     
01863     <span class="comment">// Return status</span>
01864     <span class="keywordflow">return</span> status;
01865 
01866 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d10" doxytag="sourceIdentify::Catalogue::eval_output_catalogue_quantities"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::eval_output_catalogue_quantities           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01505">1505</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8cxx-source.html#l00097">sourceIdentify::fits_tform_binary()</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00145">m_outFile</a>, <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>, and <a class="el" href="namespacesource_identify.html#a37a14">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>.<div class="fragment"><pre class="fragment">01506                                                                   {
01507 
01508     <span class="comment">// Declare local variables</span>
01509     <span class="keywordtype">int</span>                    fstatus;
01510     <span class="keywordtype">int</span>                    datatype;
01511     <span class="keywordtype">int</span>                    naxis;
01512     <span class="keywordtype">long</span>                   nelements;
01513     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>          iQty;
01514     std::string::size_type numQty;
01515     std::string            tform;
01516 
01517     <span class="comment">// Debug mode: Entry</span>
01518     <span class="keywordflow">if</span> (par-&gt;logDebug())
01519       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::eval_output_catalogue_quantities"</span>);
01520 
01521     <span class="comment">// Initialise FITSIO status</span>
01522     fstatus = (int)status;
01523 
01524     <span class="comment">// Single loop for common exit point</span>
01525     <span class="keywordflow">do</span> {
01526     
01527       <span class="comment">// Fall through in case of an error</span>
01528       <span class="keywordflow">if</span> (status != STATUS_OK)
01529         continue;
01530 
01531       <span class="comment">// Determine number of new output catalogue quantities. Fall through if</span>
01532       <span class="comment">// there are no new output catalogue quantities</span>
01533       numQty = par-&gt;m_outCatQtyName.size();
01534       if (numQty &lt; 1)
01535         continue;
01536 
01537       <span class="comment">// Dump header</span>
01538       if (par-&gt;logNormal()) {
01539         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">""</span>);
01540         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"Add new output catalogue quantities:"</span>);
01541         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"===================================="</span>);
01542       }
01543 
01544       <span class="comment">// Add all new output catalogue quantities</span>
01545       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
01546 
01547         <span class="comment">// Test expression to determine the format of the new column</span>
01548         fstatus = fits_test_expr(m_outFile,
01549                                  par-&gt;m_outCatQtyFormula[iQty].c_str(),
01550                                  0, &amp;datatype, &amp;nelements, &amp;naxis, NULL,
01551                                  &amp;fstatus);
01552         <span class="keywordflow">if</span> (fstatus != 0) {
01553           <span class="keywordflow">if</span> (par-&gt;logTerse())
01554             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Warning_2, <span class="stringliteral">" Unable to evaluate expression &lt;%s='%s'&gt; for"</span>
01555                 <span class="stringliteral">" creating new output catalogue quantity (status=%d)."</span>,
01556                 par-&gt;m_outCatQtyName[iQty].c_str(), 
01557                 par-&gt;m_outCatQtyFormula[iQty].c_str(),
01558                 fstatus);
01559           fstatus = 0;
01560           <span class="keywordflow">continue</span>;
01561         }
01562 
01563         <span class="comment">// Set column format</span>
01564         <span class="keywordflow">if</span> (nelements &lt; 1) 
01565           nelements = 1;
01566         fits_tform_binary(datatype, nelements, 0, &amp;tform);
01567 
01568         <span class="comment">// Create new FITS column</span>
01569         fstatus = fits_calculator(m_outFile, 
01570                                   par-&gt;m_outCatQtyFormula[iQty].c_str(),
01571                                   m_outFile,
01572                                   par-&gt;m_outCatQtyName[iQty].c_str(),
01573                                   tform.c_str(), 
01574                                   &amp;fstatus);
01575         if (fstatus != 0) {
01576           <span class="keywordflow">if</span> (par-&gt;logTerse())
01577             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to evaluate quantity &lt;%s='%s'&gt; in output"</span>
01578                 <span class="stringliteral">" catalogue."</span>, 
01579                 fstatus, 
01580                 par-&gt;m_outCatQtyName[iQty].c_str(), 
01581                 par-&gt;m_outCatQtyFormula[iQty].c_str());
01582           <span class="keywordflow">break</span>;
01583         }
01584 
01585         <span class="comment">// Dump new output catalogue quantities information</span>
01586         <span class="keywordflow">if</span> (par-&gt;logNormal()) {
01587           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" New quantity .....................: %s = %s"</span>
01588               <span class="stringliteral">" (format='%s')"</span>,
01589               par-&gt;m_outCatQtyName[iQty].c_str(),
01590               par-&gt;m_outCatQtyFormula[iQty].c_str(),
01591               tform.c_str());
01592         }
01593 
01594       }
01595       <span class="keywordflow">if</span> (fstatus != 0)
01596         continue;
01597 
01598     } while (0); <span class="comment">// End of main do-loop</span>
01599 
01600     <span class="comment">// Set FITSIO status</span>
01601     if (status == STATUS_OK)
01602       status = (Status)fstatus;
01603 
01604     <span class="comment">// Debug mode: Entry</span>
01605     if (par-&gt;logDebug())
01606       Log(Log_0, " &lt;== EXIT: Catalogue::eval_output_catalogue_quantities"
01607           " (status=%d)", status);
01608     
01609     <span class="comment">// Return status</span>
01610     return status;
01611 
01612 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d1" doxytag="sourceIdentify::Catalogue::free_memory"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void sourceIdentify::Catalogue::free_memory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00204">204</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>, and <a class="el" href="_catalogue_8h-source.html#l00149">m_cc</a>.
<p>
Referenced by <a class="el" href="_catalogue_8h-source.html#l00168">~Catalogue()</a>.<div class="fragment"><pre class="fragment">00204                                 {
00205 
00206     <span class="comment">// Declare local variables</span>
00207 
00208     <span class="comment">// Single loop for common exit point</span>
00209     <span class="keywordflow">do</span> {
00210 
00211       <span class="comment">// Free temporary memory</span>
00212       <span class="keywordflow">if</span> (m_cc != NULL) delete [] m_cc;
00213 
00214       <span class="comment">// Initialise memory</span>
00215       init_memory();
00216 
00217     } while (0); <span class="comment">// End of main do-loop</span>
00218     
00219     <span class="comment">// Return</span>
00220     return;
00221 
00222 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d4" doxytag="sourceIdentify::Catalogue::get_counterpart_candidates"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_counterpart_candidates           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>iSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00355">355</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01874">dump_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00678">get_probability()</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00142">m_src</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>.<div class="fragment"><pre class="fragment">00356                                                             {
00357 
00358     <span class="comment">// Declare local variables</span>
00359     <span class="keywordtype">double</span>      ra;
00360     <span class="keywordtype">double</span>      dec;
00361     <span class="keywordtype">double</span>      pos_err;
00362     std::string src_name;
00363     std::string obj_name;
00364 
00365     <span class="comment">// Debug mode: Entry</span>
00366     <span class="keywordflow">if</span> (par-&gt;logDebug())
00367       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::get_counterpart_candidates"</span>);
00368 
00369     <span class="comment">// Single loop for common exit point</span>
00370     <span class="keywordflow">do</span> {
00371 
00372       <span class="comment">// Determine the name of the generic quantity "object name"</span>
00373       obj_name = <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getNameObjName();
00374 
00375       <span class="comment">// Get source coordinates</span>
00376       <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.ra_deg(iSrc,  &amp;ra);
00377       <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.dec_deg(iSrc, &amp;dec);
00378       <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.posError_deg(iSrc, &amp;pos_err);
00379       <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.getSValue(obj_name, iSrc, &amp;src_name);
00380 
00381       <span class="comment">// Optionally dump source information</span>
00382       <span class="keywordflow">if</span> (par-&gt;logExplicit()) {
00383         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">""</span>);
00384         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Source %5d .....................: %s"</span>
00385             <span class="stringliteral">" (%8.3f,%8.3f) +/- %8.3f"</span>,
00386             iSrc, src_name.c_str(), ra, dec, pos_err);
00387       }
00388         
00389       <span class="comment">// Get counterparts near the source position</span>
00390       status = <a class="code" href="classsource_identify_1_1_catalogue.html#d5">get_counterparts</a>(par, &amp;ra, &amp;dec, status);
00391       <span class="keywordflow">if</span> (status != STATUS_OK)
00392         continue;
00393 
00394       <span class="comment">// Assign probability for each counterpart</span>
00395       status = get_probability(par, iSrc, status);
00396       if (status != STATUS_OK)
00397         continue;
00398 
00399       <span class="comment">// Add all counterpart candidates to output catalogue</span>
00400       status = add_counterpart_candidates(par, iSrc, status);
00401       if (status != STATUS_OK)
00402         continue;
00403 
00404       <span class="comment">// Optionally dump counterpart candidats</span>
00405       if (par-&gt;logExplicit())
00406         dump_counterpart_candidates(par, status);
00407 
00408     } while (0); <span class="comment">// End of main do-loop</span>
00409 
00410     <span class="comment">// Debug mode: Entry</span>
00411     if (par-&gt;logDebug())
00412       Log(Log_0, " &lt;== EXIT: Catalogue::get_counterpart_candidates (status=%d)", 
00413           status);
00414     
00415     <span class="comment">// Return status</span>
00416     return status;
00417 
00418 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d5" doxytag="sourceIdentify::Catalogue::get_counterparts"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_counterparts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap> <em>ra</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap> <em>dec</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00435">435</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00095">sourceIdentify::CCElement::angsep</a>, <a class="el" href="_catalogue_8h-source.html#l00101">sourceIdentify::ObjectInfo::dec</a>, <a class="el" href="_catalogue_8h-source.html#l00081">sourceIdentify::deg2rad</a>, <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8cxx-source.html#l00297">get_input_catalogue()</a>, <a class="el" href="_catalogue_8h-source.html#l00086">sourceIdentify::CCElement::id</a>, <a class="el" href="_catalogue_8h-source.html#l00094">sourceIdentify::CCElement::index</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00149">m_cc</a>, <a class="el" href="_catalogue_8h-source.html#l00143">m_cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00144">m_cpt_loc</a>, <a class="el" href="_catalogue_8h-source.html#l00140">m_fCptLoaded</a>, <a class="el" href="_catalogue_8h-source.html#l00141">m_filter_maxsep</a>, <a class="el" href="_catalogue_8h-source.html#l00139">m_maxCptLoad</a>, <a class="el" href="_catalogue_8h-source.html#l00148">m_numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00138">m_numCpt</a>, <a class="el" href="_catalogue_8h-source.html#l00088">sourceIdentify::CCElement::pos_eq_dec</a>, <a class="el" href="_catalogue_8h-source.html#l00087">sourceIdentify::CCElement::pos_eq_ra</a>, <a class="el" href="_catalogue_8h-source.html#l00091">sourceIdentify::CCElement::pos_err_ang</a>, <a class="el" href="_catalogue_8h-source.html#l00089">sourceIdentify::CCElement::pos_err_maj</a>, <a class="el" href="_catalogue_8h-source.html#l00090">sourceIdentify::CCElement::pos_err_min</a>, <a class="el" href="_catalogue_8h-source.html#l00092">sourceIdentify::CCElement::prob</a>, <a class="el" href="_catalogue_8h-source.html#l00096">sourceIdentify::CCElement::prob_angsep</a>, <a class="el" href="_catalogue_8h-source.html#l00100">sourceIdentify::ObjectInfo::ra</a>, <a class="el" href="namespacesource_identify.html#a38a31">sourceIdentify::STATUS_CAT_EMPTY</a>, <a class="el" href="namespacesource_identify.html#a38a25">sourceIdentify::STATUS_MEM_ALLOC</a>, <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>, and <a class="el" href="namespacesource_identify.html#a37a14">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00355">get_counterpart_candidates()</a>.<div class="fragment"><pre class="fragment">00436                                                   {
00437 
00438     <span class="comment">// Declare local variables</span>
00439     <span class="keywordtype">long</span>        iCpt;
00440     <span class="keywordtype">long</span>        numNoPos;
00441     <span class="keywordtype">long</span>        numRA;
00442     <span class="keywordtype">long</span>        numDec;
00443     <span class="keywordtype">double</span>      src_dec_sin;
00444     <span class="keywordtype">double</span>      src_dec_cos;
00445     <span class="keywordtype">double</span>      cpt_dec_min;
00446     <span class="keywordtype">double</span>      cpt_dec_max;
00447     <span class="keywordtype">double</span>      cpt_ra_min;
00448     <span class="keywordtype">double</span>      cpt_ra_max;
00449     <span class="keywordtype">double</span>      filter_maxsep;
00450     ObjectInfo *cpt_info;
00451     CCElement  *cpt_ptr;
00452 
00453     <span class="comment">// Timing measurements</span>
00454 <span class="preprocessor">    #if CATALOGUE_TIMING</span>
00455 <span class="preprocessor"></span>    clock_t t_start_loop;
00456     clock_t t_start_tot   = clock();
00457     <span class="keywordtype">float</span>   t_elapse        = 0.0;
00458     <span class="keywordtype">float</span>   t_elapse_loop   = 0.0;
00459 <span class="preprocessor">    #endif</span>
00460 <span class="preprocessor"></span>
00461     <span class="comment">// Debug mode: Entry</span>
00462     <span class="keywordflow">if</span> (par-&gt;logDebug())
00463       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::get_counterparts"</span>);
00464 
00465     <span class="comment">// Single loop for common exit point</span>
00466     <span class="keywordflow">do</span> {
00467 
00468       <span class="comment">// Reset statistics</span>
00469       <a class="code" href="classsource_identify_1_1_catalogue.html#r9">m_numCC</a>  = 0;
00470       numNoPos = 0;
00471       numRA    = 0;
00472       numDec   = 0;
00473 
00474       <span class="comment">// Calculate sin and cos of source latitude</span>
00475       src_dec_sin = sin(*dec * deg2rad);
00476       src_dec_cos = cos(*dec * deg2rad);
00477       
00478       <span class="comment">// Define bounding box around source position. The declination</span>
00479       <span class="comment">// range of the bounding box is constrained to [-90,90] deg, the</span>
00480       <span class="comment">// Right Ascension boundaries are put into the interval [0,360[ deg.</span>
00481       cpt_dec_min = *dec - <a class="code" href="classsource_identify_1_1_catalogue.html#r4">m_filter_maxsep</a>;
00482       cpt_dec_max = *dec + m_filter_maxsep;
00483       <span class="keywordflow">if</span> (cpt_dec_min &lt; -90.0) cpt_dec_min = -90.0;
00484       if (cpt_dec_max &gt;  90.0) cpt_dec_max =  90.0;
00485       if (src_dec_cos &gt; 0.0) {
00486         filter_maxsep = m_filter_maxsep / src_dec_cos;
00487         <span class="keywordflow">if</span> (filter_maxsep &gt; 180.0)
00488           filter_maxsep = 180.0;
00489       }
00490       else
00491         filter_maxsep = 180.0;
00492       cpt_ra_min  = *ra - filter_maxsep;
00493       cpt_ra_max  = *ra + filter_maxsep;
00494       cpt_ra_min = cpt_ra_min - <span class="keywordtype">double</span>(<span class="keywordtype">long</span>(cpt_ra_min / 360.0) * 360.0);
00495       if (cpt_ra_min &lt; 0.0) cpt_ra_min += 360.0;
00496       cpt_ra_max = cpt_ra_max - <span class="keywordtype">double</span>(<span class="keywordtype">long</span>(cpt_ra_max / 360.0) * 360.0);
00497       if (cpt_ra_max &lt; 0.0) cpt_ra_max += 360.0;
00498     
00499       <span class="comment">// If the counterpart catalogue is big then load only sources from a</span>
00500       <span class="comment">// region around the specified position ...</span>
00501       if (m_numCpt &gt; m_maxCptLoad) {
00502       }
00503       
00504       <span class="comment">// ... otherwise load the entire counterpart catalogue</span>
00505       <span class="keywordflow">else</span> {
00506 
00507         <span class="comment">// Load only if noy yet done ...</span>
00508         <span class="keywordflow">if</span> (!m_fCptLoaded) {
00509 
00510           <span class="comment">// Load counterpart catalogue</span>
00511           status = <a class="code" href="classsource_identify_1_1_catalogue.html#d3">get_input_catalogue</a>(par, par-&gt;m_cptCatName, &amp;m_cpt, status);
00512           <span class="keywordflow">if</span> (status != STATUS_OK) {
00513             <span class="keywordflow">if</span> (par-&gt;logTerse())
00514               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to load counterpart catalogue '%s'"</span>
00515                   <span class="stringliteral">" data."</span>, (Status)status, par-&gt;m_cptCatName.c_str());
00516             <span class="keywordflow">continue</span>;
00517           }
00518           <span class="keywordflow">else</span> {
00519             <span class="keywordflow">if</span> (par-&gt;logVerbose())
00520               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Counterpart catalogue loaded."</span>);
00521           }
00522 
00523           <span class="comment">// Determine the number of sources in counterpart catalogue. Stop if</span>
00524           <span class="comment">// the catalogue is empty</span>
00525           <a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.getNumRows(&amp;m_numCpt);
00526           <span class="keywordflow">if</span> (m_numCpt &lt; 1) {
00527             status = <a class="code" href="namespacesource_identify.html#a38a31">STATUS_CAT_EMPTY</a>;
00528             <span class="keywordflow">if</span> (par-&gt;logTerse())
00529               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Counterpart catalogue is empty. Stop."</span>, 
00530                   (Status)status);
00531             <span class="keywordflow">continue</span>;
00532           }
00533           <span class="keywordflow">else</span> {
00534             <span class="keywordflow">if</span> (par-&gt;logVerbose())
00535               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Counterpart catalogue contains %d sources."</span>, 
00536                   m_numCpt);
00537           }
00538           
00539           <span class="comment">// Allocate memory for counterpart candidate search</span>
00540           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>      = <span class="keyword">new</span> CCElement[<a class="code" href="classsource_identify_1_1_catalogue.html#r1">m_numCpt</a>];
00541           <a class="code" href="classsource_identify_1_1_catalogue.html#r7">m_cpt_loc</a> = <span class="keyword">new</span> ObjectInfo[<a class="code" href="classsource_identify_1_1_catalogue.html#r1">m_numCpt</a>];
00542           <span class="keywordflow">if</span> (m_cc == NULL || m_cpt_loc == NULL) {
00543             status = <a class="code" href="namespacesource_identify.html#a38a25">STATUS_MEM_ALLOC</a>;
00544             <span class="keywordflow">if</span> (par-&gt;logTerse())
00545               <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Memory allocation failure."</span>, (Status)status);
00546             <span class="keywordflow">continue</span>;
00547           }
00548           
00549           <span class="comment">// Extract counterpart location information</span>
00550           cpt_info = <a class="code" href="classsource_identify_1_1_catalogue.html#r7">m_cpt_loc</a>;
00551           <span class="keywordflow">for</span> (iCpt = 0; iCpt &lt; m_numCpt; iCpt++, cpt_info++) {
00552           
00553             <span class="comment">// Get location. If no location is available then set it to 9999.</span>
00554             <span class="comment">// Put counterpart Right Ascension in interval [0,2pi[</span>
00555             <span class="keywordflow">if</span> ((<a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.ra_deg(iCpt,  &amp;(cpt_info-&gt;ra))  != IS_OK) ||
00556                 (<a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.dec_deg(iCpt, &amp;(cpt_info-&gt;dec)) != IS_OK)) {
00557               cpt_info-&gt;ra  = 9999;
00558               cpt_info-&gt;dec = 9999;
00559             }
00560             <span class="keywordflow">else</span> {
00561               cpt_info-&gt;ra = cpt_info-&gt;ra - 
00562                              double(<span class="keywordtype">long</span>(cpt_info-&gt;ra / 360.0) * 360.0);
00563               <span class="keywordflow">if</span> (cpt_info-&gt;ra &lt; 0.0) cpt_info-&gt;ra += 360.0;
00564             }
00565             
00566           } <span class="comment">// endfor: looped over all counterparts</span>
00567  
00568           <span class="comment">// Bookkeep catalogue loading</span>
00569           m_fCptLoaded = 1;
00570           
00571         } <span class="comment">// endif: catalogue was not yet loaded</span>
00572       } <span class="comment">// endelse: entire catalogue requested</span>
00573 
00574       <span class="comment">// Initialise counterpart pointers</span>
00575       cpt_info = m_cpt_loc;
00576       cpt_ptr  = m_cc;
00577 
00578       <span class="comment">// Loop over counterparts</span>
00579       #if CATALOGUE_TIMING
00580       t_start_loop = clock();
00581       #endif
00582       for (iCpt = 0; iCpt &lt; m_numCpt; iCpt++, cpt_info++) {
00583 
00584         <span class="comment">// Filter counterpart if it falls outside the declination range. If</span>
00585         <span class="comment">// the declination is larger than 9000 than the counterpart has no</span>
00586         <span class="comment">// location information and should be skipped ...</span>
00587         <span class="keywordflow">if</span> (cpt_info-&gt;dec &lt; cpt_dec_min || cpt_info-&gt;dec &gt; cpt_dec_max) {
00588           <span class="keywordflow">if</span> (cpt_info-&gt;dec &gt; 9000.0) {
00589             numNoPos++;
00590             <span class="keywordflow">continue</span>;
00591           }
00592           <span class="keywordflow">else</span> {
00593             numDec++;
00594             <span class="keywordflow">continue</span>;
00595           }
00596         }
00597 
00598         <span class="comment">// Filter source if it falls outside the Right Ascension range. The</span>
00599         <span class="comment">// first case handles no R.A. wrap around ...</span>
00600         <span class="keywordflow">if</span> (cpt_ra_min &lt; cpt_ra_max) {
00601           <span class="keywordflow">if</span> (cpt_info-&gt;ra &lt; cpt_ra_min || cpt_info-&gt;ra &gt; cpt_ra_max) {
00602             numRA++;
00603             <span class="keywordflow">continue</span>;
00604           }
00605         }
00606         <span class="comment">// ... and this one R.A wrap around</span>
00607         <span class="keywordflow">else</span> {
00608           <span class="keywordflow">if</span> (cpt_info-&gt;ra &lt; cpt_ra_min &amp;&amp; cpt_info-&gt;ra &gt; cpt_ra_max) {
00609             numRA++;
00610             <span class="keywordflow">continue</span>;
00611           }
00612         }
00613         
00614         <span class="comment">// If we are still alive then we keep the counterpart as candidat</span>
00615         cpt_ptr-&gt;id          = <span class="stringliteral">"NULL"</span>;
00616         cpt_ptr-&gt;pos_eq_ra   = 0.0;
00617         cpt_ptr-&gt;pos_eq_dec  = 0.0;
00618         cpt_ptr-&gt;pos_err_maj = 0.0;
00619         cpt_ptr-&gt;pos_err_min = 0.0;
00620         cpt_ptr-&gt;pos_err_ang = 0.0;
00621         cpt_ptr-&gt;prob        = 0.0;
00622         cpt_ptr-&gt;index       = iCpt;
00623         cpt_ptr-&gt;angsep      = 0.0;
00624         cpt_ptr-&gt;prob_angsep = 0.0;
00625         cpt_ptr++;
00626         <a class="code" href="classsource_identify_1_1_catalogue.html#r9">m_numCC</a>++;
00627         
00628       } <span class="comment">// endfor: looped over all counterpart candidates</span>
00629 
00630       <span class="comment">// Optionally dump counterpart filter statistics</span>
00631       <span class="keywordflow">if</span> (par-&gt;logExplicit()) {
00632         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"  Filter step candidates ..........: %d"</span>, m_numCC);
00633         <span class="keywordflow">if</span> (par-&gt;logVerbose()) {
00634           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"    Outside declination range .....: %d [%.3f - %.3f]"</span>, 
00635               numDec, cpt_dec_min, cpt_dec_max);
00636           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"    Outside Right Ascension range .: %d [%.3f - %.3f["</span>, 
00637               numRA, cpt_ra_min, cpt_ra_max);
00638         }
00639         <span class="keywordflow">if</span> (numNoPos &gt; 0)
00640           Log(Warning_2, "    No positions ..................: %d", numNoPos);
00641       }
00642       #if CATALOGUE_TIMING
00643       t_elapse_loop += (<span class="keywordtype">float</span>)(clock() - t_start_loop) / (<span class="keywordtype">float</span>)CLOCKS_PER_SEC;
00644       #endif
00645 
00646     } while (0); <span class="comment">// End of main do-loop</span>
00647 
00648     <span class="comment">// Timing measurements</span>
00649     #if CATALOGUE_TIMING
00650     t_elapse += (<span class="keywordtype">float</span>)(clock() - t_start_tot) / (<span class="keywordtype">float</span>)CLOCKS_PER_SEC;
00651     Log(Log_0, "  Filter step timing ..............:");
00652     Log(Log_0, "    Total CPU sec used ............: %.5f", t_elapse);
00653     Log(Log_0, "    CPU sec spent in loop .........: %.5f", t_elapse_loop);
00654     #endif
00655 
00656     <span class="comment">// Debug mode: Entry</span>
00657     if (par-&gt;logDebug())
00658       Log(Log_0, " &lt;== EXIT: Catalogue::get_counterparts (status=%d)", 
00659           status);
00660     
00661     <span class="comment">// Return status</span>
00662     return status;
00663 
00664 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d3" doxytag="sourceIdentify::Catalogue::get_input_catalogue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_input_catalogue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::string&nbsp;</td>
          <td class="mdname" nowrap> <em>catName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>catalogAccess::Catalog *&nbsp;</td>
          <td class="mdname" nowrap> <em>cat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00297">297</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00142">m_src</a>, <a class="el" href="namespacesource_identify.html#a38a30">sourceIdentify::STATUS_CAT_NOT_FOUND</a>, and <a class="el" href="namespacesource_identify.html#a37a14">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>.<div class="fragment"><pre class="fragment">00299                                                      {
00300 
00301     <span class="comment">// Declare local variables</span>
00302     <span class="keywordtype">int</span> caterr;
00303 
00304     <span class="comment">// Debug mode: Entry</span>
00305     <span class="keywordflow">if</span> (par-&gt;logDebug())
00306       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::get_input_catalogue"</span>);
00307 
00308     <span class="comment">// Single loop for common exit point</span>
00309     <span class="keywordflow">do</span> {
00310 
00311       <span class="comment">// First interpret the input string as filename and load the catalogue</span>
00312       <span class="comment">// from the file. If this fails then interpret input string as</span>
00313       <span class="comment">// catalogue name and load from WEB.</span>
00314       caterr = cat-&gt;import(catName);
00315       <span class="keywordflow">if</span> (caterr &lt; 0) {
00316         <span class="keywordflow">if</span> (par-&gt;logVerbose())
00317           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Warning_2, <span class="stringliteral">"%d : Unable to load catalogue '%s' from file."</span>,
00318               caterr, catName.c_str());
00319         caterr = <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.importWeb(catName);
00320         <span class="keywordflow">if</span> (caterr &lt; 0) {
00321           <span class="keywordflow">if</span> (par-&gt;logTerse())
00322             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to load catalogue '%s' from file or web."</span>,
00323                 caterr, catName.c_str());
00324           status = <a class="code" href="namespacesource_identify.html#a38a30">STATUS_CAT_NOT_FOUND</a>;
00325           <span class="keywordflow">continue</span>;
00326         }
00327         <span class="keywordflow">else</span> {
00328           <span class="keywordflow">if</span> (par-&gt;logVerbose())
00329             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Loaded catalogue '%s' from web."</span>, catName.c_str());
00330         }
00331       }
00332       <span class="keywordflow">else</span> {
00333         <span class="keywordflow">if</span> (par-&gt;logVerbose())
00334           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Loaded catalogue '%s' from file."</span>, catName.c_str());
00335       }
00336       
00337     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00338 
00339     <span class="comment">// Debug mode: Entry</span>
00340     <span class="keywordflow">if</span> (par-&gt;logDebug())
00341       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" &lt;== EXIT: Catalogue::get_input_catalogue (status=%d)"</span>, 
00342           status);
00343     
00344     <span class="comment">// Return status</span>
00345     <span class="keywordflow">return</span> status;
00346 
00347 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d2" doxytag="sourceIdentify::Catalogue::get_input_descriptor"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_input_descriptor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::string&nbsp;</td>
          <td class="mdname" nowrap> <em>catName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>catalogAccess::Catalog *&nbsp;</td>
          <td class="mdname" nowrap> <em>cat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00230">230</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l01784">dump_descriptor()</a>, <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00142">m_src</a>, <a class="el" href="namespacesource_identify.html#a38a30">sourceIdentify::STATUS_CAT_NOT_FOUND</a>, <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>, and <a class="el" href="namespacesource_identify.html#a37a14">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>.<div class="fragment"><pre class="fragment">00232                                                       {
00233 
00234     <span class="comment">// Declare local variables</span>
00235     <span class="keywordtype">int</span> caterr;
00236 
00237     <span class="comment">// Debug mode: Entry</span>
00238     <span class="keywordflow">if</span> (par-&gt;logDebug())
00239       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::get_input_descriptor"</span>);
00240 
00241     <span class="comment">// Single loop for common exit point</span>
00242     <span class="keywordflow">do</span> {
00243     
00244       <span class="comment">// First interpret the input string as filename and load the catalogue</span>
00245       <span class="comment">// from the file. If this fails then interpret input string as</span>
00246       <span class="comment">// catalogue name and load from WEB.</span>
00247       caterr = cat-&gt;importDescription(catName);
00248       <span class="keywordflow">if</span> (caterr &lt; 0) {
00249         <span class="keywordflow">if</span> (par-&gt;logVerbose())
00250           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Warning_2, <span class="stringliteral">"%d : Unable to load catalogue '%s' descriptor from"</span>
00251               <span class="stringliteral">" file."</span>, caterr, catName.c_str());
00252         caterr = <a class="code" href="classsource_identify_1_1_catalogue.html#r5">m_src</a>.importDescriptionWeb(catName);
00253         <span class="keywordflow">if</span> (caterr &lt; 0) {
00254           <span class="keywordflow">if</span> (par-&gt;logTerse())
00255             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to load catalogue '%s' descriptor from"</span>
00256                 <span class="stringliteral">" file or web."</span>, caterr, catName.c_str());
00257           status = <a class="code" href="namespacesource_identify.html#a38a30">STATUS_CAT_NOT_FOUND</a>;
00258           <span class="keywordflow">continue</span>;
00259         }
00260         <span class="keywordflow">else</span> {
00261           <span class="keywordflow">if</span> (par-&gt;logVerbose())
00262             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Loaded catalogue '%s' descriptor from web."</span>, 
00263                 catName.c_str());
00264         }
00265       }
00266       <span class="keywordflow">else</span> {
00267         <span class="keywordflow">if</span> (par-&gt;logVerbose())
00268           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Loaded catalogue '%s' descriptor from file."</span>, 
00269               catName.c_str());
00270       }
00271       
00272       <span class="comment">// Debug mode: dump catalogue descriptor</span>
00273       <span class="keywordflow">if</span> (par-&gt;logVerbose()) {
00274         status = <a class="code" href="classsource_identify_1_1_catalogue.html#d13">dump_descriptor</a>(cat, status);
00275         <span class="keywordflow">if</span> (status != STATUS_OK)
00276           continue;
00277       }
00278     
00279     } while (0); <span class="comment">// End of main do-loop</span>
00280 
00281     <span class="comment">// Debug mode: Entry</span>
00282     if (par-&gt;logDebug())
00283       Log(Log_0, " &lt;== EXIT: Catalogue::get_input_descriptor (status=%d)", 
00284           status);
00285     
00286     <span class="comment">// Return status</span>
00287     return status;
00288 
00289 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d6" doxytag="sourceIdentify::Catalogue::get_probability"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_probability           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>iSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00678">678</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l01725">cc_sort()</a>, <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8cxx-source.html#l00789">get_probability_angsep()</a>, <a class="el" href="_catalogue_8h-source.html#l00086">sourceIdentify::CCElement::id</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00149">m_cc</a>, <a class="el" href="_catalogue_8h-source.html#l00148">m_numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00028">OUTCAT_MAX_STRING_LEN</a>, <a class="el" href="_catalogue_8h-source.html#l00092">sourceIdentify::CCElement::prob</a>, <a class="el" href="_catalogue_8h-source.html#l00096">sourceIdentify::CCElement::prob_angsep</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00355">get_counterpart_candidates()</a>.<div class="fragment"><pre class="fragment">00678                                                                            {
00679 
00680     <span class="comment">// Declare local variables</span>
00681     <span class="keywordtype">long</span> iCC;
00682     <span class="keywordtype">long</span> numUseCC;
00683     <span class="keywordtype">char</span> cid[<a class="code" href="_catalogue_8h.html#a0">OUTCAT_MAX_STRING_LEN</a>];
00684 
00685     <span class="comment">// Debug mode: Entry</span>
00686     <span class="keywordflow">if</span> (par-&gt;logDebug())
00687       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::get_probability (%d candidates)"</span>, 
00688           m_numCC);
00689 
00690     <span class="comment">// Single loop for common exit point</span>
00691     <span class="keywordflow">do</span> {
00692     
00693       <span class="comment">// Fall through in case of an error</span>
00694       <span class="keywordflow">if</span> (status != STATUS_OK)
00695         continue;
00696         
00697       <span class="comment">// Fall through if there are no counterpart candidates</span>
00698       if (m_numCC &lt; 1)
00699         continue;
00700 
00701       <span class="comment">// Determine counterpart probabilities based on angular separation</span>
00702       status = get_probability_angsep(par, iSrc, status);
00703       if (status != STATUS_OK) {
00704         <span class="keywordflow">if</span> (par-&gt;logTerse())
00705           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to determine counterpart probabilities"</span>
00706               <span class="stringliteral">" based on angular separation."</span>, (Status)status);
00707         <span class="keywordflow">continue</span>;
00708       }
00709     
00710       <span class="comment">// Assign the counterpart probabilities</span>
00711       <span class="comment">// DUMMY: we only use the probability based on angular separation</span>
00712       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; m_numCC; iCC++)
00713         m_cc[iCC].prob = m_cc[iCC].prob_angsep;              
00714 
00715       <span class="comment">// Sort counterpart candidates by decreasing probability</span>
00716       status = cc_sort(par, status);
00717       if (status != STATUS_OK) {
00718         <span class="keywordflow">if</span> (par-&gt;logTerse())
00719           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to sort counterpart candidates."</span>, 
00720               (Status)status);
00721         <span class="keywordflow">continue</span>;
00722       }
00723 
00724       <span class="comment">// Determine the number of counterpart candidates above the probability </span>
00725       <span class="comment">// threshold</span>
00726       numUseCC = 0;
00727       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; m_numCC; iCC++) {
00728         <span class="keywordflow">if</span> (m_cc[iCC].prob &gt;= par-&gt;m_probThres)
00729           numUseCC++;
00730         else
00731           break;
00732       }
00733 
00734       <span class="comment">// Apply the maximum number of counterpart threshold</span>
00735       if (numUseCC &gt; par-&gt;m_maxNumCtp)
00736         numUseCC = par-&gt;m_maxNumCtp;
00737 
00738       <span class="comment">// Eliminate counterpart candidates below threshold. Fall through if no </span>
00739       <span class="comment">// counterparts are left</span>
00740       m_numCC = numUseCC;
00741       if (m_numCC &lt; 1) {
00742         <span class="keywordflow">if</span> (par-&gt;logExplicit())
00743           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"  Refine step candidates ..........: no"</span>);
00744         <span class="keywordflow">continue</span>;
00745       }
00746 
00747       <span class="comment">// Set unique counterpart candidate identifier</span>
00748       <span class="comment">// DUMMY: Build string from indices</span>
00749       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; m_numCC; iCC++) {
00750         sprintf(cid, <span class="stringliteral">"CC_%5.5ld_%5.5ld"</span>, iSrc+1, iCC+1);
00751         <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].id = cid;
00752       }
00753 
00754       <span class="comment">// Optionally dump counterpart refine statistics</span>
00755       <span class="keywordflow">if</span> (par-&gt;logExplicit()) {
00756         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"  Refine step candidates ..........: %d"</span>, m_numCC);
00757       }
00758     
00759     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00760 
00761     <span class="comment">// Debug mode: Entry</span>
00762     <span class="keywordflow">if</span> (par-&gt;logDebug())
00763       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" &lt;== EXIT: Catalogue::get_probability (status=%d)"</span>, 
00764           status);
00765     
00766     <span class="comment">// Return status</span>
00767     <span class="keywordflow">return</span> status;
00768 
00769 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d7" doxytag="sourceIdentify::Catalogue::get_probability_angsep"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_probability_angsep           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>iSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00789">789</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00095">sourceIdentify::CCElement::angsep</a>, <a class="el" href="_catalogue_8h-source.html#l00081">sourceIdentify::deg2rad</a>, <a class="el" href="_catalogue_8h-source.html#l00094">sourceIdentify::CCElement::index</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="_catalogue_8h-source.html#l00149">m_cc</a>, <a class="el" href="_catalogue_8h-source.html#l00143">m_cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00148">m_numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00142">m_src</a>, <a class="el" href="_catalogue_8h-source.html#l00088">sourceIdentify::CCElement::pos_eq_dec</a>, <a class="el" href="_catalogue_8h-source.html#l00087">sourceIdentify::CCElement::pos_eq_ra</a>, <a class="el" href="_catalogue_8h-source.html#l00091">sourceIdentify::CCElement::pos_err_ang</a>, <a class="el" href="_catalogue_8h-source.html#l00089">sourceIdentify::CCElement::pos_err_maj</a>, <a class="el" href="_catalogue_8h-source.html#l00090">sourceIdentify::CCElement::pos_err_min</a>, <a class="el" href="_catalogue_8h-source.html#l00096">sourceIdentify::CCElement::prob_angsep</a>, <a class="el" href="_catalogue_8h-source.html#l00082">sourceIdentify::rad2deg</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00678">get_probability()</a>.<div class="fragment"><pre class="fragment">00790                                                         {
00791 
00792     <span class="comment">// Declare local variables</span>
00793     <span class="keywordtype">long</span>   iCC;
00794     <span class="keywordtype">long</span>   iCpt;
00795     <span class="keywordtype">double</span> src_ra;
00796     <span class="keywordtype">double</span> src_dec;
00797     <span class="keywordtype">double</span> src_err_maj;
00798     <span class="keywordtype">double</span> src_err_min;
00799     <span class="keywordtype">double</span> src_err_ang;
00800     <span class="keywordtype">double</span> src_dec_sin;
00801     <span class="keywordtype">double</span> src_dec_cos;
00802     <span class="keywordtype">double</span> cpt_ra;
00803     <span class="keywordtype">double</span> cpt_dec;
00804     <span class="keywordtype">double</span> cpt_err_maj;
00805     <span class="keywordtype">double</span> cpt_err_min;
00806     <span class="keywordtype">double</span> cpt_err_ang;
00807     <span class="keywordtype">double</span> cpt_dec_sin;
00808     <span class="keywordtype">double</span> cpt_dec_cos;
00809     <span class="keywordtype">double</span> arg;
00810 
00811     <span class="comment">// Debug mode: Entry</span>
00812     <span class="keywordflow">if</span> (par-&gt;logDebug())
00813       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::get_probability_angsep"</span>
00814           <span class="stringliteral">" (%d candidates)"</span>, m_numCC);
00815 
00816     <span class="comment">// Single loop for common exit point</span>
00817     <span class="keywordflow">do</span> {
00818     
00819       <span class="comment">// Fall through in case of an error</span>
00820       <span class="keywordflow">if</span> (status != STATUS_OK)
00821         continue;
00822         
00823       <span class="comment">// Fall through if there are no counterpart candidates</span>
00824       if (m_numCC &lt; 1)
00825         continue;
00826 
00827       <span class="comment">// Get position for source. Fall through if information is not available</span>
00828       if ((m_src.ra_deg(iSrc,  &amp;src_ra)  != IS_OK) ||
00829           (m_src.dec_deg(iSrc, &amp;src_dec) != IS_OK))
00830         continue;
00831 
00832       <span class="comment">// Get error ellipse for source. Fall through if information is not </span>
00833       <span class="comment">// available</span>
00834       src_err_maj = 0.0;
00835       src_err_min = 0.0;
00836       src_err_ang = 0.0;
00837       if ((m_src.posError_deg(iSrc, &amp;src_err_maj) != IS_OK) ||
00838           (m_src.posError_deg(iSrc, &amp;src_err_min) != IS_OK)) {
00839         <span class="keywordflow">if</span> (par-&gt;m_srcPosError &gt; 0.0) {
00840           src_err_maj = par-&gt;m_srcPosError;
00841           src_err_min = par-&gt;m_srcPosError;
00842         }
00843         <span class="keywordflow">else</span>
00844           <span class="keywordflow">continue</span>;
00845       }
00846 
00847       <span class="comment">// Calculate sin and cos of source declination</span>
00848       src_dec_sin = sin(src_dec * deg2rad);
00849       src_dec_cos = cos(src_dec * deg2rad);
00850     
00851       <span class="comment">// Loop over counterpart candidates</span>
00852       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; m_numCC; iCC++) {
00853 
00854         <span class="comment">// Get index of candidate in counterpart catalogue</span>
00855         iCpt = <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].index;
00856 
00857         <span class="comment">// Get position for counterpart candidate. Fall through if position is </span>
00858         <span class="comment">// not available</span>
00859         <span class="keywordflow">if</span> ((<a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.ra_deg(iCpt, &amp;cpt_ra)   != IS_OK) ||
00860             (<a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.dec_deg(iCpt, &amp;cpt_dec) != IS_OK))
00861           <span class="keywordflow">continue</span>;
00862 
00863         <span class="comment">// Get error ellipse for counterpart candidate. Assume no error if error</span>
00864         <span class="comment">// ellipse is not available</span>
00865         cpt_err_ang = 0.0;
00866         <span class="keywordflow">if</span> ((<a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.posError_deg(iCpt, &amp;cpt_err_maj) != IS_OK) ||
00867             (<a class="code" href="classsource_identify_1_1_catalogue.html#r6">m_cpt</a>.posError_deg(iCpt, &amp;cpt_err_min) != IS_OK)) {
00868           cpt_err_maj = par-&gt;m_cptPosError;
00869           cpt_err_min = par-&gt;m_cptPosError;       
00870           cpt_err_ang = 0.0;
00871         }
00872 
00873         <span class="comment">// Calculate angular separation between source and counterpart in</span>
00874         <span class="comment">// degrees. Make sure that the separation is always comprised between </span>
00875         <span class="comment">// [0,180] (out of range arguments lead to a floating exception)</span>
00876         cpt_dec_sin = sin(cpt_dec * deg2rad);
00877         cpt_dec_cos = cos(cpt_dec * deg2rad);
00878         arg         = src_dec_sin * cpt_dec_sin +
00879                       src_dec_cos * cpt_dec_cos * cos((src_ra - cpt_ra)*deg2rad);
00880         <span class="keywordflow">if</span> (arg &lt;= -1.0)
00881           m_cc[iCC].angsep = 180.0;
00882         else if (arg &gt;= 1.0)
00883           m_cc[iCC].angsep = 0.0;
00884         else
00885           m_cc[iCC].angsep = acos(arg) * rad2deg;
00886 
00887         <span class="comment">// Calculate counterpart probability from angular separation</span>
00888         <span class="comment">// DUMMY: we use an exponential law for the probability</span>
00889         m_cc[iCC].prob_angsep = 
00890           exp(-m_cc[iCC].angsep / sqrt(cpt_err_maj*cpt_err_maj + 
00891                                        src_err_maj*src_err_maj));
00892 
00893         <span class="comment">// Assign position and error ellipse</span>
00894         <span class="comment">// DUMMY: we assign the position and error ellipse of the partner</span>
00895         <span class="comment">//        that has the smaller positional uncertainty</span>
00896         if (cpt_err_maj &lt; src_err_maj) {
00897           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_eq_ra   = cpt_ra;
00898           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_eq_dec  = cpt_dec;
00899           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_err_maj = cpt_err_maj;
00900           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_err_min = cpt_err_min;
00901           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_err_ang = cpt_err_ang;
00902         }
00903         <span class="keywordflow">else</span> {
00904           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_eq_ra   = src_ra;
00905           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_eq_dec  = src_dec;
00906           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_err_maj = src_err_maj;
00907           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_err_min = src_err_min;
00908           <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>[iCC].pos_err_ang = src_err_ang;
00909         }
00910               
00911       } <span class="comment">// endfor: looped over counterpart candidates</span>
00912 
00913     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00914 
00915     <span class="comment">// Debug mode: Entry</span>
00916     <span class="keywordflow">if</span> (par-&gt;logDebug())
00917       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" &lt;== EXIT: Catalogue::get_probability_angsep (status=%d)"</span>, 
00918           status);
00919     
00920     <span class="comment">// Return status</span>
00921     <span class="keywordflow">return</span> status;
00922 
00923 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d0" doxytag="sourceIdentify::Catalogue::init_memory"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void sourceIdentify::Catalogue::init_memory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00171">171</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00149">m_cc</a>, <a class="el" href="_catalogue_8h-source.html#l00144">m_cpt_loc</a>, <a class="el" href="_catalogue_8h-source.html#l00140">m_fCptLoaded</a>, <a class="el" href="_catalogue_8h-source.html#l00141">m_filter_maxsep</a>, <a class="el" href="_catalogue_8h-source.html#l00139">m_maxCptLoad</a>, <a class="el" href="_catalogue_8h-source.html#l00160">m_num_cpt_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00152">m_num_src_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00148">m_numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00138">m_numCpt</a>, <a class="el" href="_catalogue_8h-source.html#l00137">m_numSrc</a>, and <a class="el" href="_catalogue_8h-source.html#l00145">m_outFile</a>.
<p>
Referenced by <a class="el" href="_catalogue_8h-source.html#l00167">Catalogue()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00204">free_memory()</a>.<div class="fragment"><pre class="fragment">00171                                 {
00172 
00173     <span class="comment">// Declare local variables</span>
00174 
00175     <span class="comment">// Single loop for common exit point</span>
00176     <span class="keywordflow">do</span> {
00177 
00178       <span class="comment">// Intialise private members</span>
00179       <a class="code" href="classsource_identify_1_1_catalogue.html#r0">m_numSrc</a>        = 0;
00180       <a class="code" href="classsource_identify_1_1_catalogue.html#r1">m_numCpt</a>        = 0;
00181       <a class="code" href="classsource_identify_1_1_catalogue.html#r2">m_maxCptLoad</a>    = 100000; <span class="comment">// load maximum of 100000 sources</span>
00182       <a class="code" href="classsource_identify_1_1_catalogue.html#r3">m_fCptLoaded</a>    = 0;
00183       <a class="code" href="classsource_identify_1_1_catalogue.html#r4">m_filter_maxsep</a> = 4.0; <span class="comment">// filter all sources more distant than 2 deg</span>
00184       <a class="code" href="classsource_identify_1_1_catalogue.html#r7">m_cpt_loc</a>       = NULL;
00185       <a class="code" href="classsource_identify_1_1_catalogue.html#r8">m_outFile</a>       = NULL;
00186       <a class="code" href="classsource_identify_1_1_catalogue.html#r9">m_numCC</a>         = 0;
00187       <a class="code" href="classsource_identify_1_1_catalogue.html#r10">m_cc</a>            = NULL;
00188       <a class="code" href="classsource_identify_1_1_catalogue.html#r11">m_num_src_Qty</a>   = 0;
00189       <a class="code" href="classsource_identify_1_1_catalogue.html#r17">m_num_cpt_Qty</a>   = 0;
00190 
00191     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00192     
00193     <span class="comment">// Return</span>
00194     <span class="keywordflow">return</span>;
00195 
00196 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="sourceIdentify::Catalogue::save"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::save           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l02099">2099</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00145">m_outFile</a>, and <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="source_identify_8cxx-source.html#l00051">application::run()</a>.<div class="fragment"><pre class="fragment">02099                                                      {
02100 
02101     <span class="comment">// Declare local variables</span>
02102     <span class="keywordtype">int</span> fstatus;
02103 
02104     <span class="comment">// Debug mode: Entry</span>
02105     <span class="keywordflow">if</span> (par-&gt;logDebug())
02106       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::save"</span>);
02107         
02108     <span class="comment">// Initialise FITSIO status</span>
02109     fstatus = (int)status;
02110         
02111     <span class="comment">// Single loop for common exit point</span>
02112     <span class="keywordflow">do</span> {
02113 
02114       <span class="comment">// Fall through in case of an error</span>
02115       <span class="keywordflow">if</span> (status != STATUS_OK)
02116         continue;
02117 
02118       <span class="comment">// Dump header</span>
02119       if (par-&gt;logNormal()) {
02120         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">""</span>);
02121         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"Save counterpart candidate catalogue:"</span>);
02122         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"====================================="</span>);
02123       }
02124 
02125       <span class="comment">// Close FITS file</span>
02126       fstatus = fits_close_file(m_outFile, &amp;fstatus);
02127       <span class="keywordflow">if</span> (fstatus != 0) {
02128         <span class="keywordflow">if</span> (par-&gt;logTerse())
02129           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to close output catalogue."</span>, fstatus);
02130         <span class="keywordflow">continue</span>;
02131       }
02132     
02133     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
02134     
02135     <span class="comment">// Set FITSIO status</span>
02136     <span class="keywordflow">if</span> (status == STATUS_OK)
02137       status = (Status)fstatus;
02138 
02139     <span class="comment">// Debug mode: Entry</span>
02140     if (par-&gt;logDebug())
02141       Log(Log_0, " &lt;== EXIT: Catalogue::save (status=%d)", status);
02142     
02143     <span class="comment">// Return status</span>
02144     return status;
02145 
02146 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d11" doxytag="sourceIdentify::Catalogue::select_output_catalogue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::select_output_catalogue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01620">1620</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a10">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00121">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_0</a>, <a class="el" href="namespacesource_identify.html#a37a22">sourceIdentify::Log_2</a>, <a class="el" href="_catalogue_8h-source.html#l00145">m_outFile</a>, <a class="el" href="namespacesource_identify.html#a38a24">sourceIdentify::STATUS_OK</a>, and <a class="el" href="namespacesource_identify.html#a37a14">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>.<div class="fragment"><pre class="fragment">01620                                                                         {
01621 
01622     <span class="comment">// Declare local variables</span>
01623     <span class="keywordtype">int</span>                    fstatus;
01624     <span class="keywordtype">long</span>                   numBefore;
01625     <span class="keywordtype">long</span>                   numAfter;
01626     std::string::size_type iSel;
01627     std::string::size_type numSel;
01628 
01629     <span class="comment">// Debug mode: Entry</span>
01630     <span class="keywordflow">if</span> (par-&gt;logDebug())
01631       <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_0, <span class="stringliteral">" ==&gt; ENTRY: Catalogue::select_output_catalogue"</span>);
01632 
01633     <span class="comment">// Initialise FITSIO status</span>
01634     fstatus = (int)status;
01635 
01636     <span class="comment">// Single loop for common exit point</span>
01637     <span class="keywordflow">do</span> {
01638     
01639       <span class="comment">// Fall through in case of an error</span>
01640       <span class="keywordflow">if</span> (status != STATUS_OK)
01641         continue;
01642 
01643       <span class="comment">// Determine number of output catalogue selection strings. Fall through</span>
01644       <span class="comment">// if there are no such strings</span>
01645       numSel = par-&gt;m_select.size();
01646       if (numSel &lt; 1)
01647         continue;
01648 
01649       <span class="comment">// Dump header</span>
01650       if (par-&gt;logNormal()) {
01651         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">""</span>);
01652         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"Select output catalogue counterparts:"</span>);
01653         <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"====================================="</span>);
01654       }
01655 
01656       <span class="comment">// Select output catalogue entries</span>
01657       <span class="keywordflow">for</span> (iSel = 0; iSel &lt; numSel; iSel++) {
01658 
01659         <span class="comment">// Determine number of rows in table before selection</span>
01660         fstatus = fits_get_num_rows(m_outFile, &amp;numBefore, &amp;fstatus);
01661         <span class="keywordflow">if</span> (fstatus != 0) {
01662           <span class="keywordflow">if</span> (par-&gt;logTerse())
01663             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to determine number of rows in output"</span>
01664                 <span class="stringliteral">" catalogue."</span>, fstatus);
01665           <span class="keywordflow">break</span>;
01666         }
01667 
01668         <span class="comment">// Perform selection</span>
01669         fstatus = fits_select_rows(m_outFile, m_outFile,
01670                                    par-&gt;m_select[iSel].c_str(),
01671                                    &amp;fstatus);
01672         <span class="keywordflow">if</span> (fstatus != 0) {
01673           <span class="keywordflow">if</span> (par-&gt;logTerse())
01674             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Warning_2, <span class="stringliteral">" Unable to perform selection &lt;%s&gt; on the output"</span>
01675                 <span class="stringliteral">" catalogue (status=%d)."</span>,
01676                 par-&gt;m_select[iSel].c_str(), 
01677                 fstatus);
01678           fstatus = 0;
01679           <span class="keywordflow">continue</span>;
01680         }
01681 
01682         <span class="comment">// Determine number of rows in table after selection</span>
01683         fstatus = fits_get_num_rows(m_outFile, &amp;numAfter, &amp;fstatus);
01684         <span class="keywordflow">if</span> (fstatus != 0) {
01685           <span class="keywordflow">if</span> (par-&gt;logTerse())
01686             <a class="code" href="namespacesource_identify.html#a36">Log</a>(Error_2, <span class="stringliteral">"%d : Unable to determine number of rows in output"</span>
01687                 <span class="stringliteral">" catalogue."</span>, fstatus);
01688           <span class="keywordflow">break</span>;
01689         }
01690 
01691         <span class="comment">// Dump selection information</span>
01692         <span class="keywordflow">if</span> (par-&gt;logNormal()) {
01693           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">" Selection ........................: %s"</span>, 
01694               par-&gt;m_select[iSel].c_str());
01695           <a class="code" href="namespacesource_identify.html#a36">Log</a>(Log_2, <span class="stringliteral">"   Number of deleted counterparts .: %d (%d =&gt; %d)"</span>, 
01696               numBefore-numAfter, numBefore, numAfter);
01697         }
01698 
01699       }
01700       <span class="keywordflow">if</span> (fstatus != 0)
01701         continue;
01702 
01703     } while (0); <span class="comment">// End of main do-loop</span>
01704 
01705     <span class="comment">// Set FITSIO status</span>
01706     if (status == STATUS_OK)
01707       status = (Status)fstatus;
01708 
01709     <span class="comment">// Debug mode: Entry</span>
01710     if (par-&gt;logDebug())
01711       Log(Log_0, " &lt;== EXIT: Catalogue::select_output_catalogue (status=%d)", 
01712           status);
01713     
01714     <span class="comment">// Return status</span>
01715     return status;
01716 
01717 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="r10" doxytag="sourceIdentify::Catalogue::m_cc"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structsource_identify_1_1_c_c_element.html">CCElement</a>* <a class="el" href="classsource_identify_1_1_catalogue.html#r10">sourceIdentify::Catalogue::m_cc</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00149">149</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01725">cc_sort()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01874">dump_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00204">free_memory()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00678">get_probability()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00789">get_probability_angsep()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r6" doxytag="sourceIdentify::Catalogue::m_cpt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">catalogAccess::Catalog <a class="el" href="classsource_identify_1_1_catalogue.html#r6">sourceIdentify::Catalogue::m_cpt</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00143">143</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01874">dump_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00789">get_probability_angsep()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r7" doxytag="sourceIdentify::Catalogue::m_cpt_loc"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structsource_identify_1_1_object_info.html">ObjectInfo</a>* <a class="el" href="classsource_identify_1_1_catalogue.html#r7">sourceIdentify::Catalogue::m_cpt_loc</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00144">144</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r18" doxytag="sourceIdentify::Catalogue::m_cpt_Qty_colnum"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;int&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r18">sourceIdentify::Catalogue::m_cpt_Qty_colnum</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00161">161</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r22" doxytag="sourceIdentify::Catalogue::m_cpt_Qty_tbucd"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;std::string&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r22">sourceIdentify::Catalogue::m_cpt_Qty_tbucd</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00165">165</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r20" doxytag="sourceIdentify::Catalogue::m_cpt_Qty_tform"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;std::string&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r20">sourceIdentify::Catalogue::m_cpt_Qty_tform</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00163">163</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r19" doxytag="sourceIdentify::Catalogue::m_cpt_Qty_ttype"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;std::string&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r19">sourceIdentify::Catalogue::m_cpt_Qty_ttype</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00162">162</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r21" doxytag="sourceIdentify::Catalogue::m_cpt_Qty_tunit"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;std::string&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r21">sourceIdentify::Catalogue::m_cpt_Qty_tunit</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00164">164</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r3" doxytag="sourceIdentify::Catalogue::m_fCptLoaded"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="classsource_identify_1_1_catalogue.html#r3">sourceIdentify::Catalogue::m_fCptLoaded</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00140">140</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r4" doxytag="sourceIdentify::Catalogue::m_filter_maxsep"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="classsource_identify_1_1_catalogue.html#r4">sourceIdentify::Catalogue::m_filter_maxsep</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00141">141</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r2" doxytag="sourceIdentify::Catalogue::m_maxCptLoad"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="classsource_identify_1_1_catalogue.html#r2">sourceIdentify::Catalogue::m_maxCptLoad</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00139">139</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r17" doxytag="sourceIdentify::Catalogue::m_num_cpt_Qty"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="classsource_identify_1_1_catalogue.html#r17">sourceIdentify::Catalogue::m_num_cpt_Qty</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00160">160</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r11" doxytag="sourceIdentify::Catalogue::m_num_src_Qty"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="classsource_identify_1_1_catalogue.html#r11">sourceIdentify::Catalogue::m_num_src_Qty</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00152">152</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r9" doxytag="sourceIdentify::Catalogue::m_numCC"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="classsource_identify_1_1_catalogue.html#r9">sourceIdentify::Catalogue::m_numCC</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00148">148</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01725">cc_sort()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01874">dump_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00678">get_probability()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00789">get_probability_angsep()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r1" doxytag="sourceIdentify::Catalogue::m_numCpt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="classsource_identify_1_1_catalogue.html#r1">sourceIdentify::Catalogue::m_numCpt</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00138">138</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00435">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r0" doxytag="sourceIdentify::Catalogue::m_numSrc"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="classsource_identify_1_1_catalogue.html#r0">sourceIdentify::Catalogue::m_numSrc</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00137">137</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r8" doxytag="sourceIdentify::Catalogue::m_outFile"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">fitsfile* <a class="el" href="classsource_identify_1_1_catalogue.html#r8">sourceIdentify::Catalogue::m_outFile</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00145">145</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01505">eval_output_catalogue_quantities()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00171">init_memory()</a>, <a class="el" href="_catalogue_8cxx-source.html#l02099">save()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l01620">select_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r5" doxytag="sourceIdentify::Catalogue::m_src"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">catalogAccess::Catalog <a class="el" href="classsource_identify_1_1_catalogue.html#r5">sourceIdentify::Catalogue::m_src</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00142">142</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01977">build()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00355">get_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00297">get_input_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00230">get_input_descriptor()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00789">get_probability_angsep()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r12" doxytag="sourceIdentify::Catalogue::m_src_Qty_colnum"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;int&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r12">sourceIdentify::Catalogue::m_src_Qty_colnum</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00153">153</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r16" doxytag="sourceIdentify::Catalogue::m_src_Qty_tbucd"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;std::string&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r16">sourceIdentify::Catalogue::m_src_Qty_tbucd</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00157">157</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r14" doxytag="sourceIdentify::Catalogue::m_src_Qty_tform"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;std::string&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r14">sourceIdentify::Catalogue::m_src_Qty_tform</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00155">155</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r13" doxytag="sourceIdentify::Catalogue::m_src_Qty_ttype"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;std::string&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r13">sourceIdentify::Catalogue::m_src_Qty_ttype</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00154">154</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01209">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r15" doxytag="sourceIdentify::Catalogue::m_src_Qty_tunit"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;std::string&gt; <a class="el" href="classsource_identify_1_1_catalogue.html#r15">sourceIdentify::Catalogue::m_src_Qty_tunit</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00156">156</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00931">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_catalogue_8h-source.html">Catalogue.h</a><li><a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Feb 1 17:08:57 2006 for sourceIdentify by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
