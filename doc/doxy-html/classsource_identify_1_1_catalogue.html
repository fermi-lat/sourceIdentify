<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>sourceIdentify::Catalogue class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>sourceIdentify::Catalogue Class Reference</h1><code>#include &lt;<a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>&gt;</code>
<p>
Collaboration diagram for sourceIdentify::Catalogue:<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classsource_identify_1_1_catalogue-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Methods</h2></td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#a0">Catalogue</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#a1">~Catalogue</a> (void)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#a2">build</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#a3">save</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td colspan=2><br><h2>Private Methods</h2></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c0">init_memory</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c1">free_memory</a> (void)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c2">get_input_descriptor</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, std::string catName, catalogAccess::Catalog *cat, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c3">get_input_catalogue</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, std::string catName, catalogAccess::Catalog *cat, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c4">get_counterpart_candidates</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, long iSrc, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c5">get_counterparts</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, double *ra, double *dec, double *pos_err, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c6">get_probability</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, long iSrc, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c7">get_probability_angsep</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, long iSrc, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c8">create_output_catalogue</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c9">add_counterpart_candidates</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, long iSrc, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c10">eval_output_catalogue_quantities</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c11">select_output_catalogue</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c12">cc_sort</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c13">dump_descriptor</a> (catalogAccess::Catalog *cat, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#c14">dump_counterpart_candidates</a> (<a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *par, <a class="el" href="namespacesource_identify.html#a38">Status</a> status)</td></tr>
<tr><td colspan=2><br><h2>Private Attributes</h2></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o0">numSrc</a></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o1">numCpt</a></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o2">maxCptLoad</a></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o3">fCptLoaded</a></td></tr>
<tr><td nowrap align=right valign=top>catalogAccess::Catalog&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o4">src</a></td></tr>
<tr><td nowrap align=right valign=top>catalogAccess::Catalog&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o5">cpt</a></td></tr>
<tr><td nowrap align=right valign=top>fitsfile *&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o6">outFile</a></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o7">numCC</a></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsource_identify_1_1_c_c_element.html">CCElement</a> *&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o8">cc</a></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o9">num_src_Qty</a></td></tr>
<tr><td nowrap align=right valign=top>std::vector&lt; int &gt;&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o10">src_Qty_colnum</a></td></tr>
<tr><td nowrap align=right valign=top>std::vector&lt; std::string &gt;&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o11">src_Qty_ttype</a></td></tr>
<tr><td nowrap align=right valign=top>std::vector&lt; std::string &gt;&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o12">src_Qty_tform</a></td></tr>
<tr><td nowrap align=right valign=top>std::vector&lt; std::string &gt;&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o13">src_Qty_tunit</a></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o14">num_cpt_Qty</a></td></tr>
<tr><td nowrap align=right valign=top>std::vector&lt; int &gt;&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o15">cpt_Qty_colnum</a></td></tr>
<tr><td nowrap align=right valign=top>std::vector&lt; std::string &gt;&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o16">cpt_Qty_ttype</a></td></tr>
<tr><td nowrap align=right valign=top>std::vector&lt; std::string &gt;&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o17">cpt_Qty_tform</a></td></tr>
<tr><td nowrap align=right valign=top>std::vector&lt; std::string &gt;&nbsp;</td><td valign=bottom><a class="el" href="classsource_identify_1_1_catalogue.html#o18">cpt_Qty_tunit</a></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a name="a0" doxytag="sourceIdentify::Catalogue::Catalogue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> sourceIdentify::Catalogue::Catalogue </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00148">148</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l00165">init_memory()</a>.
<p>
<div class="fragment"><pre>00148 { <a class="code" href="classsource_identify_1_1_catalogue.html#c0">init_memory</a>(); }
</pre></div>    </td>
  </tr>
</table>
<a name="a1" doxytag="sourceIdentify::Catalogue::~Catalogue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> sourceIdentify::Catalogue::~Catalogue </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00149">149</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l00193">free_memory()</a>.
<p>
<div class="fragment"><pre>00149 { <a class="code" href="classsource_identify_1_1_catalogue.html#c1">free_memory</a>(); }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a name="c9" doxytag="sourceIdentify::Catalogue::add_counterpart_candidates"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::add_counterpart_candidates </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iSrc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00990">990</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00132">cc</a>, <a class="el" href="_catalogue_8h-source.html#l00127">cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00143">cpt_Qty_colnum</a>, <a class="el" href="_catalogue_8h-source.html#l00145">cpt_Qty_tform</a>, <a class="el" href="_catalogue_8h-source.html#l00144">cpt_Qty_ttype</a>, <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8h-source.html#l00084">sourceIdentify::CCElement::index</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_catalogue_8h-source.html#l00142">num_cpt_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00135">num_src_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00131">numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00041">OUTCAT_COL_DEC_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00032">OUTCAT_COL_ID_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00046">OUTCAT_COL_MAJERR_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00051">OUTCAT_COL_MINERR_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00056">OUTCAT_COL_POSANGLE_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00061">OUTCAT_COL_PROB_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00036">OUTCAT_COL_RA_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00026">OUTCAT_MAX_STRING_LEN</a>, <a class="el" href="_catalogue_8h-source.html#l00128">outFile</a>, <a class="el" href="_catalogue_8h-source.html#l00078">sourceIdentify::CCElement::pos_eq_dec</a>, <a class="el" href="_catalogue_8h-source.html#l00077">sourceIdentify::CCElement::pos_eq_ra</a>, <a class="el" href="_catalogue_8h-source.html#l00081">sourceIdentify::CCElement::pos_err_ang</a>, <a class="el" href="_catalogue_8h-source.html#l00079">sourceIdentify::CCElement::pos_err_maj</a>, <a class="el" href="_catalogue_8h-source.html#l00080">sourceIdentify::CCElement::pos_err_min</a>, <a class="el" href="_catalogue_8h-source.html#l00082">sourceIdentify::CCElement::prob</a>, <a class="el" href="_catalogue_8h-source.html#l00126">src</a>, <a class="el" href="_catalogue_8h-source.html#l00136">src_Qty_colnum</a>, <a class="el" href="_catalogue_8h-source.html#l00138">src_Qty_tform</a>, <a class="el" href="_catalogue_8h-source.html#l00137">src_Qty_ttype</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, <a class="el" href="namespacesource_identify.html#a38a23">sourceIdentify::STATUS_MEM_ALLOC</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00326">get_counterpart_candidates()</a>.
<p>
<div class="fragment"><pre>00991                                                             {
00992 
00993     <span class="comment">// Declare local variables</span>
00994     <span class="keywordtype">int</span>           fstatus;
00995     <span class="keywordtype">int</span>           colnum;
00996     <span class="keywordtype">long</span>          nactrows;
00997     <span class="keywordtype">long</span>          firstrow;
00998     <span class="keywordtype">long</span>          row;
00999     <span class="keywordtype">long</span>          frow;
01000     <span class="keywordtype">long</span>          nrows;
01001     <span class="keywordtype">long</span>          iQty;
01002     <span class="keywordtype">long</span>          iCpt;
01003     <span class="keywordtype">double</span>        NValue;
01004     std::string   SValue;
01005     std::string   form;
01006     std::string   name;
01007     <span class="keywordtype">double</span>       *dptr;
01008     <span class="keywordtype">char</span>        **cptr;
01009 
01010     <span class="comment">// Initialise temporary memory pointers</span>
01011     dptr = NULL;
01012     cptr = NULL;    
01013 
01014     <span class="comment">// Initialise FITSIO status</span>
01015     fstatus = (int)status;
01016 
01017     <span class="comment">// Single loop for common exit point</span>
01018     <span class="keywordflow">do</span> {
01019     
01020       <span class="comment">// Fall through in case of an error</span>
01021       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01022         <span class="keywordflow">continue</span>;
01023         
01024       <span class="comment">// Fall through if there are no counterpart candidates</span>
01025       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a> &lt; 1)
01026         <span class="keywordflow">continue</span>;
01027 
01028       <span class="comment">// Determine number of rows in actual table</span>
01029       fstatus = fits_get_num_rows(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, &amp;nactrows, &amp;fstatus);
01030       <span class="keywordflow">if</span> (fstatus != 0) {
01031         <span class="keywordflow">if</span> (par-&gt;logError())
01032           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to determine number of rows in output"</span>
01033               <span class="stringliteral">" catalogue."</span>, fstatus);
01034         <span class="keywordflow">continue</span>;
01035       }
01036 
01037       <span class="comment">// Define the rows that should be inserted</span>
01038       firstrow = (long)nactrows;
01039       frow     = firstrow + 1;   
01040       nrows    = (long)<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>;
01041 
01042       <span class="comment">// Insert rows for the new counterpart candidates</span>
01043       fstatus = fits_insert_rows(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, firstrow, nrows, &amp;fstatus);
01044       <span class="keywordflow">if</span> (fstatus != 0) {
01045         <span class="keywordflow">if</span> (par-&gt;logError())
01046           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to add %d rows to output catalogue."</span>, 
01047               fstatus, nrows);
01048         <span class="keywordflow">continue</span>;
01049       }
01050 
01051       <span class="comment">// Allocate memory to hold quantities</span>
01052       dptr = <span class="keyword">new</span> <span class="keywordtype">double</span>[nrows];
01053       cptr = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[nrows];
01054       <span class="keywordflow">if</span> (dptr == NULL ||
01055           cptr == NULL) {
01056         status = <a class="code" href="namespacesource_identify.html#a38a23">STATUS_MEM_ALLOC</a>;
01057         <span class="keywordflow">if</span> (par-&gt;logError())
01058           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Memory allocation failure."</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
01059         <span class="keywordflow">continue</span>;
01060       }
01061       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++) {
01062         cptr[row] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a0">OUTCAT_MAX_STRING_LEN</a>];
01063         <span class="keywordflow">if</span> (cptr[row] == NULL) {
01064           status = <a class="code" href="namespacesource_identify.html#a38a23">STATUS_MEM_ALLOC</a>;
01065           <span class="keywordflow">if</span> (par-&gt;logError())
01066             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Memory allocation failure."</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
01067           <span class="keywordflow">break</span>;
01068         }
01069       }
01070       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01071         <span class="keywordflow">continue</span>;
01072 
01073 
01074       <span class="comment">// Add unique counterpart identifier</span>
01075       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01076         strcpy(cptr[row], <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].id.c_str());
01077       fstatus = fits_write_col_str(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, <a class="code" href="_catalogue_8h.html#a4">OUTCAT_COL_ID_COLNUM</a>, 
01078                                    frow, 1, nrows, cptr, &amp;fstatus);
01079       <span class="keywordflow">if</span> (fstatus != 0) {
01080         <span class="keywordflow">if</span> (par-&gt;logError())
01081           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart identifier to output"</span>
01082               <span class="stringliteral">" catalogue."</span>, fstatus);
01083         <span class="keywordflow">continue</span>;
01084       }
01085 
01086       <span class="comment">// Add Counterpart Right Ascention</span>
01087       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01088         dptr[row] = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].pos_eq_ra;
01089       fstatus = fits_write_col(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, TDOUBLE, <a class="code" href="_catalogue_8h.html#a7">OUTCAT_COL_RA_COLNUM</a>,
01090                                frow, 1, nrows, dptr, &amp;fstatus);
01091       <span class="keywordflow">if</span> (fstatus != 0) {
01092         <span class="keywordflow">if</span> (par-&gt;logError())
01093           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart Right Ascension to"</span>
01094               <span class="stringliteral">" output catalogue."</span>, fstatus);
01095         <span class="keywordflow">continue</span>;
01096       }
01097 
01098       <span class="comment">// Add Counterpart Declination</span>
01099       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01100         dptr[row] = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].pos_eq_dec;
01101       fstatus = fits_write_col(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, TDOUBLE, <a class="code" href="_catalogue_8h.html#a11">OUTCAT_COL_DEC_COLNUM</a>,
01102                                frow, 1, nrows, dptr, &amp;fstatus);
01103       <span class="keywordflow">if</span> (fstatus != 0) {
01104         <span class="keywordflow">if</span> (par-&gt;logError())
01105           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart Declination to"</span>
01106               <span class="stringliteral">" output catalogue."</span>, fstatus);
01107         <span class="keywordflow">continue</span>;
01108       }
01109 
01110       <span class="comment">// Add Counterpart Error Ellipse Major Axis</span>
01111       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01112         dptr[row] = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].pos_err_maj;
01113       fstatus = fits_write_col(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, TDOUBLE, <a class="code" href="_catalogue_8h.html#a15">OUTCAT_COL_MAJERR_COLNUM</a>,
01114                                frow, 1, nrows, dptr, &amp;fstatus);
01115       <span class="keywordflow">if</span> (fstatus != 0) {
01116         <span class="keywordflow">if</span> (par-&gt;logError())
01117           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart error ellipse major"</span>
01118               <span class="stringliteral">" axis to output catalogue."</span>, fstatus);
01119         <span class="keywordflow">continue</span>;
01120       }
01121 
01122       <span class="comment">// Add Counterpart Error Ellipse Minor Axis</span>
01123       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01124         dptr[row] = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].pos_err_min;
01125       fstatus = fits_write_col(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, TDOUBLE, <a class="code" href="_catalogue_8h.html#a19">OUTCAT_COL_MINERR_COLNUM</a>,
01126                                frow, 1, nrows, dptr, &amp;fstatus);
01127       <span class="keywordflow">if</span> (fstatus != 0) {
01128         <span class="keywordflow">if</span> (par-&gt;logError())
01129           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart error ellipse minor"</span>
01130               <span class="stringliteral">" axis to output catalogue."</span>, fstatus);
01131         <span class="keywordflow">continue</span>;
01132       }
01133 
01134       <span class="comment">// Add Counterpart Error Ellipse Position Angle</span>
01135       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01136         dptr[row] = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].pos_err_ang;
01137       fstatus = fits_write_col(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, TDOUBLE, <a class="code" href="_catalogue_8h.html#a23">OUTCAT_COL_POSANGLE_COLNUM</a>,
01138                                frow, 1, nrows, dptr, &amp;fstatus);
01139       <span class="keywordflow">if</span> (fstatus != 0) {
01140         <span class="keywordflow">if</span> (par-&gt;logError())
01141           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart error ellipse position"</span>
01142               <span class="stringliteral">" angle to output catalogue."</span>, fstatus);
01143         <span class="keywordflow">continue</span>;
01144       }
01145 
01146       <span class="comment">// Add Counterpart Probability</span>
01147       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01148         dptr[row] = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].prob;
01149       fstatus = fits_write_col(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, TDOUBLE, <a class="code" href="_catalogue_8h.html#a27">OUTCAT_COL_PROB_COLNUM</a>,
01150                                frow, 1, nrows, dptr, &amp;fstatus);
01151       <span class="keywordflow">if</span> (fstatus != 0) {
01152         <span class="keywordflow">if</span> (par-&gt;logError())
01153           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart probability to output"</span>
01154               <span class="stringliteral">" catalogue."</span>, fstatus);
01155         <span class="keywordflow">continue</span>;
01156       }
01157 
01158       <span class="comment">// Add source catalogue columns</span>
01159       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o9">num_src_Qty</a>; iQty++) {
01160 
01161         <span class="comment">// Get column information</span>
01162         colnum = <a class="code" href="classsource_identify_1_1_catalogue.html#o10">src_Qty_colnum</a>[iQty];
01163         form   = <a class="code" href="classsource_identify_1_1_catalogue.html#o12">src_Qty_tform</a>[iQty];
01164         name   = <a class="code" href="classsource_identify_1_1_catalogue.html#o11">src_Qty_ttype</a>[iQty];
01165 
01166         <span class="comment">// Add numerical quantities</span>
01167         <span class="keywordflow">if</span> (form.find(<span class="stringliteral">"E"</span>, 0) != std::string::npos) {
01168           <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.getNValue(name, iSrc, &amp;NValue);
01169           <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01170             dptr[row] = NValue;
01171           fstatus = fits_write_col(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, TDOUBLE, colnum, frow, 1, nrows, 
01172                                    dptr, &amp;fstatus);
01173           <span class="keywordflow">if</span> (fstatus != 0) {
01174             <span class="keywordflow">if</span> (par-&gt;logError())
01175               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write source catalogue data &lt;%s&gt;"</span>
01176                   <span class="stringliteral">" (column %d) to output catalogue."</span>, 
01177                   fstatus, name.c_str(), colnum);
01178             <span class="keywordflow">break</span>;
01179           }
01180         } <span class="comment">// endif: added numerical quantities</span>
01181 
01182         <span class="comment">// Add string quantities</span>
01183         <span class="keywordflow">if</span> (form.find(<span class="stringliteral">"A"</span>, 0) != std::string::npos) {
01184           <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.getSValue(name, iSrc, &amp;SValue);
01185           <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++)
01186             strcpy(cptr[row], SValue.c_str());
01187           fstatus = fits_write_col_str(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, colnum, frow, 1, nrows, cptr, 
01188                                        &amp;fstatus);
01189           <span class="keywordflow">if</span> (fstatus != 0) {
01190             <span class="keywordflow">if</span> (par-&gt;logError())
01191               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write source catalogue data &lt;%s&gt;"</span>
01192                   <span class="stringliteral">" (column %d) to output catalogue."</span>, 
01193                   fstatus, name.c_str(), colnum);
01194             <span class="keywordflow">break</span>;
01195           }
01196         } <span class="comment">// endif: added numerical quantities</span>
01197 
01198       }
01199       <span class="keywordflow">if</span> (fstatus != 0)
01200         <span class="keywordflow">continue</span>;
01201 
01202       <span class="comment">// Add counterpart catalogue columns</span>
01203       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o14">num_cpt_Qty</a>; iQty++) {
01204 
01205         <span class="comment">// Get column information</span>
01206         colnum = <a class="code" href="classsource_identify_1_1_catalogue.html#o15">cpt_Qty_colnum</a>[iQty];
01207         form   = <a class="code" href="classsource_identify_1_1_catalogue.html#o17">cpt_Qty_tform</a>[iQty];
01208         name   = <a class="code" href="classsource_identify_1_1_catalogue.html#o16">cpt_Qty_ttype</a>[iQty];
01209 
01210         <span class="comment">// Add numerical quantities</span>
01211         <span class="keywordflow">if</span> (form.find(<span class="stringliteral">"E"</span>, 0) != std::string::npos) {
01212           <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++) {
01213             iCpt = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].index;
01214             <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.getNValue(name, iCpt, &amp;NValue);
01215             dptr[row] = NValue;
01216           }
01217           fstatus = fits_write_col(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, TDOUBLE, colnum, frow, 1, nrows, 
01218                                    dptr, &amp;fstatus);
01219           <span class="keywordflow">if</span> (fstatus != 0) {
01220             <span class="keywordflow">if</span> (par-&gt;logError())
01221               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart catalogue data &lt;%s&gt;"</span>
01222                   <span class="stringliteral">" (column %d) to output catalogue."</span>, 
01223                   fstatus, name.c_str(), colnum);
01224             <span class="keywordflow">break</span>;
01225           }
01226         } <span class="comment">// endif: added numerical quantities</span>
01227 
01228         <span class="comment">// Add string quantities</span>
01229         <span class="keywordflow">if</span> (form.find(<span class="stringliteral">"A"</span>, 0) != std::string::npos) {
01230           <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++) {
01231             iCpt = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[row].index;
01232             <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.getSValue(name, iCpt, &amp;SValue);
01233             strcpy(cptr[row], SValue.c_str());
01234           }
01235           fstatus = fits_write_col_str(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, colnum, frow, 1, nrows, cptr, 
01236                                        &amp;fstatus);
01237           <span class="keywordflow">if</span> (fstatus != 0) {
01238             <span class="keywordflow">if</span> (par-&gt;logError())
01239               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to write counterpart catalogue data"</span>
01240                   <span class="stringliteral">" &lt;%s&gt; (column %d) to output catalogue."</span>, 
01241                   fstatus, name.c_str(), colnum);
01242             <span class="keywordflow">break</span>;
01243           }
01244         } <span class="comment">// endif: added numerical quantities</span>
01245 
01246       }
01247       <span class="keywordflow">if</span> (fstatus != 0)
01248         <span class="keywordflow">continue</span>;
01249    
01250     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01251 
01252     <span class="comment">// Delete temporary memory</span>
01253     <span class="keywordflow">if</span> (dptr != NULL) <span class="keyword">delete</span> [] dptr;
01254     <span class="keywordflow">if</span> (cptr != NULL) {
01255       <span class="keywordflow">for</span> (row = 0; row &lt; nrows; row++) {
01256         <span class="keywordflow">if</span> (cptr[row] != NULL) <span class="keyword">delete</span> [] cptr[row];
01257       }
01258       <span class="keyword">delete</span> [] cptr;
01259     }
01260 
01261     <span class="comment">// Set FITSIO status</span>
01262     <span class="keywordflow">if</span> (status == <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01263       status = (Status)fstatus;
01264     
01265     <span class="comment">// Return status</span>
01266     <span class="keywordflow">return</span> status;
01267 
01268 }
</pre></div>    </td>
  </tr>
</table>
<a name="a2" doxytag="sourceIdentify::Catalogue::build"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::build </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01713">1713</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00127">cpt</a>, <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>, <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8cxx-source.html#l01276">eval_output_catalogue_quantities()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00326">get_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00277">get_input_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00219">get_input_descriptor()</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00076">sourceIdentify::Parameters::logAction()</a>, <a class="el" href="_parameters_8h-source.html#l00078">sourceIdentify::Parameters::logDebug()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_parameters_8h-source.html#l00060">sourceIdentify::Parameters::m_cptCatName</a>, <a class="el" href="_parameters_8h-source.html#l00059">sourceIdentify::Parameters::m_srcCatName</a>, <a class="el" href="_catalogue_8h-source.html#l00122">numSrc</a>, <a class="el" href="_catalogue_8cxx-source.html#l01382">select_output_catalogue()</a>, <a class="el" href="_catalogue_8h-source.html#l00126">src</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, <a class="el" href="namespacesource_identify.html#a38a29">sourceIdentify::STATUS_CAT_EMPTY</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
<div class="fragment"><pre>01713                                                       {
01714 
01715     <span class="comment">// Declare local variables</span>
01716     <span class="keywordtype">long</span> iSrc;
01717         
01718     <span class="comment">// Single loop for common exit point</span>
01719     <span class="keywordflow">do</span> {
01720 
01721       <span class="comment">// Fall through in case of an error</span>
01722       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01723         <span class="keywordflow">continue</span>;
01724 
01725       <span class="comment">// Dump header</span>
01726       <span class="keywordflow">if</span> (par-&gt;logAction()) {
01727         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">""</span>);
01728         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"Build counterpart candidate catalogue:"</span>);
01729         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"======================================"</span>);
01730       }
01731       
01732       <span class="comment">// Get input catalogue descriptors</span>
01733       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c2">get_input_descriptor</a>(par, par-&gt;m_srcCatName, &amp;<a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>, status);
01734       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
01735         <span class="keywordflow">if</span> (par-&gt;logError())
01736           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to load source catalogue '%s' descriptor."</span>,
01737               (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status, par-&gt;m_srcCatName.c_str());
01738         <span class="keywordflow">continue</span>;
01739       }
01740       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c2">get_input_descriptor</a>(par, par-&gt;m_cptCatName, &amp;<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>, status);
01741       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
01742         <span class="keywordflow">if</span> (par-&gt;logError())
01743           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to load counterpart catalogue '%s'"</span>
01744               <span class="stringliteral">" descriptor."</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status, par-&gt;m_cptCatName.c_str());
01745         <span class="keywordflow">continue</span>;
01746       }
01747 
01748       <span class="comment">// Create output catalogue</span>
01749       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c8">create_output_catalogue</a>(par, status);
01750       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
01751         <span class="keywordflow">if</span> (par-&gt;logError())
01752           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to create output catalogue."</span>,
01753               (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
01754         <span class="keywordflow">continue</span>;
01755       }
01756       
01757       <span class="comment">// Load source catalogue</span>
01758       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c3">get_input_catalogue</a>(par, par-&gt;m_srcCatName, &amp;<a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>, status);
01759       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
01760         <span class="keywordflow">if</span> (par-&gt;logError())
01761           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to load source catalogue '%s' data."</span>,
01762               (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status, par-&gt;m_srcCatName.c_str());
01763         <span class="keywordflow">continue</span>;
01764       }
01765       <span class="keywordflow">else</span> {
01766         <span class="keywordflow">if</span> (par-&gt;logDebug())
01767           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Source catalogue loaded."</span>);
01768       }
01769       
01770       <span class="comment">// Determine the number of sources in source catalogue. Stop of the</span>
01771       <span class="comment">// catalogue is empty</span>
01772       <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.getNumRows(&amp;<a class="code" href="classsource_identify_1_1_catalogue.html#o0">numSrc</a>);
01773       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o0">numSrc</a> &lt; 1) {
01774         status = <a class="code" href="namespacesource_identify.html#a38a29">STATUS_CAT_EMPTY</a>;
01775         <span class="keywordflow">if</span> (par-&gt;logError())
01776           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Source catalogue is empty. Stop"</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
01777         <span class="keywordflow">continue</span>;
01778       }
01779       <span class="keywordflow">else</span> {
01780         <span class="keywordflow">if</span> (par-&gt;logDebug())
01781           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Source catalogue contains %d sources."</span>, <a class="code" href="classsource_identify_1_1_catalogue.html#o0">numSrc</a>);
01782       }
01783       
01784       <span class="comment">// Loop over all sources</span>
01785       <span class="keywordflow">for</span> (iSrc = 0; iSrc &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o0">numSrc</a>; iSrc++) {
01786       
01787         <span class="comment">// Get counterpart candidates for the source</span>
01788         status = <a class="code" href="classsource_identify_1_1_catalogue.html#c4">get_counterpart_candidates</a>(par, iSrc, status);
01789         <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01790           <span class="keywordflow">break</span>;
01791       
01792       } <span class="comment">// endfor: looped over all sources</span>
01793       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01794         <span class="keywordflow">continue</span>;
01795 
01796       <span class="comment">// Evaluate output catalogue quantities</span>
01797       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c10">eval_output_catalogue_quantities</a>(par, status);
01798       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
01799         <span class="keywordflow">if</span> (par-&gt;logError())
01800           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to evaluate output catalogue quantities."</span>,
01801               (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
01802         <span class="keywordflow">continue</span>;
01803       }
01804 
01805       <span class="comment">// Select output catalogue counterparts</span>
01806       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c11">select_output_catalogue</a>(par, status);
01807       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
01808         <span class="keywordflow">if</span> (par-&gt;logError())
01809           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to select output catalogue counterparts."</span>,
01810               (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
01811         <span class="keywordflow">continue</span>;
01812       }
01813       
01814     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01815     
01816     <span class="comment">// Return status</span>
01817     <span class="keywordflow">return</span> status;
01818 
01819 }
</pre></div>    </td>
  </tr>
</table>
<a name="c12" doxytag="sourceIdentify::Catalogue::cc_sort"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::cc_sort </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01478">1478</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00132">cc</a>, <a class="el" href="_catalogue_8h-source.html#l00131">numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00082">sourceIdentify::CCElement::prob</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00548">get_probability()</a>.
<p>
<div class="fragment"><pre>01478                                                         {
01479 
01480     <span class="comment">// Declare local variables</span>
01481     <span class="keywordtype">long</span>      iCC;
01482     <span class="keywordtype">long</span>      jCC;
01483     <span class="keywordtype">long</span>      imax;
01484     <span class="keywordtype">double</span>    max;
01485     CCElement swap;
01486 
01487     <span class="comment">// Single loop for common exit point</span>
01488     <span class="keywordflow">do</span> {
01489     
01490       <span class="comment">// Fall through in case of an error</span>
01491       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01492         <span class="keywordflow">continue</span>;
01493         
01494       <span class="comment">// Fall through if there are no counterpart candidates</span>
01495       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a> &lt; 1)
01496         <span class="keywordflow">continue</span>;
01497     
01498       <span class="comment">// Sort counterpart candidats (dirty brute force method, to be replaced</span>
01499       <span class="comment">// by more efficient method if needed ...)</span>
01500       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>; iCC++) {
01501         max  = 0.0;
01502         imax = iCC;
01503         <span class="keywordflow">for</span> (jCC = iCC; jCC &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>; jCC++) {
01504           <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[jCC].prob &gt; max) {
01505             imax = jCC;
01506             max  = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[jCC].prob;
01507           }
01508         }
01509         <span class="keywordflow">if</span> (iCC != imax) {
01510           swap     = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC];
01511           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC]  = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[imax];
01512           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[imax] = swap;
01513         } 
01514       }
01515     
01516     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01517     
01518     <span class="comment">// Return status</span>
01519     <span class="keywordflow">return</span> status;
01520 
01521 }
</pre></div>    </td>
  </tr>
</table>
<a name="c8" doxytag="sourceIdentify::Catalogue::create_output_catalogue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::create_output_catalogue </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00768">768</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_parameters_8h-source.html#l00070">sourceIdentify::Parameters::clobber</a>, <a class="el" href="_catalogue_8h-source.html#l00127">cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00143">cpt_Qty_colnum</a>, <a class="el" href="_catalogue_8h-source.html#l00145">cpt_Qty_tform</a>, <a class="el" href="_catalogue_8h-source.html#l00144">cpt_Qty_ttype</a>, <a class="el" href="_catalogue_8h-source.html#l00146">cpt_Qty_tunit</a>, <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_parameters_8h-source.html#l00063">sourceIdentify::Parameters::m_cptCatQty</a>, <a class="el" href="_parameters_8h-source.html#l00061">sourceIdentify::Parameters::m_outCatName</a>, <a class="el" href="_parameters_8h-source.html#l00062">sourceIdentify::Parameters::m_srcCatQty</a>, <a class="el" href="_catalogue_8h-source.html#l00142">num_cpt_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00135">num_src_Qty</a>, <a class="el" href="_catalogue_8h-source.html#l00041">OUTCAT_COL_DEC_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00043">OUTCAT_COL_DEC_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00042">OUTCAT_COL_DEC_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00044">OUTCAT_COL_DEC_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00032">OUTCAT_COL_ID_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00034">OUTCAT_COL_ID_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00033">OUTCAT_COL_ID_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00046">OUTCAT_COL_MAJERR_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00048">OUTCAT_COL_MAJERR_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00047">OUTCAT_COL_MAJERR_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00049">OUTCAT_COL_MAJERR_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00051">OUTCAT_COL_MINERR_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00053">OUTCAT_COL_MINERR_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00052">OUTCAT_COL_MINERR_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00054">OUTCAT_COL_MINERR_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00056">OUTCAT_COL_POSANGLE_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00058">OUTCAT_COL_POSANGLE_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00057">OUTCAT_COL_POSANGLE_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00059">OUTCAT_COL_POSANGLE_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00061">OUTCAT_COL_PROB_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00063">OUTCAT_COL_PROB_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00062">OUTCAT_COL_PROB_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00064">OUTCAT_COL_PROB_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00036">OUTCAT_COL_RA_COLNUM</a>, <a class="el" href="_catalogue_8h-source.html#l00038">OUTCAT_COL_RA_FORM</a>, <a class="el" href="_catalogue_8h-source.html#l00037">OUTCAT_COL_RA_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00039">OUTCAT_COL_RA_UNIT</a>, <a class="el" href="_catalogue_8h-source.html#l00028">OUTCAT_EXT_NAME</a>, <a class="el" href="_catalogue_8h-source.html#l00027">OUTCAT_MAX_KEY_LEN</a>, <a class="el" href="_catalogue_8h-source.html#l00030">OUTCAT_NUM_GENERIC</a>, <a class="el" href="_catalogue_8h-source.html#l00128">outFile</a>, <a class="el" href="_catalogue_8cxx-source.html#l00039">sourceIdentify::set_fits_col_format()</a>, <a class="el" href="_catalogue_8h-source.html#l00126">src</a>, <a class="el" href="_catalogue_8h-source.html#l00136">src_Qty_colnum</a>, <a class="el" href="_catalogue_8h-source.html#l00138">src_Qty_tform</a>, <a class="el" href="_catalogue_8h-source.html#l00137">src_Qty_ttype</a>, <a class="el" href="_catalogue_8h-source.html#l00139">src_Qty_tunit</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, <a class="el" href="namespacesource_identify.html#a38a23">sourceIdentify::STATUS_MEM_ALLOC</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>.
<p>
<div class="fragment"><pre>00768                                                                         {
00769 
00770     <span class="comment">// Declare local variables</span>
00771     <span class="keywordtype">int</span>                                    fstatus;
00772     <span class="keywordtype">int</span>                                    col;
00773     <span class="keywordtype">int</span>                                    num_col;
00774     <span class="keywordtype">long</span>                                   iQty;
00775     <span class="keywordtype">long</span>                                   numQty;
00776     std::string                            form;
00777     std::vector&lt;std::string&gt;               qtyNames;
00778     std::vector&lt;std::string&gt;               qtyUnits;
00779     std::vector&lt;catalogAccess::Quantity&gt;   qtyDesc;
00780     <span class="keywordtype">char</span>                                 **ttype;
00781     <span class="keywordtype">char</span>                                 **tform;
00782     <span class="keywordtype">char</span>                                 **tunit;
00783 
00784     <span class="comment">// Initialise temporary memory pointers</span>
00785     ttype = NULL;
00786     tform = NULL;
00787     tunit = NULL;
00788 
00789     <span class="comment">// Initialise FITSIO status</span>
00790     fstatus = (int)status;
00791 
00792     <span class="comment">// Single loop for common exit point</span>
00793     <span class="keywordflow">do</span> {
00794     
00795       <span class="comment">// Fall through in case of an error</span>
00796       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00797         <span class="keywordflow">continue</span>;
00798 
00799       <span class="comment">// If clobber=1 we make sure that the output catalogue does not yet exist</span>
00800       <span class="keywordflow">if</span> (par-&gt;clobber)
00801         remove(par-&gt;m_outCatName.c_str());
00802         
00803       <span class="comment">// Create empty FITS file.</span>
00804       fstatus = fits_create_file(&amp;<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, par-&gt;m_outCatName.c_str(), &amp;fstatus);
00805       <span class="keywordflow">if</span> (fstatus != 0) {
00806         <span class="keywordflow">if</span> (par-&gt;logError())
00807           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to create output catalogue '%s'."</span>, 
00808               fstatus, par-&gt;m_outCatName.c_str());
00809         <span class="keywordflow">continue</span>;
00810       }
00811 
00812       <span class="comment">// Initialise column index to the OUTCAT_NUM_GENERIC generic columns</span>
00813       num_col     = <a class="code" href="_catalogue_8h.html#a3">OUTCAT_NUM_GENERIC</a>;
00814       <a class="code" href="classsource_identify_1_1_catalogue.html#o9">num_src_Qty</a> = 0;
00815       <a class="code" href="classsource_identify_1_1_catalogue.html#o14">num_cpt_Qty</a> = 0;
00816 
00817       <span class="comment">// Add source catalogue columns</span>
00818       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.getQuantityNames(&amp;qtyNames);
00819       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.getQuantityUnits(&amp;qtyUnits);
00820       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.getQuantityDescription(&amp;qtyDesc);
00821       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
00822         <span class="keywordflow">if</span> ((par-&gt;m_srcCatQty.find(<span class="stringliteral">"*"</span>, 0)            != std::string::npos) ||
00823             (par-&gt;m_srcCatQty.find(qtyNames[iQty], 0) != std::string::npos)) {
00824 
00825           <span class="comment">// Increment number of source quantities and FITS file columns</span>
00826           <a class="code" href="classsource_identify_1_1_catalogue.html#o9">num_src_Qty</a>++;
00827           num_col++;
00828 
00829           <span class="comment">// Set quantity FITS column format</span>
00830           <a class="code" href="namespacesource_identify.html#a35">set_fits_col_format</a>(&amp;qtyDesc[iQty], &amp;form);
00831         
00832           <span class="comment">// Add quantity information to source quantity string</span>
00833           <a class="code" href="classsource_identify_1_1_catalogue.html#o11">src_Qty_ttype</a>.push_back(qtyNames[iQty]);
00834           <a class="code" href="classsource_identify_1_1_catalogue.html#o12">src_Qty_tform</a>.push_back(form);
00835           <a class="code" href="classsource_identify_1_1_catalogue.html#o13">src_Qty_tunit</a>.push_back(qtyUnits[iQty]);
00836         }
00837       }
00838 
00839       <span class="comment">// Add counterpart catalogue columns</span>
00840       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.getQuantityNames(&amp;qtyNames);
00841       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.getQuantityUnits(&amp;qtyUnits);
00842       numQty = <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.getQuantityDescription(&amp;qtyDesc);
00843       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
00844         <span class="keywordflow">if</span> ((par-&gt;m_cptCatQty.find(<span class="stringliteral">"*"</span>, 0)            != std::string::npos) ||
00845             (par-&gt;m_cptCatQty.find(qtyNames[iQty], 0) != std::string::npos)) {
00846 
00847           <span class="comment">// Increment number of source quantities and FITS file columns</span>
00848           <a class="code" href="classsource_identify_1_1_catalogue.html#o14">num_cpt_Qty</a>++;
00849           num_col++;
00850 
00851           <span class="comment">// Set quantity FITS column format</span>
00852           <a class="code" href="namespacesource_identify.html#a35">set_fits_col_format</a>(&amp;qtyDesc[iQty], &amp;form);
00853         
00854           <span class="comment">// Add quantity information to source quantity string</span>
00855           <a class="code" href="classsource_identify_1_1_catalogue.html#o16">cpt_Qty_ttype</a>.push_back(qtyNames[iQty]);
00856           <a class="code" href="classsource_identify_1_1_catalogue.html#o17">cpt_Qty_tform</a>.push_back(form);
00857           <a class="code" href="classsource_identify_1_1_catalogue.html#o18">cpt_Qty_tunit</a>.push_back(qtyUnits[iQty]);
00858         }
00859       }
00860 
00861       <span class="comment">// Allocate temporary memory to hold column information</span>
00862       ttype = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[num_col];
00863       tform = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[num_col];
00864       tunit = <span class="keyword">new</span> (<span class="keywordtype">char</span>*)[num_col];
00865       <span class="keywordflow">if</span> (ttype == NULL ||
00866           tform == NULL ||
00867           tunit == NULL) {
00868         status = <a class="code" href="namespacesource_identify.html#a38a23">STATUS_MEM_ALLOC</a>;
00869         <span class="keywordflow">if</span> (par-&gt;logError())
00870           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Memory allocation failure."</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
00871         <span class="keywordflow">continue</span>;
00872       }
00873       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
00874         ttype[col] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a1">OUTCAT_MAX_KEY_LEN</a>];
00875         tform[col] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a1">OUTCAT_MAX_KEY_LEN</a>];
00876         tunit[col] = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="_catalogue_8h.html#a1">OUTCAT_MAX_KEY_LEN</a>];
00877         <span class="keywordflow">if</span> (ttype[col] == NULL ||
00878             tform[col] == NULL ||
00879             tunit[col] == NULL) {
00880           status = <a class="code" href="namespacesource_identify.html#a38a23">STATUS_MEM_ALLOC</a>;
00881           <span class="keywordflow">if</span> (par-&gt;logError())
00882             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Memory allocation failure."</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
00883           <span class="keywordflow">break</span>;
00884         }
00885         sprintf(ttype[col], <span class="stringliteral">""</span>);
00886         sprintf(tform[col], <span class="stringliteral">""</span>);
00887         sprintf(tunit[col], <span class="stringliteral">""</span>);
00888       }
00889       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00890         <span class="keywordflow">continue</span>;
00891 
00892       <span class="comment">// Add generic columns</span>
00893       col = <a class="code" href="_catalogue_8h.html#a4">OUTCAT_COL_ID_COLNUM</a> - 1;
00894       sprintf(ttype[col], <a class="code" href="_catalogue_8h.html#a5">OUTCAT_COL_ID_NAME</a>);
00895       sprintf(tform[col], <a class="code" href="_catalogue_8h.html#a6">OUTCAT_COL_ID_FORM</a>);
00896       col = <a class="code" href="_catalogue_8h.html#a7">OUTCAT_COL_RA_COLNUM</a> - 1;
00897       sprintf(ttype[col], <a class="code" href="_catalogue_8h.html#a8">OUTCAT_COL_RA_NAME</a>);
00898       sprintf(tform[col], <a class="code" href="_catalogue_8h.html#a9">OUTCAT_COL_RA_FORM</a>);
00899       sprintf(tunit[col], <a class="code" href="_catalogue_8h.html#a10">OUTCAT_COL_RA_UNIT</a>);
00900       col = <a class="code" href="_catalogue_8h.html#a11">OUTCAT_COL_DEC_COLNUM</a> - 1;
00901       sprintf(ttype[col], <a class="code" href="_catalogue_8h.html#a12">OUTCAT_COL_DEC_NAME</a>);
00902       sprintf(tform[col], <a class="code" href="_catalogue_8h.html#a13">OUTCAT_COL_DEC_FORM</a>);
00903       sprintf(tunit[col], <a class="code" href="_catalogue_8h.html#a14">OUTCAT_COL_DEC_UNIT</a>);
00904       col = <a class="code" href="_catalogue_8h.html#a15">OUTCAT_COL_MAJERR_COLNUM</a> - 1;
00905       sprintf(ttype[col], <a class="code" href="_catalogue_8h.html#a16">OUTCAT_COL_MAJERR_NAME</a>);
00906       sprintf(tform[col], <a class="code" href="_catalogue_8h.html#a17">OUTCAT_COL_MAJERR_FORM</a>);
00907       sprintf(tunit[col], <a class="code" href="_catalogue_8h.html#a18">OUTCAT_COL_MAJERR_UNIT</a>);
00908       col = <a class="code" href="_catalogue_8h.html#a19">OUTCAT_COL_MINERR_COLNUM</a> - 1;
00909       sprintf(ttype[col], <a class="code" href="_catalogue_8h.html#a20">OUTCAT_COL_MINERR_NAME</a>);
00910       sprintf(tform[col], <a class="code" href="_catalogue_8h.html#a21">OUTCAT_COL_MINERR_FORM</a>);
00911       sprintf(tunit[col], <a class="code" href="_catalogue_8h.html#a22">OUTCAT_COL_MINERR_UNIT</a>);
00912       col = <a class="code" href="_catalogue_8h.html#a23">OUTCAT_COL_POSANGLE_COLNUM</a> - 1;
00913       sprintf(ttype[col], <a class="code" href="_catalogue_8h.html#a24">OUTCAT_COL_POSANGLE_NAME</a>);
00914       sprintf(tform[col], <a class="code" href="_catalogue_8h.html#a25">OUTCAT_COL_POSANGLE_FORM</a>);
00915       sprintf(tunit[col], <a class="code" href="_catalogue_8h.html#a26">OUTCAT_COL_POSANGLE_UNIT</a>);
00916       col = <a class="code" href="_catalogue_8h.html#a27">OUTCAT_COL_PROB_COLNUM</a> - 1;
00917       sprintf(ttype[col], <a class="code" href="_catalogue_8h.html#a28">OUTCAT_COL_PROB_NAME</a>);
00918       sprintf(tform[col], <a class="code" href="_catalogue_8h.html#a29">OUTCAT_COL_PROB_FORM</a>);
00919       sprintf(tunit[col], <a class="code" href="_catalogue_8h.html#a30">OUTCAT_COL_PROB_UNIT</a>);
00920 
00921       <span class="comment">// Initialise column counter for additional columns</span>
00922       col = <a class="code" href="_catalogue_8h.html#a3">OUTCAT_NUM_GENERIC</a>;
00923 
00924       <span class="comment">// Add source catalogue quantities</span>
00925       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o9">num_src_Qty</a>; iQty++) {
00926         <a class="code" href="classsource_identify_1_1_catalogue.html#o10">src_Qty_colnum</a>.push_back(col+1);
00927         sprintf(ttype[col], <span class="stringliteral">"SRC_%s"</span>, <a class="code" href="classsource_identify_1_1_catalogue.html#o11">src_Qty_ttype</a>[iQty].c_str());
00928         sprintf(tform[col], <a class="code" href="classsource_identify_1_1_catalogue.html#o12">src_Qty_tform</a>[iQty].c_str());
00929         sprintf(tunit[col], <a class="code" href="classsource_identify_1_1_catalogue.html#o13">src_Qty_tunit</a>[iQty].c_str());
00930         col++;
00931       }
00932 
00933       <span class="comment">// Add counterpart catalogue quantities</span>
00934       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o14">num_cpt_Qty</a>; iQty++) {
00935         <a class="code" href="classsource_identify_1_1_catalogue.html#o15">cpt_Qty_colnum</a>.push_back(col+1);
00936         sprintf(ttype[col], <span class="stringliteral">"CPT_%s"</span>, <a class="code" href="classsource_identify_1_1_catalogue.html#o16">cpt_Qty_ttype</a>[iQty].c_str());
00937         sprintf(tform[col], <a class="code" href="classsource_identify_1_1_catalogue.html#o17">cpt_Qty_tform</a>[iQty].c_str());
00938         sprintf(tunit[col], <a class="code" href="classsource_identify_1_1_catalogue.html#o18">cpt_Qty_tunit</a>[iQty].c_str());
00939         col++;
00940       }
00941 
00942       <span class="comment">// Create binary table</span>
00943       fstatus = fits_create_tbl(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, BINARY_TBL, 0, num_col, 
00944                                 ttype, tform, tunit,
00945                                 <a class="code" href="_catalogue_8h.html#a2">OUTCAT_EXT_NAME</a>, &amp;fstatus);
00946       <span class="keywordflow">if</span> (fstatus != 0) {
00947         <span class="keywordflow">if</span> (par-&gt;logError())
00948           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to create empty catalogue '%s'."</span>, 
00949               fstatus, par-&gt;m_outCatName);
00950         <span class="keywordflow">continue</span>;
00951       }
00952    
00953     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00954 
00955     <span class="comment">// Free temporary memory</span>
00956     <span class="keywordflow">if</span> (ttype != NULL) {
00957       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
00958         <span class="keywordflow">if</span> (ttype[col] != NULL) <span class="keyword">delete</span> [] ttype[col];
00959       }
00960       <span class="keyword">delete</span> [] ttype;
00961     }
00962     <span class="keywordflow">if</span> (tform != NULL) {
00963       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
00964         <span class="keywordflow">if</span> (tform[col] != NULL) <span class="keyword">delete</span> [] tform[col];
00965       }
00966       <span class="keyword">delete</span> [] tform;
00967     }
00968     <span class="keywordflow">if</span> (tunit != NULL) {
00969       <span class="keywordflow">for</span> (col = 0; col &lt; num_col; col++) {
00970         <span class="keywordflow">if</span> (tunit[col] != NULL) <span class="keyword">delete</span> [] tunit[col];
00971       }
00972       <span class="keyword">delete</span> [] tunit;
00973     }
00974 
00975     <span class="comment">// Set FITSIO status</span>
00976     <span class="keywordflow">if</span> (status == <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00977       status = (Status)fstatus;
00978     
00979     <span class="comment">// Return status</span>
00980     <span class="keywordflow">return</span> status;
00981 
00982 }
</pre></div>    </td>
  </tr>
</table>
<a name="c14" doxytag="sourceIdentify::Catalogue::dump_counterpart_candidates"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::dump_counterpart_candidates </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01619">1619</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00085">sourceIdentify::CCElement::angsep</a>, <a class="el" href="_catalogue_8h-source.html#l00132">cc</a>, <a class="el" href="_catalogue_8h-source.html#l00127">cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00084">sourceIdentify::CCElement::index</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00078">sourceIdentify::Parameters::logDebug()</a>, <a class="el" href="_catalogue_8h-source.html#l00131">numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00082">sourceIdentify::CCElement::prob</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00326">get_counterpart_candidates()</a>.
<p>
<div class="fragment"><pre>01619                                                                             {
01620 
01621     <span class="comment">// Declare local variables</span>
01622     <span class="keywordtype">long</span>        iCC;
01623     <span class="keywordtype">long</span>        iCpt;
01624     <span class="keywordtype">double</span>      cpt_ra;
01625     <span class="keywordtype">double</span>      cpt_dec;
01626     <span class="keywordtype">double</span>      cpt_error;
01627     std::string cpt_name;
01628     std::string obj_name;
01629 
01630     <span class="comment">// Single loop for common exit point</span>
01631     <span class="keywordflow">do</span> {
01632     
01633       <span class="comment">// Fall through in case of an error</span>
01634       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01635         <span class="keywordflow">continue</span>;
01636         
01637       <span class="comment">// Fall through if there are no counterpart candidates</span>
01638       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a> &lt; 1)
01639         <span class="keywordflow">continue</span>;
01640 
01641       <span class="comment">// Determine the name of the generic quantity "object name"</span>
01642       obj_name = <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.getNameObjName();
01643     
01644       <span class="comment">// Loop over counterpart candidates</span>
01645       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>; iCC++) {
01646       
01647         <span class="comment">// Get index of candidate in counterpart catalogue</span>
01648         iCpt = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].index;
01649 
01650         <span class="comment">// Extract information for counterpart candidate</span>
01651         <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.ra_deg(iCpt,  &amp;cpt_ra);
01652         <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.dec_deg(iCpt, &amp;cpt_dec);
01653         <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.posError_deg(iCpt, &amp;cpt_error);
01654         <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.getSValue(obj_name, iCpt, &amp;cpt_name);
01655 
01656         <span class="comment">// Dump counterpart candidate information</span>
01657         <span class="keywordflow">if</span> (!par-&gt;logDebug()) {
01658           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"  Counterpart candidate %5d .....: %s Prob=%7.3f %%"</span>,
01659               iCC+1, cpt_name.c_str(), <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].prob*100.0);
01660         }
01661         <span class="keywordflow">else</span> {
01662           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"  Counterpart candidate %5d .....: %s Prob=%7.3f %%"</span>
01663               <span class="stringliteral">" (RA,DEC)=(%8.3f,%8.3f) +/- %8.3f  Sep=%8.3f deg"</span>,
01664               iCC+1, cpt_name.c_str(), <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].prob*100.0,
01665               cpt_ra, cpt_dec, cpt_error, <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].angsep);
01666         }
01667 
01668       } <span class="comment">// endfor: looped over counterpart candidats</span>
01669     
01670     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01671     
01672     <span class="comment">// Return status</span>
01673     <span class="keywordflow">return</span> status;
01674 
01675 }
</pre></div>    </td>
  </tr>
</table>
<a name="c13" doxytag="sourceIdentify::Catalogue::dump_descriptor"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::dump_descriptor </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">catalogAccess::Catalog *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cat</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01529">1529</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, and <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00219">get_input_descriptor()</a>.
<p>
<div class="fragment"><pre>01529                                                                           {
01530 
01531     <span class="comment">// Declare local variables</span>
01532     <span class="keywordtype">long</span>                                               iQty;
01533     <span class="keywordtype">long</span>                                               numQty;
01534     <span class="keywordtype">long</span>                                               numRows;
01535     <span class="keywordtype">long</span>                                               len;
01536     <span class="keywordtype">long</span>                                               maxLenNames;
01537     <span class="keywordtype">long</span>                                               maxLenUnits;
01538     <span class="keywordtype">long</span>                                               maxLenUCDs;
01539     std::string                                        qtyType;
01540     std::vector&lt;std::string&gt;                           titles;
01541     std::vector&lt;std::string&gt;                           qtyNames;
01542     std::vector&lt;std::string&gt;                           qtyUnits;
01543     std::vector&lt;std::string&gt;                           qtyUCDs;
01544     std::vector&lt;catalogAccess::Quantity&gt;               qtyDesc;
01545     std::vector&lt;catalogAccess::Quantity::QuantityType&gt; qtyTypes;
01546 
01547     <span class="comment">// Single loop for common exit point</span>
01548     <span class="keywordflow">do</span> {
01549       
01550       <span class="comment">// Extract information from catalogue</span>
01551       cat-&gt;getCatalogTitles(&amp;titles);
01552       numQty = cat-&gt;getQuantityNames(&amp;qtyNames);
01553       numQty = cat-&gt;getQuantityUnits(&amp;qtyUnits);
01554       numQty = cat-&gt;getQuantityUCDs(&amp;qtyUCDs);
01555       numQty = cat-&gt;getQuantityDescription(&amp;qtyDesc);
01556       numQty = cat-&gt;getQuantityTypes(&amp;qtyTypes);
01557       cat-&gt;getNumRows(&amp;numRows);
01558       
01559       <span class="comment">// Get string lengths</span>
01560       maxLenNames = 0;
01561       maxLenUnits = 0;
01562       maxLenUCDs  = 0;
01563       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
01564         <span class="keywordflow">if</span> ((len = strlen(qtyNames[iQty].c_str())) &gt; maxLenNames)
01565           maxLenNames = len;
01566         <span class="keywordflow">if</span> ((len = strlen(qtyUnits[iQty].c_str())) &gt; maxLenUnits)
01567           maxLenUnits = len;
01568         <span class="keywordflow">if</span> ((len = strlen(qtyUCDs[iQty].c_str())) &gt; maxLenUCDs)
01569           maxLenUCDs = len;
01570       }
01571 
01572       <span class="comment">// Dump catalogue information</span>
01573       <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Catalogue ........................: %s"</span>, titles[0].c_str());
01574       <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Number of entries (rows) .........: %d"</span>, numRows);
01575       <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Number of quantities (columns) ...: %d"</span>, numQty);
01576 
01577       <span class="comment">// Dump information about catalogue quantitites</span>
01578       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
01579       
01580         <span class="comment">// Set quantity type</span>
01581         <span class="keywordflow">switch</span> (qtyTypes[iQty]) {
01582         <span class="keywordflow">case</span> 0:
01583           qtyType = <span class="stringliteral">"vector ("</span> + qtyDesc[iQty].m_format + <span class="stringliteral">")"</span>;
01584           <span class="keywordflow">break</span>;
01585         <span class="keywordflow">case</span> 1:
01586           qtyType = <span class="stringliteral">"numerical ("</span> + qtyDesc[iQty].m_format + <span class="stringliteral">")"</span>;
01587           <span class="keywordflow">break</span>;
01588         <span class="keywordflow">case</span> 2:
01589           qtyType = <span class="stringliteral">"string ("</span> + qtyDesc[iQty].m_format + <span class="stringliteral">")"</span>;
01590           <span class="keywordflow">break</span>;
01591         <span class="keywordflow">default</span>:
01592           qtyType = <span class="stringliteral">"unknown"</span>;
01593           <span class="keywordflow">break</span>;
01594         }
01595         
01596         <span class="comment">// Dump quantity</span>
01597         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"  Quantity %3d ....................: %*s %*s %*s (%s)"</span>, 
01598                  iQty+1, 
01599                  maxLenNames, qtyNames[iQty].c_str(),
01600                  maxLenUnits, qtyUnits[iQty].c_str(),
01601                  maxLenUCDs, qtyUCDs[iQty].c_str(),
01602                  qtyType.c_str());
01603 
01604       } <span class="comment">// endfor: looped over quantities</span>
01605     
01606     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01607     
01608     <span class="comment">// Return status</span>
01609     <span class="keywordflow">return</span> status;
01610 
01611 }
</pre></div>    </td>
  </tr>
</table>
<a name="c10" doxytag="sourceIdentify::Catalogue::eval_output_catalogue_quantities"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::eval_output_catalogue_quantities </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01276">1276</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8cxx-source.html#l00091">sourceIdentify::fits_tform_binary()</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00076">sourceIdentify::Parameters::logAction()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_parameters_8h-source.html#l00065">sourceIdentify::Parameters::m_outCatQtyFormula</a>, <a class="el" href="_parameters_8h-source.html#l00064">sourceIdentify::Parameters::m_outCatQtyName</a>, <a class="el" href="_catalogue_8h-source.html#l00128">outFile</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>, and <a class="el" href="namespacesource_identify.html#a37a12">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>.
<p>
<div class="fragment"><pre>01277                                                                   {
01278 
01279     <span class="comment">// Declare local variables</span>
01280     <span class="keywordtype">int</span>                    fstatus;
01281     <span class="keywordtype">int</span>                    datatype;
01282     <span class="keywordtype">int</span>                    naxis;
01283     <span class="keywordtype">long</span>                   nelements;
01284     <span class="keywordtype">long</span>                   iQty;
01285     std::string::size_type numQty;
01286     std::string            tform;
01287 
01288     <span class="comment">// Initialise FITSIO status</span>
01289     fstatus = (int)status;
01290 
01291     <span class="comment">// Single loop for common exit point</span>
01292     <span class="keywordflow">do</span> {
01293     
01294       <span class="comment">// Fall through in case of an error</span>
01295       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01296         <span class="keywordflow">continue</span>;
01297 
01298       <span class="comment">// Determine number of new output catalogue quantities. Fall through if</span>
01299       <span class="comment">// there are no new output catalogue quantities</span>
01300       numQty = par-&gt;m_outCatQtyName.size();
01301       <span class="keywordflow">if</span> (numQty &lt; 1)
01302         <span class="keywordflow">continue</span>;
01303 
01304       <span class="comment">// Dump header</span>
01305       <span class="keywordflow">if</span> (par-&gt;logAction()) {
01306         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">""</span>);
01307         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"Add new output catalogue quantities:"</span>);
01308         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"===================================="</span>);
01309       }
01310 
01311       <span class="comment">// Add all new output catalogue quantities</span>
01312       <span class="keywordflow">for</span> (iQty = 0; iQty &lt; numQty; iQty++) {
01313 
01314         <span class="comment">// Test expression to determine the format of the new column</span>
01315         fstatus = fits_test_expr(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>,
01316                                  par-&gt;m_outCatQtyFormula[iQty].c_str(),
01317                                  0, &amp;datatype, &amp;nelements, &amp;naxis, NULL,
01318                                  &amp;fstatus);
01319         <span class="keywordflow">if</span> (fstatus != 0) {
01320           <span class="keywordflow">if</span> (par-&gt;logError())
01321             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a12">Warning_2</a>, <span class="stringliteral">" Unable to evaluate expression &lt;%s='%s'&gt; for"</span>
01322                 <span class="stringliteral">" creating new output catalogue quantity (status=%d)."</span>,
01323                 par-&gt;m_outCatQtyName[iQty].c_str(), 
01324                 par-&gt;m_outCatQtyFormula[iQty].c_str(),
01325                 fstatus);
01326           fstatus = 0;
01327           <span class="keywordflow">continue</span>;
01328         }
01329 
01330         <span class="comment">// Set column format</span>
01331         <span class="keywordflow">if</span> (nelements &lt; 1) 
01332           nelements = 1;
01333         <a class="code" href="namespacesource_identify.html#a36">fits_tform_binary</a>(datatype, nelements, 0, &amp;tform);
01334 
01335         <span class="comment">// Create new FITS column</span>
01336         fstatus = fits_calculator(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, 
01337                                   par-&gt;m_outCatQtyFormula[iQty].c_str(),
01338                                   <a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>,
01339                                   par-&gt;m_outCatQtyName[iQty].c_str(),
01340                                   tform.c_str(), 
01341                                   &amp;fstatus);
01342         <span class="keywordflow">if</span> (fstatus != 0) {
01343           <span class="keywordflow">if</span> (par-&gt;logError())
01344             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to evaluate quantity &lt;%s='%s'&gt; in output"</span>
01345                 <span class="stringliteral">" catalogue."</span>, 
01346                 fstatus, 
01347                 par-&gt;m_outCatQtyName[iQty].c_str(), 
01348                 par-&gt;m_outCatQtyFormula[iQty].c_str());
01349           <span class="keywordflow">break</span>;
01350         }
01351 
01352         <span class="comment">// Dump new output catalogue quantities information</span>
01353         <span class="keywordflow">if</span> (par-&gt;logAction()) {
01354           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" New quantity .....................: %s = %s"</span>
01355               <span class="stringliteral">" (format='%s')"</span>,
01356               par-&gt;m_outCatQtyName[iQty].c_str(),
01357               par-&gt;m_outCatQtyFormula[iQty].c_str(),
01358               tform.c_str());
01359         }
01360 
01361       }
01362       <span class="keywordflow">if</span> (fstatus != 0)
01363         <span class="keywordflow">continue</span>;
01364 
01365     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01366 
01367     <span class="comment">// Set FITSIO status</span>
01368     <span class="keywordflow">if</span> (status == <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01369       status = (Status)fstatus;
01370     
01371     <span class="comment">// Return status</span>
01372     <span class="keywordflow">return</span> status;
01373 
01374 }
</pre></div>    </td>
  </tr>
</table>
<a name="c1" doxytag="sourceIdentify::Catalogue::free_memory"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void sourceIdentify::Catalogue::free_memory </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00193">193</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00132">cc</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00165">init_memory()</a>.
<p>
Referenced by <a class="el" href="_catalogue_8h-source.html#l00149">~Catalogue()</a>.
<p>
<div class="fragment"><pre>00193                                 {
00194 
00195     <span class="comment">// Declare local variables</span>
00196 
00197     <span class="comment">// Single loop for common exit point</span>
00198     <span class="keywordflow">do</span> {
00199 
00200       <span class="comment">// Free temporary memory</span>
00201       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>;
00202 
00203       <span class="comment">// Initialise memory</span>
00204       <a class="code" href="classsource_identify_1_1_catalogue.html#c0">init_memory</a>();
00205 
00206     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00207     
00208     <span class="comment">// Return</span>
00209     <span class="keywordflow">return</span>;
00210 
00211 }
</pre></div>    </td>
  </tr>
</table>
<a name="c4" doxytag="sourceIdentify::Catalogue::get_counterpart_candidates"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_counterpart_candidates </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iSrc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00326">326</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01619">dump_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00397">get_counterparts()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00548">get_probability()</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00077">sourceIdentify::Parameters::logDetail()</a>, <a class="el" href="_catalogue_8h-source.html#l00126">src</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>.
<p>
<div class="fragment"><pre>00327                                                             {
00328 
00329     <span class="comment">// Declare local variables</span>
00330     <span class="keywordtype">double</span>      ra;
00331     <span class="keywordtype">double</span>      dec;
00332     <span class="keywordtype">double</span>      pos_err;
00333     std::string src_name;
00334     std::string obj_name;
00335 
00336     <span class="comment">// Single loop for common exit point</span>
00337     <span class="keywordflow">do</span> {
00338 
00339       <span class="comment">// Determine the name of the generic quantity "object name"</span>
00340       obj_name = <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.getNameObjName();
00341 
00342       <span class="comment">// Get source coordinates</span>
00343       <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.ra_deg(iSrc,  &amp;ra);
00344       <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.dec_deg(iSrc, &amp;dec);
00345       <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.posError_deg(iSrc, &amp;pos_err);
00346       <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.getSValue(obj_name, iSrc, &amp;src_name);
00347 
00348       <span class="comment">// Optionally dump source information</span>
00349       <span class="keywordflow">if</span> (par-&gt;logDetail()) {
00350         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">""</span>);
00351         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Source %5d .....................: %s"</span>
00352             <span class="stringliteral">" (%8.3f,%8.3f) +/- %8.3f"</span>,
00353             iSrc, src_name.c_str(), ra, dec, pos_err);
00354       }
00355         
00356       <span class="comment">// Get counterparts near the source position</span>
00357       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c5">get_counterparts</a>(par, &amp;ra, &amp;dec, &amp;pos_err, status);
00358       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00359         <span class="keywordflow">continue</span>;
00360 
00361       <span class="comment">// Assign probability for each counterpart</span>
00362       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c6">get_probability</a>(par, iSrc, status);
00363       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00364         <span class="keywordflow">continue</span>;
00365 
00366       <span class="comment">// Add all counterpart candidates to output catalogue</span>
00367       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c9">add_counterpart_candidates</a>(par, iSrc, status);
00368       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00369         <span class="keywordflow">continue</span>;
00370 
00371       <span class="comment">// Optionally dump counterpart candidats</span>
00372       <span class="keywordflow">if</span> (par-&gt;logDetail())
00373         <a class="code" href="classsource_identify_1_1_catalogue.html#c14">dump_counterpart_candidates</a>(par, status);
00374 
00375     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00376     
00377     <span class="comment">// Return status</span>
00378     <span class="keywordflow">return</span> status;
00379 
00380 }
</pre></div>    </td>
  </tr>
</table>
<a name="c5" doxytag="sourceIdentify::Catalogue::get_counterparts"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_counterparts </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>ra</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>dec</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>pos_err</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00397">397</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00132">cc</a>, <a class="el" href="_catalogue_8h-source.html#l00127">cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00071">sourceIdentify::deg2rad</a>, <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8h-source.html#l00125">fCptLoaded</a>, <a class="el" href="_catalogue_8cxx-source.html#l00277">get_input_catalogue()</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00078">sourceIdentify::Parameters::logDebug()</a>, <a class="el" href="_parameters_8h-source.html#l00077">sourceIdentify::Parameters::logDetail()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_parameters_8h-source.html#l00060">sourceIdentify::Parameters::m_cptCatName</a>, <a class="el" href="_catalogue_8h-source.html#l00124">maxCptLoad</a>, <a class="el" href="_catalogue_8h-source.html#l00131">numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00123">numCpt</a>, <a class="el" href="_catalogue_8h-source.html#l00072">sourceIdentify::rad2deg</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, <a class="el" href="namespacesource_identify.html#a38a29">sourceIdentify::STATUS_CAT_EMPTY</a>, <a class="el" href="namespacesource_identify.html#a38a23">sourceIdentify::STATUS_MEM_ALLOC</a>, <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>, and <a class="el" href="namespacesource_identify.html#a37a12">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00326">get_counterpart_candidates()</a>.
<p>
<div class="fragment"><pre>00398                                                                    {
00399 
00400     <span class="comment">// Declare local variables</span>
00401     <span class="keywordtype">long</span>   iCpt;
00402     <span class="keywordtype">long</span>   numNoPos;
00403     <span class="keywordtype">long</span>   numNoError;
00404     <span class="keywordtype">double</span> src_dec_sin;
00405     <span class="keywordtype">double</span> src_dec_cos;
00406     <span class="keywordtype">double</span> cpt_ra;
00407     <span class="keywordtype">double</span> cpt_dec;
00408     <span class="keywordtype">double</span> cpt_error;
00409     <span class="keywordtype">double</span> cpt_dec_sin;
00410     <span class="keywordtype">double</span> cpt_dec_cos;
00411     <span class="keywordtype">double</span> angsep;
00412 
00413     <span class="comment">// Single loop for common exit point</span>
00414     <span class="keywordflow">do</span> {
00415 
00416       <span class="comment">// Reset statistics</span>
00417       <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>      = 0;
00418       numNoPos   = 0;
00419       numNoError = 0;
00420 
00421       <span class="comment">// Calculate sin and cos of source latitude</span>
00422       src_dec_sin = sin(*dec * <a class="code" href="namespacesource_identify.html#a4">deg2rad</a>);
00423       src_dec_cos = cos(*dec * <a class="code" href="namespacesource_identify.html#a4">deg2rad</a>);
00424     
00425       <span class="comment">// If the counterpart catalogue is big then load only sources from a</span>
00426       <span class="comment">// region around the specified position ...</span>
00427       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o1">numCpt</a> &gt; <a class="code" href="classsource_identify_1_1_catalogue.html#o2">maxCptLoad</a>) {
00428       }
00429       
00430       <span class="comment">// ... otherwise load the entire counterpart catalogue</span>
00431       <span class="keywordflow">else</span> {
00432 
00433         <span class="comment">// Load only if noy yet done ...</span>
00434         <span class="keywordflow">if</span> (!<a class="code" href="classsource_identify_1_1_catalogue.html#o3">fCptLoaded</a>) {
00435 
00436           <span class="comment">// Load counterpart catalogue</span>
00437           status = <a class="code" href="classsource_identify_1_1_catalogue.html#c3">get_input_catalogue</a>(par, par-&gt;m_cptCatName, &amp;<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>, status);
00438           <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
00439             <span class="keywordflow">if</span> (par-&gt;logError())
00440               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to load counterpart catalogue '%s'"</span>
00441                   <span class="stringliteral">" data."</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status, par-&gt;m_cptCatName.c_str());
00442             <span class="keywordflow">continue</span>;
00443           }
00444           <span class="keywordflow">else</span> {
00445             <span class="keywordflow">if</span> (par-&gt;logDebug())
00446               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Counterpart catalogue loaded."</span>);
00447           }
00448 
00449           <span class="comment">// Determine the number of sources in counterpart catalogue. Stop if</span>
00450           <span class="comment">// the catalogue is empty</span>
00451           <a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.getNumRows(&amp;<a class="code" href="classsource_identify_1_1_catalogue.html#o1">numCpt</a>);
00452           <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o1">numCpt</a> &lt; 1) {
00453             status = <a class="code" href="namespacesource_identify.html#a38a29">STATUS_CAT_EMPTY</a>;
00454             <span class="keywordflow">if</span> (par-&gt;logError())
00455               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Counterpart catalogue is empty. Stop."</span>, 
00456                   (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
00457             <span class="keywordflow">continue</span>;
00458           }
00459           <span class="keywordflow">else</span> {
00460             <span class="keywordflow">if</span> (par-&gt;logDebug())
00461               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Counterpart catalogue contains %d sources."</span>, <a class="code" href="classsource_identify_1_1_catalogue.html#o1">numCpt</a>);
00462           }
00463           
00464           <span class="comment">// Allocate memory for counterpart candidate search</span>
00465           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a> = <span class="keyword">new</span> CCElement[<a class="code" href="classsource_identify_1_1_catalogue.html#o1">numCpt</a>];
00466           <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a> == NULL) {
00467             status = <a class="code" href="namespacesource_identify.html#a38a23">STATUS_MEM_ALLOC</a>;
00468             <span class="keywordflow">if</span> (par-&gt;logError())
00469               <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Memory allocation failure."</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
00470             <span class="keywordflow">continue</span>;
00471           }
00472  
00473           <span class="comment">// Bookkeep catalogue loading</span>
00474           <a class="code" href="classsource_identify_1_1_catalogue.html#o3">fCptLoaded</a> = 1;
00475           
00476         } <span class="comment">// endif: catalogue was not yet loaded</span>
00477       } <span class="comment">// endelse: entire catalogue requested</span>
00478 
00479       <span class="comment">// Loop over counterparts</span>
00480       <span class="keywordflow">for</span> (iCpt = 0; iCpt &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o1">numCpt</a>; iCpt++) {
00481 
00482         <span class="comment">// Extract counterpart coordinates. Skip if no coordinates were found</span>
00483         <span class="keywordflow">if</span> ((<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.ra_deg(iCpt,  &amp;cpt_ra)  != IS_OK) ||
00484             (<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.dec_deg(iCpt, &amp;cpt_dec) != IS_OK)) {
00485           numNoPos++;
00486           <span class="keywordflow">continue</span>;
00487         }
00488 
00489         <span class="comment">// Extract counterpart positional uncertainty. Log in no uncertainty</span>
00490         <span class="comment">// was found</span>
00491         <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.posError_deg(iCpt, &amp;cpt_error) != IS_OK) {
00492           numNoError++;
00493         }
00494 
00495         <span class="comment">// Calculate angular separation in degrees</span>
00496         cpt_dec_sin = sin(cpt_dec * <a class="code" href="namespacesource_identify.html#a4">deg2rad</a>);
00497         cpt_dec_cos = cos(cpt_dec * <a class="code" href="namespacesource_identify.html#a4">deg2rad</a>);
00498         angsep      = acos(src_dec_sin * cpt_dec_sin +
00499                            src_dec_cos * cpt_dec_cos * 
00500                            cos((*ra - cpt_ra)*<a class="code" href="namespacesource_identify.html#a4">deg2rad</a>)) * <a class="code" href="namespacesource_identify.html#a5">rad2deg</a>;
00501 
00502         <span class="comment">// Keep only candidates with sufficiently small angular separation</span>
00503         <span class="comment">// (DUMMY)</span>
00504         <span class="keywordflow">if</span> (angsep &lt; 20.0) {
00505           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].id          = <span class="stringliteral">"NULL"</span>;
00506           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].pos_eq_ra   = 0.0;
00507           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].pos_eq_dec  = 0.0;
00508           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].pos_err_maj = 0.0;
00509           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].pos_err_min = 0.0;
00510           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].pos_err_ang = 0.0;
00511           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].prob        = 0.0;
00512           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].index       = iCpt;
00513           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].angsep      = 0.0;
00514           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>].prob_angsep = 0.0;
00515           <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>++;
00516         }
00517         
00518       } <span class="comment">// endfor: looped over counterparts</span>
00519 
00520       <span class="comment">// Optionally dump counterpart filter statistics</span>
00521       <span class="keywordflow">if</span> (par-&gt;logDetail()) {
00522         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"  Filter step candidates ..........: %d"</span>, <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>);
00523         <span class="keywordflow">if</span> (numNoPos &gt; 0)
00524           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a12">Warning_2</a>, <span class="stringliteral">"              no positions ........: %d"</span>, numNoPos);
00525         <span class="keywordflow">if</span> (numNoError &gt; 0)
00526           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a12">Warning_2</a>, <span class="stringliteral">"              no errors ...........: %d"</span>, numNoError);
00527       }
00528 
00529     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00530     
00531     <span class="comment">// Return status</span>
00532     <span class="keywordflow">return</span> status;
00533 
00534 }
</pre></div>    </td>
  </tr>
</table>
<a name="c3" doxytag="sourceIdentify::Catalogue::get_input_catalogue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_input_catalogue </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>std::string&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>catName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>catalogAccess::Catalog *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cat</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00277">277</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00078">sourceIdentify::Parameters::logDebug()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_catalogue_8h-source.html#l00126">src</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, <a class="el" href="namespacesource_identify.html#a38a28">sourceIdentify::STATUS_CAT_NOT_FOUND</a>, and <a class="el" href="namespacesource_identify.html#a37a12">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00397">get_counterparts()</a>.
<p>
<div class="fragment"><pre>00279                                                      {
00280 
00281     <span class="comment">// Declare local variables</span>
00282     <span class="keywordtype">int</span> caterr;
00283 
00284     <span class="comment">// Single loop for common exit point</span>
00285     <span class="keywordflow">do</span> {
00286 
00287       <span class="comment">// First interpret the input string as filename and load the catalogue</span>
00288       <span class="comment">// from the file. If this fails then interpret input string as</span>
00289       <span class="comment">// catalogue name and load from WEB.</span>
00290       caterr = cat-&gt;import(catName);
00291       <span class="keywordflow">if</span> (caterr &lt; 0) {
00292         <span class="keywordflow">if</span> (par-&gt;logDebug())
00293           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a12">Warning_2</a>, <span class="stringliteral">"%d : Unable to load catalogue '%s' from file."</span>,
00294               caterr, catName.c_str());
00295         caterr = <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.importWeb(catName);
00296         <span class="keywordflow">if</span> (caterr &lt; 0) {
00297           <span class="keywordflow">if</span> (par-&gt;logError())
00298             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to load catalogue '%s' from file or web."</span>,
00299                 caterr, catName.c_str());
00300           status = <a class="code" href="namespacesource_identify.html#a38a28">STATUS_CAT_NOT_FOUND</a>;
00301           <span class="keywordflow">continue</span>;
00302         }
00303         <span class="keywordflow">else</span> {
00304           <span class="keywordflow">if</span> (par-&gt;logDebug())
00305             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Loaded catalogue '%s' from web."</span>, catName.c_str());
00306         }
00307       }
00308       <span class="keywordflow">else</span> {
00309         <span class="keywordflow">if</span> (par-&gt;logDebug())
00310           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Loaded catalogue '%s' from file."</span>, catName.c_str());
00311       }
00312       
00313     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00314     
00315     <span class="comment">// Return status</span>
00316     <span class="keywordflow">return</span> status;
00317 
00318 }
</pre></div>    </td>
  </tr>
</table>
<a name="c2" doxytag="sourceIdentify::Catalogue::get_input_descriptor"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_input_descriptor </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>std::string&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>catName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>catalogAccess::Catalog *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cat</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00219">219</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8cxx-source.html#l01529">dump_descriptor()</a>, <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00078">sourceIdentify::Parameters::logDebug()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_catalogue_8h-source.html#l00126">src</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, <a class="el" href="namespacesource_identify.html#a38a28">sourceIdentify::STATUS_CAT_NOT_FOUND</a>, <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>, and <a class="el" href="namespacesource_identify.html#a37a12">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>.
<p>
<div class="fragment"><pre>00221                                                       {
00222 
00223     <span class="comment">// Declare local variables</span>
00224     <span class="keywordtype">int</span> caterr;
00225 
00226     <span class="comment">// Single loop for common exit point</span>
00227     <span class="keywordflow">do</span> {
00228 
00229       <span class="comment">// First interpret the input string as filename and load the catalogue</span>
00230       <span class="comment">// from the file. If this fails then interpret input string as</span>
00231       <span class="comment">// catalogue name and load from WEB.</span>
00232       caterr = cat-&gt;importDescription(catName);
00233       <span class="keywordflow">if</span> (caterr &lt; 0) {
00234         <span class="keywordflow">if</span> (par-&gt;logDebug())
00235           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a12">Warning_2</a>, <span class="stringliteral">"%d : Unable to load catalogue '%s' descriptor from"</span>
00236               <span class="stringliteral">" file."</span>, caterr, catName.c_str());
00237         caterr = <a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.importDescriptionWeb(catName);
00238         <span class="keywordflow">if</span> (caterr &lt; 0) {
00239           <span class="keywordflow">if</span> (par-&gt;logError())
00240             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to load catalogue '%s' descriptor from"</span>
00241                 <span class="stringliteral">" file or web."</span>, caterr, catName.c_str());
00242           status = <a class="code" href="namespacesource_identify.html#a38a28">STATUS_CAT_NOT_FOUND</a>;
00243           <span class="keywordflow">continue</span>;
00244         }
00245         <span class="keywordflow">else</span> {
00246           <span class="keywordflow">if</span> (par-&gt;logDebug())
00247             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Loaded catalogue '%s' descriptor from web."</span>, 
00248                 catName.c_str());
00249         }
00250       }
00251       <span class="keywordflow">else</span> {
00252         <span class="keywordflow">if</span> (par-&gt;logDebug())
00253           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Loaded catalogue '%s' descriptor from file."</span>, 
00254               catName.c_str());
00255       }
00256       
00257       <span class="comment">// Debug mode: dump catalogue descriptor</span>
00258       <span class="keywordflow">if</span> (par-&gt;logDebug()) {
00259         status = <a class="code" href="classsource_identify_1_1_catalogue.html#c13">dump_descriptor</a>(cat, status);
00260         <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00261           <span class="keywordflow">continue</span>;
00262       }
00263     
00264     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00265     
00266     <span class="comment">// Return status</span>
00267     <span class="keywordflow">return</span> status;
00268 
00269 }
</pre></div>    </td>
  </tr>
</table>
<a name="c6" doxytag="sourceIdentify::Catalogue::get_probability"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_probability </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iSrc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00548">548</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00132">cc</a>, <a class="el" href="_catalogue_8cxx-source.html#l01478">cc_sort()</a>, <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_catalogue_8cxx-source.html#l00649">get_probability_angsep()</a>, <a class="el" href="_catalogue_8h-source.html#l00076">sourceIdentify::CCElement::id</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00077">sourceIdentify::Parameters::logDetail()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_parameters_8h-source.html#l00069">sourceIdentify::Parameters::maxNumCtp</a>, <a class="el" href="_catalogue_8h-source.html#l00131">numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00026">OUTCAT_MAX_STRING_LEN</a>, <a class="el" href="_catalogue_8h-source.html#l00082">sourceIdentify::CCElement::prob</a>, <a class="el" href="_catalogue_8h-source.html#l00086">sourceIdentify::CCElement::prob_angsep</a>, <a class="el" href="_parameters_8h-source.html#l00068">sourceIdentify::Parameters::probThres</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00326">get_counterpart_candidates()</a>.
<p>
<div class="fragment"><pre>00548                                                                            {
00549 
00550     <span class="comment">// Declare local variables</span>
00551     <span class="keywordtype">long</span> iCC;
00552     <span class="keywordtype">long</span> numUseCC;
00553     <span class="keywordtype">char</span> cid[<a class="code" href="_catalogue_8h.html#a0">OUTCAT_MAX_STRING_LEN</a>];
00554 
00555     <span class="comment">// Single loop for common exit point</span>
00556     <span class="keywordflow">do</span> {
00557     
00558       <span class="comment">// Fall through in case of an error</span>
00559       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00560         <span class="keywordflow">continue</span>;
00561         
00562       <span class="comment">// Fall through if there are no counterpart candidates</span>
00563       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a> &lt; 1)
00564         <span class="keywordflow">continue</span>;
00565 
00566       <span class="comment">// Determine counterpart probabilities based on angular separation</span>
00567       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c7">get_probability_angsep</a>(par, iSrc, status);
00568       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
00569         <span class="keywordflow">if</span> (par-&gt;logError())
00570           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to determine counterpart probabilities"</span>
00571               <span class="stringliteral">" based on angular separation."</span>, (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
00572         <span class="keywordflow">continue</span>;
00573       }
00574     
00575       <span class="comment">// Assign the counterpart probabilities</span>
00576       <span class="comment">// DUMMY: we only use the probability based on angular separation</span>
00577       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>; iCC++)
00578         <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].prob = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].prob_angsep;              
00579 
00580       <span class="comment">// Sort counterpart candidates by decreasing probability</span>
00581       status = <a class="code" href="classsource_identify_1_1_catalogue.html#c12">cc_sort</a>(par, status);
00582       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>) {
00583         <span class="keywordflow">if</span> (par-&gt;logError())
00584           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to sort counterpart candidates."</span>, 
00585               (<a class="code" href="namespacesource_identify.html#a38">Status</a>)status);
00586         <span class="keywordflow">continue</span>;
00587       }
00588 
00589       <span class="comment">// Determine the number of counterpart candidates above the probability </span>
00590       <span class="comment">// threshold</span>
00591       numUseCC = 0;
00592       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>; iCC++) {
00593         <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].prob &gt;= par-&gt;probThres)
00594           numUseCC++;
00595         <span class="keywordflow">else</span>
00596           <span class="keywordflow">break</span>;
00597       }
00598 
00599       <span class="comment">// Apply the maximum number of counterpart threshold</span>
00600       <span class="keywordflow">if</span> (numUseCC &gt; par-&gt;maxNumCtp)
00601         numUseCC = par-&gt;maxNumCtp;
00602 
00603       <span class="comment">// Eliminate counterpart candidates below threshold. Fall through if no </span>
00604       <span class="comment">// counterparts are left</span>
00605       <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a> = numUseCC;
00606       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a> &lt; 1) {
00607         <span class="keywordflow">if</span> (par-&gt;logDetail())
00608           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"  Refine step candidates ..........: no"</span>);
00609         <span class="keywordflow">continue</span>;
00610       }
00611 
00612       <span class="comment">// Set unique counterpart candidate identifier</span>
00613       <span class="comment">// DUMMY: Build string from indices</span>
00614       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>; iCC++) {
00615         sprintf(cid, <span class="stringliteral">"CC_%5.5ld_%5.5ld"</span>, iSrc+1, iCC+1);
00616         <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].id = cid;
00617       }
00618 
00619       <span class="comment">// Optionally dump counterpart refine statistics</span>
00620       <span class="keywordflow">if</span> (par-&gt;logDetail()) {
00621         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"  Refine step candidates ..........: %d"</span>, <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>);
00622       }
00623     
00624     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00625     
00626     <span class="comment">// Return status</span>
00627     <span class="keywordflow">return</span> status;
00628 
00629 }
</pre></div>    </td>
  </tr>
</table>
<a name="c7" doxytag="sourceIdentify::Catalogue::get_probability_angsep"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::get_probability_angsep </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iSrc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00649">649</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00085">sourceIdentify::CCElement::angsep</a>, <a class="el" href="_catalogue_8h-source.html#l00132">cc</a>, <a class="el" href="_catalogue_8h-source.html#l00127">cpt</a>, <a class="el" href="_catalogue_8h-source.html#l00071">sourceIdentify::deg2rad</a>, <a class="el" href="_catalogue_8h-source.html#l00084">sourceIdentify::CCElement::index</a>, <a class="el" href="_catalogue_8h-source.html#l00131">numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00078">sourceIdentify::CCElement::pos_eq_dec</a>, <a class="el" href="_catalogue_8h-source.html#l00077">sourceIdentify::CCElement::pos_eq_ra</a>, <a class="el" href="_catalogue_8h-source.html#l00081">sourceIdentify::CCElement::pos_err_ang</a>, <a class="el" href="_catalogue_8h-source.html#l00079">sourceIdentify::CCElement::pos_err_maj</a>, <a class="el" href="_catalogue_8h-source.html#l00080">sourceIdentify::CCElement::pos_err_min</a>, <a class="el" href="_catalogue_8h-source.html#l00086">sourceIdentify::CCElement::prob_angsep</a>, <a class="el" href="_catalogue_8h-source.html#l00072">sourceIdentify::rad2deg</a>, <a class="el" href="_catalogue_8h-source.html#l00126">src</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00548">get_probability()</a>.
<p>
<div class="fragment"><pre>00650                                                         {
00651 
00652     <span class="comment">// Declare local variables</span>
00653     <span class="keywordtype">long</span>   iCC;
00654     <span class="keywordtype">long</span>   iCpt;
00655     <span class="keywordtype">double</span> src_ra;
00656     <span class="keywordtype">double</span> src_dec;
00657     <span class="keywordtype">double</span> src_err_maj;
00658     <span class="keywordtype">double</span> src_err_min;
00659     <span class="keywordtype">double</span> src_err_ang;
00660     <span class="keywordtype">double</span> src_dec_sin;
00661     <span class="keywordtype">double</span> src_dec_cos;
00662     <span class="keywordtype">double</span> cpt_ra;
00663     <span class="keywordtype">double</span> cpt_dec;
00664     <span class="keywordtype">double</span> cpt_err_maj;
00665     <span class="keywordtype">double</span> cpt_err_min;
00666     <span class="keywordtype">double</span> cpt_err_ang;
00667     <span class="keywordtype">double</span> cpt_dec_sin;
00668     <span class="keywordtype">double</span> cpt_dec_cos;
00669 
00670     <span class="comment">// Single loop for common exit point</span>
00671     <span class="keywordflow">do</span> {
00672     
00673       <span class="comment">// Fall through in case of an error</span>
00674       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
00675         <span class="keywordflow">continue</span>;
00676         
00677       <span class="comment">// Fall through if there are no counterpart candidates</span>
00678       <span class="keywordflow">if</span> (<a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a> &lt; 1)
00679         <span class="keywordflow">continue</span>;
00680 
00681       <span class="comment">// Get position and error ellipse for source. Fall through if information</span>
00682       <span class="comment">// is not available</span>
00683       src_err_ang = 0.0;
00684       <span class="keywordflow">if</span> ((<a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.ra_deg(iSrc, &amp;src_ra)            != IS_OK) ||
00685           (<a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.dec_deg(iSrc, &amp;src_dec)          != IS_OK) ||
00686           (<a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.posError_deg(iSrc, &amp;src_err_maj) != IS_OK) ||
00687           (<a class="code" href="classsource_identify_1_1_catalogue.html#o4">src</a>.posError_deg(iSrc, &amp;src_err_min) != IS_OK))
00688         <span class="keywordflow">continue</span>;
00689 
00690       <span class="comment">// Calculate sin and cos of source declination</span>
00691       src_dec_sin = sin(src_dec * <a class="code" href="namespacesource_identify.html#a4">deg2rad</a>);
00692       src_dec_cos = cos(src_dec * <a class="code" href="namespacesource_identify.html#a4">deg2rad</a>);
00693     
00694       <span class="comment">// Loop over counterpart candidates</span>
00695       <span class="keywordflow">for</span> (iCC = 0; iCC &lt; <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>; iCC++) {
00696 
00697         <span class="comment">// Get index of candidate in counterpart catalogue</span>
00698         iCpt = <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].index;
00699 
00700         <span class="comment">// Get position for counterpart candidate. Fall through if position is </span>
00701         <span class="comment">// not available</span>
00702         <span class="keywordflow">if</span> ((<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.ra_deg(iCpt, &amp;cpt_ra)   != IS_OK) ||
00703             (<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.dec_deg(iCpt, &amp;cpt_dec) != IS_OK))
00704           <span class="keywordflow">continue</span>;
00705 
00706         <span class="comment">// Get error ellipse for counterpart candidate. Assume no error if error</span>
00707         <span class="comment">// ellipse is not available</span>
00708         cpt_err_ang = 0.0;
00709         <span class="keywordflow">if</span> ((<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.posError_deg(iCpt, &amp;cpt_err_maj) != IS_OK) ||
00710             (<a class="code" href="classsource_identify_1_1_catalogue.html#o5">cpt</a>.posError_deg(iCpt, &amp;cpt_err_min) != IS_OK)) {
00711           cpt_err_maj = 0.0;
00712           cpt_err_min = 0.0;
00713         }
00714 <span class="comment">/*</span>
00715 <span class="comment">        if ((cpt.ra_deg(iCpt, &amp;cpt_ra)            != IS_OK) ||</span>
00716 <span class="comment">            (cpt.dec_deg(iCpt, &amp;cpt_dec)          != IS_OK) ||</span>
00717 <span class="comment">            (cpt.posError_deg(iCpt, &amp;cpt_err_maj) != IS_OK) ||</span>
00718 <span class="comment">            (cpt.posError_deg(iCpt, &amp;cpt_err_min) != IS_OK))</span>
00719 <span class="comment">          continue;</span>
00720 <span class="comment">*/</span>
00721         <span class="comment">// Calculate angular separation between source and counterpart in</span>
00722         <span class="comment">// degrees</span>
00723         cpt_dec_sin    = sin(cpt_dec * <a class="code" href="namespacesource_identify.html#a4">deg2rad</a>);
00724         cpt_dec_cos    = cos(cpt_dec * <a class="code" href="namespacesource_identify.html#a4">deg2rad</a>);
00725         <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].angsep = acos(src_dec_sin * cpt_dec_sin +
00726                               src_dec_cos * cpt_dec_cos * 
00727                               cos((src_ra - cpt_ra)*<a class="code" href="namespacesource_identify.html#a4">deg2rad</a>)) * <a class="code" href="namespacesource_identify.html#a5">rad2deg</a>;
00728 
00729         <span class="comment">// Calculate counterpart probability from angular separation</span>
00730         <span class="comment">// DUMMY: we use an exponential law for the probability</span>
00731         <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].prob_angsep = 
00732           exp(-<a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].angsep / sqrt(cpt_err_maj*cpt_err_maj + 
00733                                      src_err_maj*src_err_maj));
00734 
00735         <span class="comment">// Assign position and error ellipse</span>
00736         <span class="comment">// DUMMY: we assign the position and error ellipse of the partner</span>
00737         <span class="comment">//        that has the smaller positional uncertainty</span>
00738         <span class="keywordflow">if</span> (cpt_err_maj &lt; src_err_maj) {
00739           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_eq_ra   = cpt_ra;
00740           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_eq_dec  = cpt_dec;
00741           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_err_maj = cpt_err_maj;
00742           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_err_min = cpt_err_min;
00743           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_err_ang = cpt_err_ang;
00744         }
00745         <span class="keywordflow">else</span> {
00746           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_eq_ra   = src_ra;
00747           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_eq_dec  = src_dec;
00748           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_err_maj = src_err_maj;
00749           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_err_min = src_err_min;
00750           <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>[iCC].pos_err_ang = src_err_ang;
00751         }
00752               
00753       } <span class="comment">// endfor: looped over counterpart candidates</span>
00754 
00755     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00756     
00757     <span class="comment">// Return status</span>
00758     <span class="keywordflow">return</span> status;
00759 
00760 }
</pre></div>    </td>
  </tr>
</table>
<a name="c0" doxytag="sourceIdentify::Catalogue::init_memory"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void sourceIdentify::Catalogue::init_memory </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l00165">165</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="_catalogue_8h-source.html#l00132">cc</a>, <a class="el" href="_catalogue_8h-source.html#l00125">fCptLoaded</a>, <a class="el" href="_catalogue_8h-source.html#l00124">maxCptLoad</a>, <a class="el" href="_catalogue_8h-source.html#l00131">numCC</a>, <a class="el" href="_catalogue_8h-source.html#l00123">numCpt</a>, and <a class="el" href="_catalogue_8h-source.html#l00122">numSrc</a>.
<p>
Referenced by <a class="el" href="_catalogue_8h-source.html#l00148">Catalogue()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00193">free_memory()</a>.
<p>
<div class="fragment"><pre>00165                                 {
00166 
00167     <span class="comment">// Declare local variables</span>
00168 
00169     <span class="comment">// Single loop for common exit point</span>
00170     <span class="keywordflow">do</span> {
00171 
00172       <span class="comment">// Intialise private members</span>
00173       <a class="code" href="classsource_identify_1_1_catalogue.html#o0">numSrc</a>     = 0;
00174       <a class="code" href="classsource_identify_1_1_catalogue.html#o1">numCpt</a>     = 0;
00175       <a class="code" href="classsource_identify_1_1_catalogue.html#o2">maxCptLoad</a> = 10000;
00176       <a class="code" href="classsource_identify_1_1_catalogue.html#o3">fCptLoaded</a> = 0;
00177       <a class="code" href="classsource_identify_1_1_catalogue.html#o7">numCC</a>      = 0;
00178       <a class="code" href="classsource_identify_1_1_catalogue.html#o8">cc</a>         = NULL;
00179 
00180     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
00181     
00182     <span class="comment">// Return</span>
00183     <span class="keywordflow">return</span>;
00184 
00185 }
</pre></div>    </td>
  </tr>
</table>
<a name="a3" doxytag="sourceIdentify::Catalogue::save"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::save </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01827">1827</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00076">sourceIdentify::Parameters::logAction()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_catalogue_8h-source.html#l00128">outFile</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, and <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>.
<p>
<div class="fragment"><pre>01827                                                      {
01828 
01829     <span class="comment">// Declare local variables</span>
01830     <span class="keywordtype">int</span> fstatus;
01831 
01832     <span class="comment">// Initialise FITSIO status</span>
01833     fstatus = (int)status;
01834         
01835     <span class="comment">// Single loop for common exit point</span>
01836     <span class="keywordflow">do</span> {
01837 
01838       <span class="comment">// Fall through in case of an error</span>
01839       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01840         <span class="keywordflow">continue</span>;
01841 
01842       <span class="comment">// Dump header</span>
01843       <span class="keywordflow">if</span> (par-&gt;logAction()) {
01844         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">""</span>);
01845         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"Save counterpart candidate catalogue:"</span>);
01846         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"====================================="</span>);
01847       }
01848 
01849       <span class="comment">// Close FITS file</span>
01850       fstatus = fits_close_file(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, &amp;fstatus);
01851       <span class="keywordflow">if</span> (fstatus != 0) {
01852         <span class="keywordflow">if</span> (par-&gt;logError())
01853           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to close output catalogue."</span>, fstatus);
01854         <span class="keywordflow">continue</span>;
01855       }
01856     
01857     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01858     
01859     <span class="comment">// Set FITSIO status</span>
01860     <span class="keywordflow">if</span> (status == <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01861       status = (Status)fstatus;
01862     
01863     <span class="comment">// Return status</span>
01864     <span class="keywordflow">return</span> status;
01865 
01866 }
</pre></div>    </td>
  </tr>
</table>
<a name="c11" doxytag="sourceIdentify::Catalogue::select_output_catalogue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespacesource_identify.html#a38">Status</a> sourceIdentify::Catalogue::select_output_catalogue </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classsource_identify_1_1_parameters.html">Parameters</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>par</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="namespacesource_identify.html#a38">Status</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8cxx-source.html#l01382">1382</a> of file <a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a>.
<p>
References <a class="el" href="namespacesource_identify.html#a37a8">sourceIdentify::Error_2</a>, <a class="el" href="_log_8cxx-source.html#l00119">sourceIdentify::Log()</a>, <a class="el" href="namespacesource_identify.html#a37a20">sourceIdentify::Log_2</a>, <a class="el" href="_parameters_8h-source.html#l00076">sourceIdentify::Parameters::logAction()</a>, <a class="el" href="_parameters_8h-source.html#l00075">sourceIdentify::Parameters::logError()</a>, <a class="el" href="_parameters_8h-source.html#l00066">sourceIdentify::Parameters::m_select</a>, <a class="el" href="_catalogue_8h-source.html#l00128">outFile</a>, <a class="el" href="source_identify_8h-source.html#l00043">sourceIdentify::Status</a>, <a class="el" href="namespacesource_identify.html#a38a22">sourceIdentify::STATUS_OK</a>, and <a class="el" href="namespacesource_identify.html#a37a12">sourceIdentify::Warning_2</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>.
<p>
<div class="fragment"><pre>01382                                                                         {
01383 
01384     <span class="comment">// Declare local variables</span>
01385     <span class="keywordtype">int</span>                    fstatus;
01386     <span class="keywordtype">long</span>                   iSel;
01387     <span class="keywordtype">long</span>                   numBefore;
01388     <span class="keywordtype">long</span>                   numAfter;
01389     std::string::size_type numSel;
01390 
01391     <span class="comment">// Initialise FITSIO status</span>
01392     fstatus = (int)status;
01393 
01394     <span class="comment">// Single loop for common exit point</span>
01395     <span class="keywordflow">do</span> {
01396     
01397       <span class="comment">// Fall through in case of an error</span>
01398       <span class="keywordflow">if</span> (status != <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01399         <span class="keywordflow">continue</span>;
01400 
01401       <span class="comment">// Determine number of output catalogue selection strings. Fall through</span>
01402       <span class="comment">// if there are no such strings</span>
01403       numSel = par-&gt;m_select.size();
01404       <span class="keywordflow">if</span> (numSel &lt; 1)
01405         <span class="keywordflow">continue</span>;
01406 
01407       <span class="comment">// Dump header</span>
01408       <span class="keywordflow">if</span> (par-&gt;logAction()) {
01409         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">""</span>);
01410         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"Select output catalogue counterparts:"</span>);
01411         <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"====================================="</span>);
01412       }
01413 
01414       <span class="comment">// Select output catalogue entries</span>
01415       <span class="keywordflow">for</span> (iSel = 0; iSel &lt; numSel; iSel++) {
01416 
01417         <span class="comment">// Determine number of rows in table before selection</span>
01418         fstatus = fits_get_num_rows(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, &amp;numBefore, &amp;fstatus);
01419         <span class="keywordflow">if</span> (fstatus != 0) {
01420           <span class="keywordflow">if</span> (par-&gt;logError())
01421             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to determine number of rows in output"</span>
01422                 <span class="stringliteral">" catalogue."</span>, fstatus);
01423           <span class="keywordflow">break</span>;
01424         }
01425 
01426         <span class="comment">// Perform selection</span>
01427         fstatus = fits_select_rows(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, <a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>,
01428                                    par-&gt;m_select[iSel].c_str(),
01429                                    &amp;fstatus);
01430         <span class="keywordflow">if</span> (fstatus != 0) {
01431           <span class="keywordflow">if</span> (par-&gt;logError())
01432             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a12">Warning_2</a>, <span class="stringliteral">" Unable to perform selection &lt;%s&gt; on the output"</span>
01433                 <span class="stringliteral">" catalogue (status=%d)."</span>,
01434                 par-&gt;m_select[iSel].c_str(), 
01435                 fstatus);
01436           fstatus = 0;
01437           <span class="keywordflow">continue</span>;
01438         }
01439 
01440         <span class="comment">// Determine number of rows in table after selection</span>
01441         fstatus = fits_get_num_rows(<a class="code" href="classsource_identify_1_1_catalogue.html#o6">outFile</a>, &amp;numAfter, &amp;fstatus);
01442         <span class="keywordflow">if</span> (fstatus != 0) {
01443           <span class="keywordflow">if</span> (par-&gt;logError())
01444             <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a8">Error_2</a>, <span class="stringliteral">"%d : Unable to determine number of rows in output"</span>
01445                 <span class="stringliteral">" catalogue."</span>, fstatus);
01446           <span class="keywordflow">break</span>;
01447         }
01448 
01449         <span class="comment">// Dump selection information</span>
01450         <span class="keywordflow">if</span> (par-&gt;logAction()) {
01451           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">" Selection ........................: %s"</span>, 
01452               par-&gt;m_select[iSel].c_str());
01453           <a class="code" href="namespacesource_identify.html#a34">Log</a>(<a class="code" href="namespacesource_identify.html#a37a20">Log_2</a>, <span class="stringliteral">"   Number of deleted counterparts .: %d (%d =&gt; %d)"</span>, 
01454               numBefore-numAfter, numBefore, numAfter);
01455         }
01456 
01457       }
01458       <span class="keywordflow">if</span> (fstatus != 0)
01459         <span class="keywordflow">continue</span>;
01460 
01461     } <span class="keywordflow">while</span> (0); <span class="comment">// End of main do-loop</span>
01462 
01463     <span class="comment">// Set FITSIO status</span>
01464     <span class="keywordflow">if</span> (status == <a class="code" href="namespacesource_identify.html#a38a22">STATUS_OK</a>)
01465       status = (Status)fstatus;
01466     
01467     <span class="comment">// Return status</span>
01468     <span class="keywordflow">return</span> status;
01469 
01470 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a name="o8" doxytag="sourceIdentify::Catalogue::cc"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structsource_identify_1_1_c_c_element.html">CCElement</a>* sourceIdentify::Catalogue::cc<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00132">132</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01478">cc_sort()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01619">dump_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00193">free_memory()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00397">get_counterparts()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00548">get_probability()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00649">get_probability_angsep()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00165">init_memory()</a>.    </td>
  </tr>
</table>
<a name="o5" doxytag="sourceIdentify::Catalogue::cpt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> catalogAccess::Catalog sourceIdentify::Catalogue::cpt<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00127">127</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01619">dump_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00397">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00649">get_probability_angsep()</a>.    </td>
  </tr>
</table>
<a name="o15" doxytag="sourceIdentify::Catalogue::cpt_Qty_colnum"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;int&gt; sourceIdentify::Catalogue::cpt_Qty_colnum<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00143">143</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o17" doxytag="sourceIdentify::Catalogue::cpt_Qty_tform"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;std::string&gt; sourceIdentify::Catalogue::cpt_Qty_tform<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00145">145</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o16" doxytag="sourceIdentify::Catalogue::cpt_Qty_ttype"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;std::string&gt; sourceIdentify::Catalogue::cpt_Qty_ttype<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00144">144</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o18" doxytag="sourceIdentify::Catalogue::cpt_Qty_tunit"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;std::string&gt; sourceIdentify::Catalogue::cpt_Qty_tunit<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00146">146</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o3" doxytag="sourceIdentify::Catalogue::fCptLoaded"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long sourceIdentify::Catalogue::fCptLoaded<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00125">125</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00397">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00165">init_memory()</a>.    </td>
  </tr>
</table>
<a name="o2" doxytag="sourceIdentify::Catalogue::maxCptLoad"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long sourceIdentify::Catalogue::maxCptLoad<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00124">124</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00397">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00165">init_memory()</a>.    </td>
  </tr>
</table>
<a name="o14" doxytag="sourceIdentify::Catalogue::num_cpt_Qty"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long sourceIdentify::Catalogue::num_cpt_Qty<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00142">142</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o9" doxytag="sourceIdentify::Catalogue::num_src_Qty"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long sourceIdentify::Catalogue::num_src_Qty<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00135">135</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o7" doxytag="sourceIdentify::Catalogue::numCC"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long sourceIdentify::Catalogue::numCC<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00131">131</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01478">cc_sort()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01619">dump_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00397">get_counterparts()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00548">get_probability()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00649">get_probability_angsep()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00165">init_memory()</a>.    </td>
  </tr>
</table>
<a name="o1" doxytag="sourceIdentify::Catalogue::numCpt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long sourceIdentify::Catalogue::numCpt<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00123">123</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00397">get_counterparts()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00165">init_memory()</a>.    </td>
  </tr>
</table>
<a name="o0" doxytag="sourceIdentify::Catalogue::numSrc"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long sourceIdentify::Catalogue::numSrc<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00122">122</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00165">init_memory()</a>.    </td>
  </tr>
</table>
<a name="o6" doxytag="sourceIdentify::Catalogue::outFile"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> fitsfile* sourceIdentify::Catalogue::outFile<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00128">128</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01276">eval_output_catalogue_quantities()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01827">save()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l01382">select_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o4" doxytag="sourceIdentify::Catalogue::src"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> catalogAccess::Catalog sourceIdentify::Catalogue::src<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00126">126</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l01713">build()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00326">get_counterpart_candidates()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00277">get_input_catalogue()</a>, <a class="el" href="_catalogue_8cxx-source.html#l00219">get_input_descriptor()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00649">get_probability_angsep()</a>.    </td>
  </tr>
</table>
<a name="o10" doxytag="sourceIdentify::Catalogue::src_Qty_colnum"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;int&gt; sourceIdentify::Catalogue::src_Qty_colnum<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00136">136</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o12" doxytag="sourceIdentify::Catalogue::src_Qty_tform"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;std::string&gt; sourceIdentify::Catalogue::src_Qty_tform<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00138">138</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o11" doxytag="sourceIdentify::Catalogue::src_Qty_ttype"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;std::string&gt; sourceIdentify::Catalogue::src_Qty_ttype<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00137">137</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00990">add_counterpart_candidates()</a>, and <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<a name="o13" doxytag="sourceIdentify::Catalogue::src_Qty_tunit"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;std::string&gt; sourceIdentify::Catalogue::src_Qty_tunit<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="_catalogue_8h-source.html#l00139">139</a> of file <a class="el" href="_catalogue_8h-source.html">Catalogue.h</a>.
<p>
Referenced by <a class="el" href="_catalogue_8cxx-source.html#l00768">create_output_catalogue()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_catalogue_8h-source.html">Catalogue.h</a><li><a class="el" href="_catalogue_8cxx-source.html">Catalogue.cxx</a></ul>
<hr><address style="align: right;"><small>Generated on Mon Feb 28 18:34:26 2005 for sourceIdentify by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
